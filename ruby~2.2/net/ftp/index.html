
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Net&#58;&#58;FTP - Ruby 2.2 - W3cubDocs</title>
  
  <meta name="description" content="This class implements the File Transfer Protocol. If you have used a command-line FTP program, and are familiar with the commands, you will be able &hellip;">
  <meta name="keywords" content="class, net, ftp, -, ruby, ruby~2.2">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ruby~2.2/net/ftp/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/ruby~2.2.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.2/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.2</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _rdoc">
				
<h1 id="class-Net::FTP" class="class"> class Net::FTP </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../../object/">Object</a></dd>
<dt>Included modules:</dt>
<dd class="meta-includes"><a class="include" href="../../monitormixin/">MonitorMixin</a></dd>
</dl> <section class="description"> <p>This class implements the <a href="../../file/">File</a> Transfer Protocol. If you have used a command-line <a href="../ftp/">FTP</a> program, and are familiar with the commands, you will be able to use this class easily. Some extra features are included to take advantage of Ruby's style and strengths.</p> <h2 id="class-Net::FTP-label-Example">Example</h2> <pre class="ruby">require 'net/ftp'
</pre> <h3 id="class-Net::FTP-label-Example+1">Example 1</h3> <pre class="ruby">ftp = Net::FTP.new('example.com')
ftp.login
files = ftp.chdir('pub/lang/ruby/contrib')
files = ftp.list('n*')
ftp.getbinaryfile('nif.rb-0.91.gz', 'nif.gz', 1024)
ftp.close
</pre> <h3 id="class-Net::FTP-label-Example+2">Example 2</h3> <pre class="ruby">Net::FTP.open('example.com') do |ftp|
  ftp.login
  files = ftp.chdir('pub/lang/ruby/contrib')
  files = ftp.list('n*')
  ftp.getbinaryfile('nif.rb-0.91.gz', 'nif.gz', 1024)
end
</pre> <h2 id="class-Net::FTP-label-Major+Methods">Major Methods</h2> <p>The following are the methods most likely to be useful to users:</p> <ul>
<li> <p><a href="../ftp/#method-c-open">::open</a></p> </li>
<li> <p><a href="../ftp/#method-i-getbinaryfile">getbinaryfile</a></p> </li>
<li> <p><a href="../ftp/#method-i-gettextfile">gettextfile</a></p> </li>
<li> <p><a href="../ftp/#method-i-putbinaryfile">putbinaryfile</a></p> </li>
<li> <p><a href="../ftp/#method-i-puttextfile">puttextfile</a></p> </li>
<li> <p><a href="../ftp/#method-i-chdir">chdir</a></p> </li>
<li> <p><a href="../ftp/#method-i-nlst">nlst</a></p> </li>
<li> <p><a href="../ftp/#method-i-size">size</a></p> </li>
<li> <p><a href="../ftp/#method-i-rename">rename</a></p> </li>
<li> <p><a href="../ftp/#method-i-delete">delete</a></p> </li>
</ul> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-binary"> <span class="method-name">binary</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>When <code>true</code>, transfers are performed in binary mode. Default: <code>true</code>.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-debug_mode"> <span class="method-name">debug_mode</span><span class="attribute-access-type">[RW]</span> </div> <div class="method-description"> <p>When <code>true</code>, all traffic to and from the server is written to +$stdout+. Default: <code>false</code>.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-last_response"> <span class="method-name">last_response</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The server's last response.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-last_response_code"> <span class="method-name">last_response_code</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The server's last response code.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-lastresp"> <span class="method-name">lastresp</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The server's last response code.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-open_timeout"> <span class="method-name">open_timeout</span><span class="attribute-access-type">[RW]</span> </div> <div class="method-description"> <p>Number of seconds to wait for the connection to open. Any number may be used, including Floats for fractional seconds. If the <a href="../ftp/">FTP</a> object cannot open a connection in this many seconds, it raises a <a href="../opentimeout/">Net::OpenTimeout</a> exception. The default value is <code>nil</code>.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-passive"> <span class="method-name">passive</span><span class="attribute-access-type">[RW]</span> </div> <div class="method-description"> <p>When <code>true</code>, the connection is in passive mode. Default: <code>false</code>.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-read_timeout"> <span class="method-name">read_timeout</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>Number of seconds to wait for one block to be read (via one read(2) call). Any number may be used, including Floats for fractional seconds. If the <a href="../ftp/">FTP</a> object cannot read data in this many seconds, it raises a <a href="../../timeout/error/">Timeout::Error</a> exception. The default value is 60 seconds.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-resume"> <span class="method-name">resume</span><span class="attribute-access-type">[RW]</span> </div> <div class="method-description"> <p>Sets or retrieves the <code>resume</code> status, which decides whether incomplete transfers are resumed or restarted. Default: <code>false</code>.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-welcome"> <span class="method-name">welcome</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The server's welcome message.</p> </div> </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(host = nil, user = nil, passwd = nil, acct = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Creates and returns a new <code>FTP</code> object. If a <code>host</code> is given, a connection is made. Additionally, if the <code>user</code> is given, the given user name, password, and (optionally) account are used to log in. See <a href="../ftp/#method-i-login">login</a>.</p> <div class="method-calls-super"> Calls superclass method <a href="../../monitormixin/#method-c-new">MonitorMixin.new</a> </div> <div class="method-source-code" id="new-source"> <pre class="ruby"># File lib/net/ftp.rb, line 149
def initialize(host = nil, user = nil, passwd = nil, acct = nil)
  super()
  @binary = true
  @passive = false
  @debug_mode = false
  @resume = false
  @sock = NullSocket.new
  @logged_in = false
  @open_timeout = nil
  @read_timeout = 60
  if host
    connect(host)
    if user
      login(user, passwd, acct)
    end
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-open"> <span class="method-name">open</span><span class="method-args">(host, user = nil, passwd = nil, acct = nil) { |ftp| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>A synonym for <code>FTP.new</code>, but with a mandatory host parameter.</p> <p>If a block is given, it is passed the <code>FTP</code> object, which will be closed when the block finishes, or when an exception is raised.</p> <div class="method-source-code" id="open-source"> <pre class="ruby"># File lib/net/ftp.rb, line 131
def FTP.open(host, user = nil, passwd = nil, acct = nil)
  if block_given?
    ftp = new(host, user, passwd, acct)
    begin
      yield ftp
    ensure
      ftp.close
    end
  else
    new(host, user, passwd, acct)
  end
end</pre> </div> </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-abort"> <span class="method-name">abort</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Aborts the previous command (ABOR command).</p> <div class="method-source-code" id="abort-source"> <pre class="ruby"># File lib/net/ftp.rb, line 880
def abort
  line = "ABOR" + CRLF
  print "put: ABOR\n" if @debug_mode
  @sock.send(line, Socket::MSG_OOB)
  resp = getmultiline
  unless ["426", "226", "225"].include?(resp[0, 3])
    raise FTPProtoError, resp
  end
  return resp
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-acct"> <span class="method-name">acct</span><span class="method-args">(account)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Sends the ACCT command.</p> <p>This is a less common <a href="../ftp/">FTP</a> command, to send account information if the destination host requires it.</p> <div class="method-source-code" id="acct-source"> <pre class="ruby"># File lib/net/ftp.rb, line 732
def acct(account)
  cmd = "ACCT " + account
  voidcmd(cmd)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-binary-3D"> <span class="method-name">binary=</span><span class="method-args">(newmode)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>A setter to toggle transfers in binary mode. <code>newmode</code> is either <code>true</code> or <code>false</code></p> <div class="method-source-code" id="binary-3D-source"> <pre class="ruby"># File lib/net/ftp.rb, line 169
def binary=(newmode)
  if newmode != @binary
    @binary = newmode
    send_type_command if @logged_in
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-chdir"> <span class="method-name">chdir</span><span class="method-args">(dirname)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Changes the (remote) directory.</p> <div class="method-source-code" id="chdir-source"> <pre class="ruby"># File lib/net/ftp.rb, line 802
def chdir(dirname)
  if dirname == ".."
    begin
      voidcmd("CDUP")
      return
    rescue FTPPermError =&gt; e
      if e.message[0, 3] != "500"
        raise e
      end
    end
  end
  cmd = "CWD " + dirname
  voidcmd(cmd)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-close"> <span class="method-name">close</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Closes the connection. Further operations are impossible until you open a new connection with <a href="../ftp/#method-i-connect">connect</a>.</p> <div class="method-source-code" id="close-source"> <pre class="ruby"># File lib/net/ftp.rb, line 953
def close
  if @sock and not @sock.closed?
    begin
      @sock.shutdown(Socket::SHUT_WR) rescue nil
      orig, self.read_timeout = self.read_timeout, 3
      @sock.read rescue nil
    ensure
      @sock.close
      self.read_timeout = orig
    end
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-closed-3F"> <span class="method-name">closed?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns <code>true</code> iff the connection is closed.</p> <div class="method-source-code" id="closed-3F-source"> <pre class="ruby"># File lib/net/ftp.rb, line 969
def closed?
  @sock == nil or @sock.closed?
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-connect"> <span class="method-name">connect</span><span class="method-args">(host, port = FTP_PORT)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Establishes an <a href="../ftp/">FTP</a> connection to host, optionally overriding the default port. If the environment variable <code>SOCKS_SERVER</code> is set, sets up the connection through a SOCKS proxy. Raises an exception (typically <code>Errno::ECONNREFUSED</code>) if the connection cannot be established.</p> <div class="method-source-code" id="connect-source"> <pre class="ruby"># File lib/net/ftp.rb, line 243
def connect(host, port = FTP_PORT)
  if @debug_mode
    print "connect: ", host, ", ", port, "\n"
  end
  synchronize do
    @sock = open_socket(host, port)
    voidresp
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-delete"> <span class="method-name">delete</span><span class="method-args">(filename)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Deletes a file on the server.</p> <div class="method-source-code" id="delete-source"> <pre class="ruby"># File lib/net/ftp.rb, line 788
def delete(filename)
  resp = sendcmd("DELE " + filename)
  if resp[0, 3] == "250"
    return
  elsif resp[0] == ?5
    raise FTPPermError, resp
  else
    raise FTPReplyError, resp
  end
end</pre> </div> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-dir"> <span class="method-name">dir</span><span class="method-args">(*args)</span> </div>  <div class="aliases"> Alias for: <a href="../ftp/#method-i-list">list</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-get"> <span class="method-name">get</span><span class="method-args">(remotefile, localfile = File.basename(remotefile), blocksize = DEFAULT_BLOCKSIZE) { |data| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Retrieves <code>remotefile</code> in whatever mode the session is set (text or binary). See <a href="../ftp/#method-i-gettextfile">gettextfile</a> and <a href="../ftp/#method-i-getbinaryfile">getbinaryfile</a>.</p> <div class="method-source-code" id="get-source"> <pre class="ruby"># File lib/net/ftp.rb, line 661
def get(remotefile, localfile = File.basename(remotefile),
        blocksize = DEFAULT_BLOCKSIZE, &amp;block) # :yield: data
  if @binary
    getbinaryfile(remotefile, localfile, blocksize, &amp;block)
  else
    gettextfile(remotefile, localfile, &amp;block)
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-getbinaryfile"> <span class="method-name">getbinaryfile</span><span class="method-args">(remotefile, localfile = File.basename(remotefile), blocksize = DEFAULT_BLOCKSIZE) { |data| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Retrieves <code>remotefile</code> in binary mode, storing the result in <code>localfile</code>. If <code>localfile</code> is nil, returns retrieved data. If a block is supplied, it is passed the retrieved data in <code>blocksize</code> chunks.</p> <div class="method-source-code" id="getbinaryfile-source"> <pre class="ruby"># File lib/net/ftp.rb, line 603
def getbinaryfile(remotefile, localfile = File.basename(remotefile),
                  blocksize = DEFAULT_BLOCKSIZE) # :yield: data
  result = nil
  if localfile
    if @resume
      rest_offset = File.size?(localfile)
      f = open(localfile, "a")
    else
      rest_offset = nil
      f = open(localfile, "w")
    end
  elsif !block_given?
    result = ""
  end
  begin
    f.binmode if localfile
    retrbinary("RETR " + remotefile.to_s, blocksize, rest_offset) do |data|
      f.write(data) if localfile
      yield(data) if block_given?
      result.concat(data) if result
    end
    return result
  ensure
    f.close if localfile
  end
end</pre> </div> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-getdir"> <span class="method-name">getdir</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="../ftp/#method-i-pwd">pwd</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-gettextfile"> <span class="method-name">gettextfile</span><span class="method-args">(remotefile, localfile = File.basename(remotefile)) { |line| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Retrieves <code>remotefile</code> in ASCII (text) mode, storing the result in <code>localfile</code>. If <code>localfile</code> is nil, returns retrieved data. If a block is supplied, it is passed the retrieved data one line at a time.</p> <div class="method-source-code" id="gettextfile-source"> <pre class="ruby"># File lib/net/ftp.rb, line 637
def gettextfile(remotefile, localfile = File.basename(remotefile)) # :yield: line
  result = nil
  if localfile
    f = open(localfile, "w")
  elsif !block_given?
    result = ""
  end
  begin
    retrlines("RETR " + remotefile) do |line, newline|
      l = newline ? line + "\n" : line
      f.print(l) if localfile
      yield(line, newline) if block_given?
      result.concat(l) if result
    end
    return result
  ensure
    f.close if localfile
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-help"> <span class="method-name">help</span><span class="method-args">(arg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Issues the HELP command.</p> <div class="method-source-code" id="help-source"> <pre class="ruby"># File lib/net/ftp.rb, line 917
def help(arg = nil)
  cmd = "HELP"
  if arg
    cmd = cmd + " " + arg
  end
  sendcmd(cmd)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-list"> <span class="method-name">list</span><span class="method-args">(*args) { |line| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns an array of file information in the directory (the output is like `ls -l`). If a block is given, it iterates through the listing.</p> <div class="method-source-code" id="list-source"> <pre class="ruby"># File lib/net/ftp.rb, line 756
def list(*args, &amp;block) # :yield: line
  cmd = "LIST"
  args.each do |arg|
    cmd = cmd + " " + arg.to_s
  end
  if block
    retrlines(cmd, &amp;block)
  else
    lines = []
    retrlines(cmd) do |line|
      lines &lt;&lt; line
    end
    return lines
  end
end</pre> </div> </div> <div class="aliases"> Also aliased as: <a href="../ftp/#method-i-ls">ls</a>, <a href="../ftp/#method-i-dir">dir</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-login"> <span class="method-name">login</span><span class="method-args">(user = "anonymous", passwd = nil, acct = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Logs in to the remote host. The session must have been previously connected. If <code>user</code> is the string “anonymous” and the <code>password</code> is <code>nil</code>, “anonymous@” is used as a password. If the <code>acct</code> parameter is not <code>nil</code>, an <a href="../ftp/">FTP</a> ACCT command is sent following the successful login. Raises an exception on error (typically <code>Net::FTPPermError</code>).</p> <div class="method-source-code" id="login-source"> <pre class="ruby"># File lib/net/ftp.rb, line 454
def login(user = "anonymous", passwd = nil, acct = nil)
  if user == "anonymous" and passwd == nil
    passwd = "anonymous@"
  end

  resp = ""
  synchronize do
    resp = sendcmd('USER ' + user)
    if resp[0] == ?3
      raise FTPReplyError, resp if passwd.nil?
      resp = sendcmd('PASS ' + passwd)
    end
    if resp[0] == ?3
      raise FTPReplyError, resp if acct.nil?
      resp = sendcmd('ACCT ' + acct)
    end
  end
  if resp[0] != ?2
    raise FTPReplyError, resp
  end
  @welcome = resp
  send_type_command
  @logged_in = true
end</pre> </div> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-ls"> <span class="method-name">ls</span><span class="method-args">(*args)</span> </div>  <div class="aliases"> Alias for: <a href="../ftp/#method-i-list">list</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-mdtm"> <span class="method-name">mdtm</span><span class="method-args">(filename)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns the raw last modification time of the (remote) file in the format “YYYYMMDDhhmmss” (MDTM command).</p> <p>Use <code>mtime</code> if you want a parsed <a href="../../time/">Time</a> instance.</p> <div class="method-source-code" id="mdtm-source"> <pre class="ruby"># File lib/net/ftp.rb, line 907
def mdtm(filename)
  resp = sendcmd("MDTM " + filename)
  if resp[0, 3] == "213"
    return resp[3 .. -1].strip
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-mkdir"> <span class="method-name">mkdir</span><span class="method-args">(dirname)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Creates a remote directory.</p> <div class="method-source-code" id="mkdir-source"> <pre class="ruby"># File lib/net/ftp.rb, line 845
def mkdir(dirname)
  resp = sendcmd("MKD " + dirname)
  return parse257(resp)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-mtime"> <span class="method-name">mtime</span><span class="method-args">(filename, local = false)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns the last modification time of the (remote) file. If <code>local</code> is <code>true</code>, it is returned as a local time, otherwise it's a UTC time.</p> <div class="method-source-code" id="mtime-source"> <pre class="ruby"># File lib/net/ftp.rb, line 836
def mtime(filename, local = false)
  str = mdtm(filename)
  ary = str.scan(MDTM_REGEXP)[0].collect {|i| i.to_i}
  return local ? Time.local(*ary) : Time.gm(*ary)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-nlst"> <span class="method-name">nlst</span><span class="method-args">(dir = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns an array of filenames in the remote directory.</p> <div class="method-source-code" id="nlst-source"> <pre class="ruby"># File lib/net/ftp.rb, line 740
def nlst(dir = nil)
  cmd = "NLST"
  if dir
    cmd = cmd + " " + dir
  end
  files = []
  retrlines(cmd) do |line|
    files.push(line)
  end
  return files
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-noop"> <span class="method-name">noop</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Issues a NOOP command.</p> <p>Does nothing except return a response.</p> <div class="method-source-code" id="noop-source"> <pre class="ruby"># File lib/net/ftp.rb, line 937
def noop
  voidcmd("NOOP")
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-put"> <span class="method-name">put</span><span class="method-args">(localfile, remotefile = File.basename(localfile), blocksize = DEFAULT_BLOCKSIZE, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Transfers <code>localfile</code> to the server in whatever mode the session is set (text or binary). See <a href="../ftp/#method-i-puttextfile">puttextfile</a> and <a href="../ftp/#method-i-putbinaryfile">putbinaryfile</a>.</p> <div class="method-source-code" id="put-source"> <pre class="ruby"># File lib/net/ftp.rb, line 717
def put(localfile, remotefile = File.basename(localfile),
        blocksize = DEFAULT_BLOCKSIZE, &amp;block)
  if @binary
    putbinaryfile(localfile, remotefile, blocksize, &amp;block)
  else
    puttextfile(localfile, remotefile, &amp;block)
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-putbinaryfile"> <span class="method-name">putbinaryfile</span><span class="method-args">(localfile, remotefile = File.basename(localfile), blocksize = DEFAULT_BLOCKSIZE) { |data| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Transfers <code>localfile</code> to the server in binary mode, storing the result in <code>remotefile</code>. If a block is supplied, calls it, passing in the transmitted data in <code>blocksize</code> chunks.</p> <div class="method-source-code" id="putbinaryfile-source"> <pre class="ruby"># File lib/net/ftp.rb, line 675
def putbinaryfile(localfile, remotefile = File.basename(localfile),
                  blocksize = DEFAULT_BLOCKSIZE, &amp;block) # :yield: data
  if @resume
    begin
      rest_offset = size(remotefile)
    rescue Net::FTPPermError
      rest_offset = nil
    end
  else
    rest_offset = nil
  end
  f = open(localfile)
  begin
    f.binmode
    if rest_offset
      storbinary("APPE " + remotefile, f, blocksize, rest_offset, &amp;block)
    else
      storbinary("STOR " + remotefile, f, blocksize, rest_offset, &amp;block)
    end
  ensure
    f.close
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-puttextfile"> <span class="method-name">puttextfile</span><span class="method-args">(localfile, remotefile = File.basename(localfile)) { |line| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Transfers <code>localfile</code> to the server in ASCII (text) mode, storing the result in <code>remotefile</code>. If callback or an associated block is supplied, calls it, passing in the transmitted data one line at a time.</p> <div class="method-source-code" id="puttextfile-source"> <pre class="ruby"># File lib/net/ftp.rb, line 704
def puttextfile(localfile, remotefile = File.basename(localfile), &amp;block) # :yield: line
  f = open(localfile)
  begin
    storlines("STOR " + remotefile, f, &amp;block)
  ensure
    f.close
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-pwd"> <span class="method-name">pwd</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns the current remote directory.</p> <div class="method-source-code" id="pwd-source"> <pre class="ruby"># File lib/net/ftp.rb, line 860
def pwd
  resp = sendcmd("PWD")
  return parse257(resp)
end</pre> </div> </div> <div class="aliases"> Also aliased as: <a href="../ftp/#method-i-getdir">getdir</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-quit"> <span class="method-name">quit</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Exits the <a href="../ftp/">FTP</a> session.</p> <div class="method-source-code" id="quit-source"> <pre class="ruby"># File lib/net/ftp.rb, line 928
def quit
  voidcmd("QUIT")
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-read_timeout-3D"> <span class="method-name">read_timeout=</span><span class="method-args">(sec)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Setter for the <a href="../ftp/#attribute-i-read_timeout">#read_timeout</a> attribute.</p> <div class="method-source-code" id="read_timeout-3D-source"> <pre class="ruby"># File lib/net/ftp.rb, line 110
def read_timeout=(sec)
  @sock.read_timeout = sec
  @read_timeout = sec
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-rename"> <span class="method-name">rename</span><span class="method-args">(fromname, toname)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Renames a file on the server.</p> <div class="method-source-code" id="rename-source"> <pre class="ruby"># File lib/net/ftp.rb, line 777
def rename(fromname, toname)
  resp = sendcmd("RNFR " + fromname)
  if resp[0] != ?3
    raise FTPReplyError, resp
  end
  voidcmd("RNTO " + toname)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-retrbinary"> <span class="method-name">retrbinary</span><span class="method-args">(cmd, blocksize, rest_offset = nil) { |data| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Puts the connection into binary (image) mode, issues the given command, and fetches the data returned, passing it to the associated block in chunks of <code>blocksize</code> characters. Note that <code>cmd</code> is a server command (such as “RETR myfile”).</p> <div class="method-source-code" id="retrbinary-source"> <pre class="ruby"># File lib/net/ftp.rb, line 485
def retrbinary(cmd, blocksize, rest_offset = nil) # :yield: data
  synchronize do
    with_binary(true) do
      begin
        conn = transfercmd(cmd, rest_offset)
        loop do
          data = conn.read(blocksize)
          break if data == nil
          yield(data)
        end
        conn.shutdown(Socket::SHUT_WR)
        conn.read_timeout = 1
        conn.read
      ensure
        conn.close if conn
      end
      voidresp
    end
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-retrlines"> <span class="method-name">retrlines</span><span class="method-args">(cmd) { |line| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Puts the connection into ASCII (text) mode, issues the given command, and passes the resulting data, one line at a time, to the associated block. If no block is given, prints the lines. Note that <code>cmd</code> is a server command (such as “RETR myfile”).</p> <div class="method-source-code" id="retrlines-source"> <pre class="ruby"># File lib/net/ftp.rb, line 512
def retrlines(cmd) # :yield: line
  synchronize do
    with_binary(false) do
      begin
        conn = transfercmd(cmd)
        loop do
          line = conn.gets
          break if line == nil
          yield(line.sub(/\r?\n\z/, ""), !line.match(/\n\z/).nil?)
        end
        conn.shutdown(Socket::SHUT_WR)
        conn.read_timeout = 1
        conn.read
      ensure
        conn.close if conn
      end
      voidresp
    end
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-rmdir"> <span class="method-name">rmdir</span><span class="method-args">(dirname)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Removes a remote directory.</p> <div class="method-source-code" id="rmdir-source"> <pre class="ruby"># File lib/net/ftp.rb, line 853
def rmdir(dirname)
  voidcmd("RMD " + dirname)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-sendcmd"> <span class="method-name">sendcmd</span><span class="method-args">(cmd)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Sends a command and returns the response.</p> <div class="method-source-code" id="sendcmd-source"> <pre class="ruby"># File lib/net/ftp.rb, line 352
def sendcmd(cmd)
  synchronize do
    putline(cmd)
    return getresp
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_socket"> <span class="method-name">set_socket</span><span class="method-args">(sock, get_greeting = true)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p><a href="../../set/">Set</a> the socket used to connect to the <a href="../ftp/">FTP</a> server.</p> <p>May raise FTPReplyError if <code>get_greeting</code> is false.</p> <div class="method-source-code" id="set_socket-source"> <pre class="ruby"># File lib/net/ftp.rb, line 257
def set_socket(sock, get_greeting = true)
  synchronize do
    @sock = sock
    if get_greeting
      voidresp
    end
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-site"> <span class="method-name">site</span><span class="method-args">(arg)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Issues a SITE command.</p> <div class="method-source-code" id="site-source"> <pre class="ruby"># File lib/net/ftp.rb, line 944
def site(arg)
  cmd = "SITE " + arg
  voidcmd(cmd)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-size"> <span class="method-name">size</span><span class="method-args">(filename)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns the size of the given (remote) filename.</p> <div class="method-source-code" id="size-source"> <pre class="ruby"># File lib/net/ftp.rb, line 820
def size(filename)
  with_binary(true) do
    resp = sendcmd("SIZE " + filename)
    if resp[0, 3] != "213"
      raise FTPReplyError, resp
    end
    return resp[3..-1].strip.to_i
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-status"> <span class="method-name">status</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns the status (STAT command).</p> <div class="method-source-code" id="status-source"> <pre class="ruby"># File lib/net/ftp.rb, line 894
def status
  line = "STAT" + CRLF
  print "put: STAT\n" if @debug_mode
  @sock.send(line, Socket::MSG_OOB)
  return getresp
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-storbinary"> <span class="method-name">storbinary</span><span class="method-args">(cmd, file, blocksize, rest_offset = nil) { |data| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Puts the connection into binary (image) mode, issues the given server-side command (such as “STOR myfile”), and sends the contents of the file named <code>file</code> to the server. If the optional block is given, it also passes it the data, in chunks of <code>blocksize</code> characters.</p> <div class="method-source-code" id="storbinary-source"> <pre class="ruby"># File lib/net/ftp.rb, line 539
def storbinary(cmd, file, blocksize, rest_offset = nil) # :yield: data
  if rest_offset
    file.seek(rest_offset, IO::SEEK_SET)
  end
  synchronize do
    with_binary(true) do
      conn = transfercmd(cmd)
      loop do
        buf = file.read(blocksize)
        break if buf == nil
        conn.write(buf)
        yield(buf) if block_given?
      end
      conn.close
      voidresp
    end
  end
rescue Errno::EPIPE
  # EPIPE, in this case, means that the data connection was unexpectedly
  # terminated.  Rather than just raising EPIPE to the caller, check the
  # response on the control connection.  If getresp doesn't raise a more
  # appropriate exception, re-raise the original exception.
  getresp
  raise
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-storlines"> <span class="method-name">storlines</span><span class="method-args">(cmd, file) { |line| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Puts the connection into ASCII (text) mode, issues the given server-side command (such as “STOR myfile”), and sends the contents of the file named <code>file</code> to the server, one line at a time. If the optional block is given, it also passes it the lines.</p> <div class="method-source-code" id="storlines-source"> <pre class="ruby"># File lib/net/ftp.rb, line 571
def storlines(cmd, file) # :yield: line
  synchronize do
    with_binary(false) do
      conn = transfercmd(cmd)
      loop do
        buf = file.gets
        break if buf == nil
        if buf[-2, 2] != CRLF
          buf = buf.chomp + CRLF
        end
        conn.write(buf)
        yield(buf) if block_given?
      end
      conn.close
      voidresp
    end
  end
rescue Errno::EPIPE
  # EPIPE, in this case, means that the data connection was unexpectedly
  # terminated.  Rather than just raising EPIPE to the caller, check the
  # response on the control connection.  If getresp doesn't raise a more
  # appropriate exception, re-raise the original exception.
  getresp
  raise
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-system"> <span class="method-name">system</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns system information.</p> <div class="method-source-code" id="system-source"> <pre class="ruby"># File lib/net/ftp.rb, line 869
def system
  resp = sendcmd("SYST")
  if resp[0, 3] != "215"
    raise FTPReplyError, resp
  end
  return resp[4 .. -1]
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-voidcmd"> <span class="method-name">voidcmd</span><span class="method-args">(cmd)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Sends a command and expect a response beginning with '2'.</p> <div class="method-source-code" id="voidcmd-source"> <pre class="ruby"># File lib/net/ftp.rb, line 362
def voidcmd(cmd)
  synchronize do
    putline(cmd)
    voidresp
  end
end</pre> </div> </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-parse_pasv_ipv4_host"> <span class="method-name">parse_pasv_ipv4_host</span><span class="method-args">(s)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="parse_pasv_ipv4_host-source"> <pre class="ruby"># File lib/net/ftp.rb, line 1007
def parse_pasv_ipv4_host(s)
  return s.tr(",", ".")
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-parse_pasv_ipv6_host"> <span class="method-name">parse_pasv_ipv6_host</span><span class="method-args">(s)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="parse_pasv_ipv6_host-source"> <pre class="ruby"># File lib/net/ftp.rb, line 1012
def parse_pasv_ipv6_host(s)
  return s.split(/,/).map { |i|
    "%02x" % i.to_i
  }.each_slice(2).map(&amp;:join).join(":")
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-parse_pasv_port"> <span class="method-name">parse_pasv_port</span><span class="method-args">(s)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="parse_pasv_port-source"> <pre class="ruby"># File lib/net/ftp.rb, line 1019
def parse_pasv_port(s)
  return s.split(/,/).map(&amp;:to_i).inject { |x, y|
    (x &lt;&lt; 8) + y
  }
end</pre> </div> </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2016 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
