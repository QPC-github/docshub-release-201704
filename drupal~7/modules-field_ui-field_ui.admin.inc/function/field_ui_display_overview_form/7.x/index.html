
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Field_ui_display_overview_form - Drupal 7 - W3cubDocs</title>
  
  <meta name="description" content=" Form constructor for the field display settings for a given view mode. ">
  <meta name="keywords" content="function, field, ui, display, overview, form, -, drupal, drupal~7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/drupal~7/modules-field_ui-field_ui.admin.inc/function/field_ui_display_overview_form/7.x/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/drupal~7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/drupal~7/" class="_nav-link" title="" style="margin-left:0;">Drupal 7</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _drupal">
				
<h1 id="page-subtitle">function field_ui_display_overview_form</h1>     <pre class="signature">field_ui_display_overview_form($form, &amp;$form_state, $entity_type, $bundle, $view_mode)</pre> <p>Form constructor for the field display settings for a given view mode.</p> <h3>See also</h3> <p> <a href="../../field_ui_display_overview_multistep_submit/7.x/" title="Form submission handler for buttons in field_ui_display_overview_form()." class="local">field_ui_display_overview_multistep_submit</a>()</p> <p><a href="../../field_ui_display_overview_form_submit/7.x/" title="Form submission handler for field_ui_display_overview_form()." class="local">field_ui_display_overview_form_submit</a>()</p> <h3>Related topics</h3> <div class="view view-api-references view-id-api_references view-display-id-block_related_topics view-dom-id-f292ff6c80e9b847e73c09cbd8c2a9f3"> <div class="view-content"> <dl api-related-topics> <dt><a href="../../../../includes-form.inc/group/forms/7.x/">Form builder functions</a></dt> <dd>Functions that build an abstract representation of a HTML form.</dd> </dl> </div> </div>  <h3>File</h3> 
<dl> <dt>modules/field_ui/<a href="../../../7.x/">field_ui.admin.inc</a>, line 884</dt> <dd>Administrative interface for custom field type creation.</dd> </dl> <h3>Code</h3> <pre class="php" data-language="php">function field_ui_display_overview_form($form, &amp;$form_state, $entity_type, $bundle, $view_mode) {
  $bundle = field_extract_bundle($entity_type, $bundle);

  field_ui_inactive_message($entity_type, $bundle);
  $admin_path = _field_ui_bundle_admin_path($entity_type, $bundle);

  // Gather type information.
  $instances = field_info_instances($entity_type, $bundle);
  $field_types = field_info_field_types();
  $extra_fields = field_info_extra_fields($entity_type, $bundle, 'display');

  $form_state += array(
    'formatter_settings_edit' =&gt; NULL,
  );

  $form += array(
    '#entity_type' =&gt; $entity_type,
    '#bundle' =&gt; $bundle,
    '#view_mode' =&gt; $view_mode,
    '#fields' =&gt; array_keys($instances),
    '#extra' =&gt; array_keys($extra_fields),
  );

  if (empty($instances) &amp;&amp; empty($extra_fields)) {
    drupal_set_message(t('There are no fields yet added. You can add new fields on the &lt;a href="@link"&gt;Manage fields&lt;/a&gt; page.', array('@link' =&gt; url($admin_path . '/fields'))), 'warning');
    return $form;
  }

  $table = array(
    '#type' =&gt; 'field_ui_table',
    '#tree' =&gt; TRUE,
    '#header' =&gt; array(
      t('Field'),
      t('Weight'),
      t('Parent'),
      t('Label'),
      array('data' =&gt; t('Format'), 'colspan' =&gt; 3),
    ),
    '#regions' =&gt; array(
      'visible' =&gt; array('message' =&gt; t('No field is displayed.')),
      'hidden' =&gt; array('title' =&gt; t('Hidden'), 'message' =&gt; t('No field is hidden.')),
    ),
    '#parent_options' =&gt; array(),
    '#attributes' =&gt; array(
      'class' =&gt; array('field-ui-overview'),
      'id' =&gt; 'field-display-overview',
    ),
    // Add Ajax wrapper.
    '#prefix' =&gt; '&lt;div id="field-display-overview-wrapper"&gt;',
    '#suffix' =&gt; '&lt;/div&gt;',
  );

  $field_label_options = array(
    'above' =&gt; t('Above'),
    'inline' =&gt; t('Inline'),
    'hidden' =&gt; '&lt;' . t('Hidden') . '&gt;',
  );
  $extra_visibility_options = array(
    'visible' =&gt; t('Visible'),
    'hidden' =&gt; t('Hidden'),
  );

  // Field rows.
  foreach ($instances as $name =&gt; $instance) {
    $field = field_info_field($instance['field_name']);
    $display = $instance['display'][$view_mode];
    $table[$name] = array(
      '#attributes' =&gt; array('class' =&gt; array('draggable', 'tabledrag-leaf')),
      '#row_type' =&gt; 'field',
      '#region_callback' =&gt; 'field_ui_display_overview_row_region',
      '#js_settings' =&gt; array(
        'rowHandler' =&gt; 'field',
        'defaultFormatter' =&gt; $field_types[$field['type']]['default_formatter'],
      ),
      'human_name' =&gt; array(
        '#markup' =&gt; check_plain($instance['label']),
      ),
      'weight' =&gt; array(
        '#type' =&gt; 'textfield',
        '#title' =&gt; t('Weight for @title', array('@title' =&gt; $instance['label'])),
        '#title_display' =&gt; 'invisible',
        '#default_value' =&gt; $display['weight'],
        '#size' =&gt; 3,
        '#attributes' =&gt; array('class' =&gt; array('field-weight')),
      ),
      'parent_wrapper' =&gt; array(
        'parent' =&gt; array(
          '#type' =&gt; 'select',
          '#title' =&gt; t('Label display for @title', array('@title' =&gt; $instance['label'])),
          '#title_display' =&gt; 'invisible',
          '#options' =&gt; $table['#parent_options'],
          '#empty_value' =&gt; '',
          '#attributes' =&gt; array('class' =&gt; array('field-parent')),
          '#parents' =&gt; array('fields', $name, 'parent'),
        ),
        'hidden_name' =&gt; array(
          '#type' =&gt; 'hidden',
          '#default_value' =&gt; $name,
          '#attributes' =&gt; array('class' =&gt; array('field-name')),
        ),
      ),
      'label' =&gt; array(
        '#type' =&gt; 'select',
        '#title' =&gt; t('Label display for @title', array('@title' =&gt; $instance['label'])),
        '#title_display' =&gt; 'invisible',
        '#options' =&gt; $field_label_options,
        '#default_value' =&gt; $display['label'],
      ),
    );

    $formatter_options = field_ui_formatter_options($field['type']);
    $formatter_options['hidden'] = '&lt;' . t('Hidden') . '&gt;';
    $table[$name]['format'] = array(
      'type' =&gt; array(
        '#type' =&gt; 'select',
        '#title' =&gt; t('Formatter for @title', array('@title' =&gt; $instance['label'])),
        '#title_display' =&gt; 'invisible',
        '#options' =&gt; $formatter_options,
        '#default_value' =&gt; $display['type'],
        '#parents' =&gt; array('fields', $name, 'type'),
        '#attributes' =&gt; array('class' =&gt; array('field-formatter-type')),
      ),
      'settings_edit_form' =&gt; array(),
    );

    // Formatter settings.

    // Check the currently selected formatter, and merge persisted values for
    // formatter settings.
    if (isset($form_state['values']['fields'][$name]['type'])) {
      $formatter_type = $form_state['values']['fields'][$name]['type'];
    }
    else {
      $formatter_type = $display['type'];
    }
    if (isset($form_state['formatter_settings'][$name])) {
      $settings = $form_state['formatter_settings'][$name];
    }
    else {
      $settings = $display['settings'];
    }
    $settings += field_info_formatter_settings($formatter_type);

    $instance['display'][$view_mode]['type'] = $formatter_type;
    $formatter = field_info_formatter_types($formatter_type);
    $instance['display'][$view_mode]['module'] = $formatter['module'];
    $instance['display'][$view_mode]['settings'] = $settings;

    // Base button element for the various formatter settings actions.
    $base_button = array(
      '#submit' =&gt; array('field_ui_display_overview_multistep_submit'),
      '#ajax' =&gt; array(
        'callback' =&gt; 'field_ui_display_overview_multistep_js',
        'wrapper' =&gt; 'field-display-overview-wrapper',
        'effect' =&gt; 'fade',
      ),
      '#field_name' =&gt; $name,
    );

    if ($form_state['formatter_settings_edit'] == $name) {
      // We are currently editing this field's formatter settings. Display the
      // settings form and submit buttons.
      $table[$name]['format']['settings_edit_form'] = array();

      $settings_form = array();
      $function = $formatter['module'] . '_field_formatter_settings_form';
      if (function_exists($function)) {
        $settings_form = $function($field, $instance, $view_mode, $form, $form_state);
      }

      if ($settings_form) {
        $table[$name]['format']['#cell_attributes'] = array('colspan' =&gt; 3);
        $table[$name]['format']['settings_edit_form'] = array(
          '#type' =&gt; 'container',
          '#attributes' =&gt; array('class' =&gt; array('field-formatter-settings-edit-form')),
          '#parents' =&gt; array('fields', $name, 'settings_edit_form'),
          'label' =&gt; array(
            '#markup' =&gt; t('Format settings:') . ' &lt;span class="formatter-name"&gt;' . $formatter['label'] . '&lt;/span&gt;',
          ),
          'settings' =&gt; $settings_form,
          'actions' =&gt; array(
            '#type' =&gt; 'actions',
            'save_settings' =&gt; $base_button + array(
              '#type' =&gt; 'submit',
              '#name' =&gt; $name . '_formatter_settings_update',
              '#value' =&gt; t('Update'),
              '#op' =&gt; 'update',
            ),
            'cancel_settings' =&gt; $base_button + array(
              '#type' =&gt; 'submit',
              '#name' =&gt; $name . '_formatter_settings_cancel',
              '#value' =&gt; t('Cancel'),
              '#op' =&gt; 'cancel',
              // Do not check errors for the 'Cancel' button, but make sure we
              // get the value of the 'formatter type' select.
              '#limit_validation_errors' =&gt; array(array('fields', $name, 'type')),
            ),
          ),
        );
        $table[$name]['#attributes']['class'][] = 'field-formatter-settings-editing';
      }
    }
    else {
      // Display a summary of the current formatter settings.
      $summary = module_invoke($formatter['module'], 'field_formatter_settings_summary', $field, $instance, $view_mode);
      $table[$name]['settings_summary'] = array();
      $table[$name]['settings_edit'] = array();
      if ($summary) {
        $table[$name]['settings_summary'] = array(
          '#markup' =&gt; '&lt;div class="field-formatter-summary"&gt;' . $summary . '&lt;/div&gt;',
          '#cell_attributes' =&gt; array('class' =&gt; array('field-formatter-summary-cell')),
        );
        $table[$name]['settings_edit'] = $base_button + array(
          '#type' =&gt; 'image_button',
          '#name' =&gt; $name . '_formatter_settings_edit',
          '#src' =&gt; 'misc/configure.png',
          '#attributes' =&gt; array('class' =&gt; array('field-formatter-settings-edit'), 'alt' =&gt; t('Edit')),
          '#op' =&gt; 'edit',
          // Do not check errors for the 'Edit' button, but make sure we get
          // the value of the 'formatter type' select.
          '#limit_validation_errors' =&gt; array(array('fields', $name, 'type')),
          '#prefix' =&gt; '&lt;div class="field-formatter-settings-edit-wrapper"&gt;',
          '#suffix' =&gt; '&lt;/div&gt;',
        );
      }
    }
  }

  // Non-field elements.
  foreach ($extra_fields as $name =&gt; $extra_field) {
    $display = $extra_field['display'][$view_mode];
    $table[$name] = array(
      '#attributes' =&gt; array('class' =&gt; array('draggable', 'tabledrag-leaf')),
      '#row_type' =&gt; 'extra_field',
      '#region_callback' =&gt; 'field_ui_display_overview_row_region',
      '#js_settings' =&gt; array('rowHandler' =&gt; 'field'),
      'human_name' =&gt; array(
        '#markup' =&gt; check_plain($extra_field['label']),
      ),
      'weight' =&gt; array(
        '#type' =&gt; 'textfield',
        '#title' =&gt; t('Weight for @title', array('@title' =&gt; $extra_field['label'])),
        '#title_display' =&gt; 'invisible',
        '#default_value' =&gt; $display['weight'],
        '#size' =&gt; 3,
        '#attributes' =&gt; array('class' =&gt; array('field-weight')),
      ),
      'parent_wrapper' =&gt; array(
        'parent' =&gt; array(
          '#type' =&gt; 'select',
          '#title' =&gt; t('Parents for @title', array('@title' =&gt; $extra_field['label'])),
          '#title_display' =&gt; 'invisible',
          '#options' =&gt; $table['#parent_options'],
          '#empty_value' =&gt; '',
          '#attributes' =&gt; array('class' =&gt; array('field-parent')),
          '#parents' =&gt; array('fields', $name, 'parent'),
        ),
        'hidden_name' =&gt; array(
          '#type' =&gt; 'hidden',
          '#default_value' =&gt; $name,
          '#attributes' =&gt; array('class' =&gt; array('field-name')),
        ),
      ),
      'empty_cell' =&gt; array(
        '#markup' =&gt; '&amp;nbsp;',
      ),
      'format' =&gt; array(
        'type' =&gt; array(
          '#type' =&gt; 'select',
          '#title' =&gt; t('Visibility for @title', array('@title' =&gt; $extra_field['label'])),
          '#title_display' =&gt; 'invisible',
          '#options' =&gt; $extra_visibility_options,
          '#default_value' =&gt; $display['visible'] ? 'visible' : 'hidden',
          '#parents' =&gt; array('fields', $name, 'type'),
          '#attributes' =&gt; array('class' =&gt; array('field-formatter-type')),
        ),
      ),
      'settings_summary' =&gt; array(),
      'settings_edit' =&gt; array(),
    );
  }

  $form['fields'] = $table;

  // Custom display settings.
  if ($view_mode == 'default') {
    $form['modes'] = array(
      '#type' =&gt; 'fieldset',
      '#title' =&gt; t('Custom display settings'),
      '#collapsible' =&gt; TRUE,
      '#collapsed' =&gt; TRUE,
    );
    // Collect options and default values for the 'Custom display settings'
    // checkboxes.
    $options = array();
    $default = array();
    $entity_info = entity_get_info($entity_type);
    $view_modes = $entity_info['view modes'];
    $view_mode_settings = field_view_mode_settings($entity_type, $bundle);
    foreach ($view_modes as $view_mode_name =&gt; $view_mode_info) {
      $options[$view_mode_name] = $view_mode_info['label'];
      if (!empty($view_mode_settings[$view_mode_name]['custom_settings'])) {
        $default[] = $view_mode_name;
      }
    }
    $form['modes']['view_modes_custom'] = array(
      '#type' =&gt; 'checkboxes',
      '#title' =&gt; t('Use custom display settings for the following view modes'),
      '#options' =&gt; $options,
      '#default_value' =&gt; $default,
    );
  }

  // In overviews involving nested rows from contributed modules (i.e
  // field_group), the 'format type' selects can trigger a series of changes in
  // child rows. The #ajax behavior is therefore not attached directly to the
  // selects, but triggered by the client-side script through a hidden #ajax
  // 'Refresh' button. A hidden 'refresh_rows' input tracks the name of
  // affected rows.
  $form['refresh_rows'] = array('#type' =&gt; 'hidden');
  $form['refresh'] = array(
    '#type' =&gt; 'submit',
    '#value' =&gt; t('Refresh'),
    '#op' =&gt; 'refresh_table',
    '#submit' =&gt; array('field_ui_display_overview_multistep_submit'),
    '#ajax' =&gt; array(
      'callback' =&gt; 'field_ui_display_overview_multistep_js',
      'wrapper' =&gt; 'field-display-overview-wrapper',
      'effect' =&gt; 'fade',
      // The button stays hidden, so we hide the Ajax spinner too. Ad-hoc
      // spinners will be added manually by the client-side script.
      'progress' =&gt; 'none',
    ),
  );

  $form['actions'] = array('#type' =&gt; 'actions');
  $form['actions']['submit'] = array('#type' =&gt; 'submit', '#value' =&gt; t('Save'));

  $form['#attached']['js'][] = drupal_get_path('module', 'field_ui') . '/field_ui.js';
  $form['#attached']['css'][] = drupal_get_path('module', 'field_ui') . '/field_ui.css';

  // Add tabledrag behavior.
  $form['#attached']['drupal_add_tabledrag'][] = array('field-display-overview', 'order', 'sibling', 'field-weight');
  $form['#attached']['drupal_add_tabledrag'][] = array('field-display-overview', 'match', 'parent', 'field-parent', 'field-parent', 'field-name');

  return $form;
}
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    © 2001–2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/modules!field_ui!field_ui.admin.inc/function/field_ui_display_overview_form/7.x" class="_attribution-link" target="_blank">https://api.drupal.org/api/drupal/modules!field_ui!field_ui.admin.inc/function/field_ui_display_overview_form/7.x</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
