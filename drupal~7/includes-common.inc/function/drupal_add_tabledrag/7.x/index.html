
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Drupal_add_tabledrag - Drupal 7 - W3cubDocs</title>
  
  <meta name="description" content=" Assists in adding the tableDrag JavaScript behavior to a themed table. ">
  <meta name="keywords" content="function, drupal, add, tabledrag, -, drupal~7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/drupal~7/includes-common.inc/function/drupal_add_tabledrag/7.x/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/drupal~7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/drupal~7/" class="_nav-link" title="" style="margin-left:0;">Drupal 7</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _drupal">
				
<h1 id="page-subtitle">function drupal_add_tabledrag</h1>     <pre class="signature">drupal_add_tabledrag($table_id, $action, $relationship, $group, $subgroup = NULL, $source = NULL, $hidden = TRUE, $limit = 0)</pre> <p>Assists in adding the tableDrag JavaScript behavior to a themed table.</p> <p>Draggable tables should be used wherever an outline or list of sortable items needs to be arranged by an end-user. Draggable tables are very flexible and can manipulate the value of form elements placed within individual columns.</p> <p>To set up a table to use drag and drop in place of weight select-lists or in place of a form that contains parent relationships, the form must be themed into a table. The table must have an ID attribute set. If using <a href="../../../../includes-theme.inc/function/theme_table/7.x/" title="Returns HTML for a table." class="local">theme_table</a>(), the ID may be set as follows:</p> <pre class="php" data-language="php">$output = theme('table', array('header' =&gt; $header, 'rows' =&gt; $rows, 'attributes' =&gt; array('id' =&gt; 'my-module-table')));
return $output;
</pre>
<p> In the theme function for the form, a special class must be added to each form element within the same column, "grouping" them together.</p> <p>In a situation where a single weight column is being sorted in the table, the classes could be added like this (in the theme function):</p> <pre class="php" data-language="php">$form['my_elements'][$delta]['weight']['#attributes']['class'] = array('my-elements-weight');
</pre>
<p> Each row of the table must also have a class of "draggable" in order to enable the drag handles:</p> <pre class="php" data-language="php">$row = array(...);
$rows[] = array(
  'data' =&gt; $row,
  'class' =&gt; array('draggable'),
);
</pre>
<p> When tree relationships are present, the two additional classes 'tabledrag-leaf' and 'tabledrag-root' can be used to refine the behavior:</p> <ul> <li>Rows with the 'tabledrag-leaf' class cannot have child rows.</li> <li>Rows with the 'tabledrag-root' class cannot be nested under a parent row.</li> </ul> <p>Calling <a href="../7.x/" title="Assists in adding the tableDrag JavaScript behavior to a themed table." class="local active">drupal_add_tabledrag</a>() would then be written as such:</p> <pre class="php" data-language="php">drupal_add_tabledrag('my-module-table', 'order', 'sibling', 'my-elements-weight');
</pre>
<p> In a more complex case where there are several groups in one column (such as the block regions on the admin/structure/block page), a separate subgroup class must also be added to differentiate the groups.</p> <pre class="php" data-language="php">$form['my_elements'][$region][$delta]['weight']['#attributes']['class'] = array('my-elements-weight', 'my-elements-weight-' . $region);
</pre>
<p> $group is still 'my-element-weight', and the additional $subgroup variable will be passed in as 'my-elements-weight-' . $region. This also means that you'll need to call <a href="../7.x/" title="Assists in adding the tableDrag JavaScript behavior to a themed table." class="local active">drupal_add_tabledrag</a>() once for every region added.</p> <pre class="php" data-language="php">foreach ($regions as $region) {
  drupal_add_tabledrag('my-module-table', 'order', 'sibling', 'my-elements-weight', 'my-elements-weight-' . $region);
}
</pre>
<p> In a situation where tree relationships are present, adding multiple subgroups is not necessary, because the table will contain indentations that provide enough information about the sibling and parent relationships. See <a href="../../../../modules-menu-menu.admin.inc/function/theme_menu_overview_form/7.x/" title="Returns HTML for the menu overview form into a table." class="local">theme_menu_overview_form</a>() for an example creating a table containing parent relationships.</p> <p>Note that this function should be called from the theme layer, such as in a .tpl.php file, theme_ function, or in a template_preprocess function, not in a form declaration. Though the same JavaScript could be added to the page using <a href="../../drupal_add_js/7.x/" title="Adds a JavaScript file, setting, or inline code to the page." class="local">drupal_add_js</a>() directly, this function helps keep template files clean and readable. It also prevents tabledrag.js from being added twice accidentally.</p> <h3>Parameters</h3> <p> <strong>$table_id</strong>: String containing the target table's id attribute. If the table does not have an id, one will need to be set, such as &lt;table id="my-module-table"&gt;.</p> <p><strong>$action</strong>: String describing the action to be done on the form item. Either 'match' 'depth', or 'order'. Match is typically used for parent relationships. Order is typically used to set weights on other form elements with the same group. Depth updates the target element with the current indentation.</p> <p><strong>$relationship</strong>: String describing where the $action variable should be performed. Either 'parent', 'sibling', 'group', or 'self'. Parent will only look for fields up the tree. Sibling will look for fields in the same group in rows above and below it. Self affects the dragged row itself. Group affects the dragged row, plus any children below it (the entire dragged group).</p> <p><strong>$group</strong>: A class name applied on all related form elements for this action.</p> <p><strong>$subgroup</strong>: (optional) If the group has several subgroups within it, this string should contain the class name identifying fields in the same subgroup.</p> <p><strong>$source</strong>: (optional) If the $action is 'match', this string should contain the class name identifying what field will be used as the source value when matching the value in $subgroup.</p> <p><strong>$hidden</strong>: (optional) The column containing the field elements may be entirely hidden from view dynamically when the JavaScript is loaded. Set to FALSE if the column should not be hidden.</p> <p><strong>$limit</strong>: (optional) Limit the maximum amount of parenting in this table.</p> <h3>See also</h3> <p> <a href="../../../../modules-block-block-admin-display-form.tpl.php/7.x/" title="Default theme implementation to configure blocks." class="local">block-admin-display-form.tpl.php</a></p> <p><a href="../../../../modules-menu-menu.admin.inc/function/theme_menu_overview_form/7.x/" title="Returns HTML for the menu overview form into a table." class="local">theme_menu_overview_form</a>()</p>  <h3>File</h3> 
<dl> <dt>includes/<a href="../../../7.x/">common.inc</a>, line 5007</dt> <dd>Common functions that many Drupal modules will need to reference.</dd> </dl> <h3>Code</h3> <pre class="php" data-language="php">function drupal_add_tabledrag($table_id, $action, $relationship, $group, $subgroup = NULL, $source = NULL, $hidden = TRUE, $limit = 0) {
  $js_added = &amp;drupal_static(__FUNCTION__, FALSE);
  if (!$js_added) {
    // Add the table drag JavaScript to the page before the module JavaScript
    // to ensure that table drag behaviors are registered before any module
    // uses it.
    drupal_add_library('system', 'jquery.cookie');
    drupal_add_js('misc/tabledrag.js', array('weight' =&gt; -1));
    $js_added = TRUE;
  }

  // If a subgroup or source isn't set, assume it is the same as the group.
  $target = isset($subgroup) ? $subgroup : $group;
  $source = isset($source) ? $source : $target;
  $settings['tableDrag'][$table_id][$group][] = array(
    'target' =&gt; $target,
    'source' =&gt; $source,
    'relationship' =&gt; $relationship,
    'action' =&gt; $action,
    'hidden' =&gt; $hidden,
    'limit' =&gt; $limit,
  );
  drupal_add_js($settings, 'setting');
}
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    © 2001–2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/includes!common.inc/function/drupal_add_tabledrag/7.x" class="_attribution-link" target="_blank">https://api.drupal.org/api/drupal/includes!common.inc/function/drupal_add_tabledrag/7.x</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
