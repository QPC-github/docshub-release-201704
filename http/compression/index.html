
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Compression - HTTP - W3cubDocs</title>
  
  <meta name="description" content="Compression is an important way to increase the performance of a Web site. For some documents, size reduction of up to 70% lowers the bandwidth &hellip;">
  <meta name="keywords" content="compression, -, http">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/http/compression/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/http.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/http/" class="_nav-link" title="" style="margin-left:0;">HTTP</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _mdn">
				
<h1>Compression</h1> <p class="summary"><strong>Compression</strong> is an important way to increase the performance of a Web site. For some documents, size reduction of up to 70% lowers the bandwidth capacity needs. Over the years, algorithms also got more efficient, and new ones are supported by clients and servers.</p> <p>In practice, web developers don't need to implement compression mechanisms, both browsers and servers have it implemented already, but they have to be sure that the server is configured adequately. Compression happens at three different levels:</p> <ul> <li>first some file formats are compressed with specific optimized methods,</li> <li>then general encryption can happen at the HTTP level (the resource is transmitted compressed from end to end,</li> <li>and finally compression can be defined at the connection level, between two nodes of an HTTP connection.</li> </ul> <h2 id="File_format_compression">File format compression</h2> <p>Each data type has some redundancy, that is <em>wasted space</em>, in it. If text can typically have as much as 60% redundancy, this rate can be much higher for some other media like audio and video. Unlike text, these other media types are taking a lot of space to store and the need to regain this wasted space appeared very early. Engineers designed optimized compression algorithm used by file formats designed for specific purpose. Compression algorithms used for files can be grouped in two wide categories:</p> <ul> <li>
<em>Loss-less compression</em>, where the compression-uncompression cycle doesn't alter the data that is recovered. It matches (byte to byte) with the original.<br> For images, <code>gif</code> or <code>png</code> are using loss-less compression.</li> <li>
<em>Lossy compression</em>, where the cycle alters the original data, in an imperceptible way for the user.<br> Video formats on the Web are lossy and for images, <code>jpeg</code> is.</li> </ul> <p>Some formats can be used for both loss-less or lossy compression, like <code>webp</code>, and usually lossy algorithm can be configured to compress more or less, which then of course leads less or more quality. For better performance of a site site, it is ideal to compress as much as possible, while keeping an acceptable level of quality. For images, an image generated by a tool could be not optimized enough for the Web; it is recommended to use tools that will compress as much as possible with the required quality. There are <a href="http://www.creativebloq.com/design/image-compression-tools-1132865" target="_blank">numerous tools</a> that are specialized for this.</p> <p>Lossy compression algorithms are usually more efficient that loss-less ones.</p> <div class="note"> <p>As compression works better on a specific kind of files, it usually provides nothing to compress them a second time. In fact, this is often counter productive as the cost of the overhead (algorithms usually need a dictionary that add to the initial size) can be higher than the extra gain in compression resulting in a larger file. Do not use the two following techniques for files in a compressed format.</p> </div> <h2 id="End-to-end_compression">End-to-end compression</h2> <p>For compression, end-to-end compression is where the largest performance improvements of Web sites reside. End-to-end compression refers to a compression of the body of a message that is done by the server and will last unchanged until it reaches the client. Whatever the intermediate nodes are, they leave the body untouched.</p> <p><img src="https://mdn.mozillademos.org/files/13801/HTTPEnco1.png" style="height: 307px; width: 955px;" alt=""></p> <p>All modern browsers and servers do support it and the only thing to negotiate is the compression algorithm to use. These algorithm are optimized for text. In the 1990s, compression technology was advancing at a rapid pace and numerous successive algorithms have been added to the set of possible choices. Nowadays, only two are relevant: <code>gzip</code>, the most common one, and <code>br</code> the new challenger.</p> <p>To select the algorithm to use, browsers and servers use <a href="../content_negotiation/">proactive content negotiation</a>. The browser sends an <a href="../headers/accept-encoding/" title="The Accept-Encoding request HTTP header advertises which content encoding, usually a compression algorithm, the client is able to understand. Using content negotiation, the server selects one of the proposals, uses it and informs the client of its choice with the Content-Encoding response header."><code>Accept-Encoding</code></a> header with the algorithm it supports and its order of precedence, the server picks one, uses it to compress the body of the response and uses the <a href="../headers/content-encoding/" title="The Content-Encoding entity header is used to compress the media-type. When present, its value indicates what additional content encoding has been applied to the entity-body. It lets the client know, how to decode in order to obtain the media-type referenced by the Content-Type header."><code>Content-Encoding</code></a> header to tell the browser the algorithm it has chosen. As content negotiation has been used to chose a representation based on its encoding, a <a href="../headers/vary/" title="The Vary HTTP response header determines how to match future request headers to decide whether a cached response can be used rather than requesting a fresh one from the origin server. It is used by the server to indicate which headers it used when selecting a representation of a resource in a content negotiation algorithm."><code>Vary</code></a> header containing at least <a href="../headers/content-encoding/" title="The Content-Encoding entity header is used to compress the media-type. When present, its value indicates what additional content encoding has been applied to the entity-body. It lets the client know, how to decode in order to obtain the media-type referenced by the Content-Type header."><code>Content-Encoding</code></a> must be sent alongside this header in the response; that way, cache will be able to cache the different representations of the resource.</p> <p><img src="https://mdn.mozillademos.org/files/13811/HTTPCompression1.png" style="height: 307px; width: 771px;" alt=""></p> <p>As compression brings significant performance improvements, it is recommended to activate it for all files, but already compressed ones like images, audio files and videos.</p> <p>Apache supports compression and uses <a href="http://httpd.apache.org/docs/current/mod/mod_deflate.html" target="_blank">mod_deflate</a>; for nginx there is <a href="http://nginx.org/en/docs/http/ngx_http_gzip_module.html" target="_blank">ngx_http_gzip_module</a>; for IIS, the <code><a href="https://www.iis.net/configreference/system.webserver/httpcompression" target="_blank">&lt;httpCompression&gt;</a></code> element.</p> <h2 id="Hop-by-hop_compression">Hop-by-hop compression</h2> <p>Hop-by-hop compression, though similar to end-to-end compression, differs by one fundamental element: the compression doesn't happen on the resource in the server, creating a specific representation that is then transmitted, but on the body of the message between any two nodes on the path between the client and the server. Connections between successive intermediate nodes may apply a <em>different</em> compression.</p> <p><img src="https://mdn.mozillademos.org/files/13807/HTTPTE1.png" alt=""></p> <p>To do this, HTTP uses a mechanism similar to the content negotiation for end-to-end compression: the node transmitting the request advertizes its will using the <a href="../headers/te/" title="The TE request header specifies the transfer encodings the user agent is willing to accept. (you could informally call it Accept-Transfer-Encoding, which would be more intuitive)."><code>TE</code></a> header and the other node chooses the adequate method, applies it, and indicates its choice with the <a href="../headers/transfer-encoding/" title="The Transfer-Encoding header specifies the form of encoding used to safely transfer the entity to the user."><code>Transfer-Encoding</code></a> header.</p> <p><img src="https://mdn.mozillademos.org/files/13809/HTTPComp2.png" alt=""></p> <p>In practice, hop-by-hop compression is transparent for the server and the client, and is rarely used. <a href="../headers/te/" title="The TE request header specifies the transfer encodings the user agent is willing to accept. (you could informally call it Accept-Transfer-Encoding, which would be more intuitive)."><code>TE</code></a> and <a href="../headers/transfer-encoding/" title="The Transfer-Encoding header specifies the form of encoding used to safely transfer the entity to the user."><code>Transfer-Encoding</code></a> are mostly used to send a response by chunks, allowing to start transmitting a resource without knowing its length.</p> <p>Note that using <a href="../headers/transfer-encoding/" title="The Transfer-Encoding header specifies the form of encoding used to safely transfer the entity to the user."><code>Transfer-Encoding</code></a> and compression at the hop level is so rare that most servers, like Apache, nginx, or IIS, have no easy way to configure it. Such configuration usually happens at the proxy level.</p>
<div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Compression%24edit" class="_attribution-link" target="_blank">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Compression" class="_attribution-link" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTTP/Compression</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
