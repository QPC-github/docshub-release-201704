
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>CREATE TRIGGER - SQLite - W3cubDocs</title>
  
  <meta name="description" content=" [Top] ">
  <meta name="keywords" content="sql, understood, sqlite, create, trigger, -">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/sqlite/lang_createtrigger/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/sqlite.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/sqlite/" class="_nav-link" title="" style="margin-left:0;">SQLite</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sqlite">
				
<h1>SQL As Understood By SQLite</h1>
<p><a href="../lang/">[Top]</a></p>
<h2>CREATE TRIGGER</h2>
<p><b><a href="../syntax/create-trigger-stmt/">create-trigger-stmt:</a></b> <button id="x929" class="_btn" data-toggle="x930">hide</button></p> <div id="x930" class="imgcontainer"> <img alt="syntax diagram create-trigger-stmt" src="https://sqlite.org/images/syntax/create-trigger-stmt.gif"> <p><b><a href="../syntax/delete-stmt/">delete-stmt:</a></b> <button id="x931" class="_btn" data-toggle="x932">show</button></p> <div id="x932" style="display:none;" class="imgcontainer"> <img alt="syntax diagram delete-stmt" src="https://sqlite.org/images/syntax/delete-stmt.gif"> <p><b><a href="../syntax/qualified-table-name/">qualified-table-name:</a></b> <button id="x933" class="_btn" data-toggle="x934">show</button></p> <div id="x934" style="display:none;" class="imgcontainer"> <img alt="syntax diagram qualified-table-name" src="https://sqlite.org/images/syntax/qualified-table-name.gif"> </div> <p><b><a href="../syntax/with-clause/">with-clause:</a></b> <button id="x935" class="_btn" data-toggle="x936">show</button></p> <div id="x936" style="display:none;" class="imgcontainer"> <img alt="syntax diagram with-clause" src="https://sqlite.org/images/syntax/with-clause.gif"> <p><b><a href="../syntax/cte-table-name/">cte-table-name:</a></b> <button id="x937" class="_btn" data-toggle="x938">show</button></p> <div id="x938" style="display:none;" class="imgcontainer"> <img alt="syntax diagram cte-table-name" src="https://sqlite.org/images/syntax/cte-table-name.gif"> </div> </div> </div> <p><b><a href="../syntax/expr/">expr:</a></b> <button id="x939" class="_btn" data-toggle="x940">show</button></p> <div id="x940" style="display:none;" class="imgcontainer"> <img alt="syntax diagram expr" src="https://sqlite.org/images/syntax/expr.gif"> <p><b><a href="../syntax/literal-value/">literal-value:</a></b> <button id="x941" class="_btn" data-toggle="x942">show</button></p> <div id="x942" style="display:none;" class="imgcontainer"> <img alt="syntax diagram literal-value" src="https://sqlite.org/images/syntax/literal-value.gif"> </div> <p><b><a href="../syntax/raise-function/">raise-function:</a></b> <button id="x943" class="_btn" data-toggle="x944">show</button></p> <div id="x944" style="display:none;" class="imgcontainer"> <img alt="syntax diagram raise-function" src="https://sqlite.org/images/syntax/raise-function.gif"> </div> <p><b><a href="../syntax/type-name/">type-name:</a></b> <button id="x945" class="_btn" data-toggle="x946">show</button></p> <div id="x946" style="display:none;" class="imgcontainer"> <img alt="syntax diagram type-name" src="https://sqlite.org/images/syntax/type-name.gif"> <p><b><a href="../syntax/signed-number/">signed-number:</a></b> <button id="x947" class="_btn" data-toggle="x948">show</button></p> <div id="x948" style="display:none;" class="imgcontainer"> <img alt="syntax diagram signed-number" src="https://sqlite.org/images/syntax/signed-number.gif"> </div> </div> </div> <p><b><a href="../syntax/insert-stmt/">insert-stmt:</a></b> <button id="x949" class="_btn" data-toggle="x950">show</button></p> <div id="x950" style="display:none;" class="imgcontainer"> <img alt="syntax diagram insert-stmt" src="https://sqlite.org/images/syntax/insert-stmt.gif"> <p><b><a href="../syntax/with-clause/">with-clause:</a></b> <button id="x951" class="_btn" data-toggle="x952">show</button></p> <div id="x952" style="display:none;" class="imgcontainer"> <img alt="syntax diagram with-clause" src="https://sqlite.org/images/syntax/with-clause.gif"> <p><b><a href="../syntax/cte-table-name/">cte-table-name:</a></b> <button id="x953" class="_btn" data-toggle="x954">show</button></p> <div id="x954" style="display:none;" class="imgcontainer"> <img alt="syntax diagram cte-table-name" src="https://sqlite.org/images/syntax/cte-table-name.gif"> </div> </div> </div> <p><b><a href="../syntax/select-stmt/">select-stmt:</a></b> <button id="x955" class="_btn" data-toggle="x956">show</button></p> <div id="x956" style="display:none;" class="imgcontainer"> <img alt="syntax diagram select-stmt" src="https://sqlite.org/images/syntax/select-stmt.gif"> <p><b><a href="../syntax/common-table-expression/">common-table-expression:</a></b> <button id="x957" class="_btn" data-toggle="x958">show</button></p> <div id="x958" style="display:none;" class="imgcontainer"> <img alt="syntax diagram common-table-expression" src="https://sqlite.org/images/syntax/common-table-expression.gif"> </div> <p><b><a href="../syntax/compound-operator/">compound-operator:</a></b> <button id="x959" class="_btn" data-toggle="x960">show</button></p> <div id="x960" style="display:none;" class="imgcontainer"> <img alt="syntax diagram compound-operator" src="https://sqlite.org/images/syntax/compound-operator.gif"> </div> <p><b><a href="../syntax/join-clause/">join-clause:</a></b> <button id="x961" class="_btn" data-toggle="x962">show</button></p> <div id="x962" style="display:none;" class="imgcontainer"> <img alt="syntax diagram join-clause" src="https://sqlite.org/images/syntax/join-clause.gif"> <p><b><a href="../syntax/join-constraint/">join-constraint:</a></b> <button id="x963" class="_btn" data-toggle="x964">show</button></p> <div id="x964" style="display:none;" class="imgcontainer"> <img alt="syntax diagram join-constraint" src="https://sqlite.org/images/syntax/join-constraint.gif"> </div> <p><b><a href="../syntax/join-operator/">join-operator:</a></b> <button id="x965" class="_btn" data-toggle="x966">show</button></p> <div id="x966" style="display:none;" class="imgcontainer"> <img alt="syntax diagram join-operator" src="https://sqlite.org/images/syntax/join-operator.gif"> </div> </div> <p><b><a href="../syntax/ordering-term/">ordering-term:</a></b> <button id="x967" class="_btn" data-toggle="x968">show</button></p> <div id="x968" style="display:none;" class="imgcontainer"> <img alt="syntax diagram ordering-term" src="https://sqlite.org/images/syntax/ordering-term.gif"> </div> <p><b><a href="../syntax/result-column/">result-column:</a></b> <button id="x969" class="_btn" data-toggle="x970">show</button></p> <div id="x970" style="display:none;" class="imgcontainer"> <img alt="syntax diagram result-column" src="https://sqlite.org/images/syntax/result-column.gif"> </div> <p><b><a href="../syntax/table-or-subquery/">table-or-subquery:</a></b> <button id="x971" class="_btn" data-toggle="x972">show</button></p> <div id="x972" style="display:none;" class="imgcontainer"> <img alt="syntax diagram table-or-subquery" src="https://sqlite.org/images/syntax/table-or-subquery.gif"> </div> </div> <p><b><a href="../syntax/update-stmt/">update-stmt:</a></b> <button id="x973" class="_btn" data-toggle="x974">show</button></p> <div id="x974" style="display:none;" class="imgcontainer"> <img alt="syntax diagram update-stmt" src="https://sqlite.org/images/syntax/update-stmt.gif"> <p><b><a href="../syntax/column-name-list/">column-name-list:</a></b> <button id="x975" class="_btn" data-toggle="x976">show</button></p> <div id="x976" style="display:none;" class="imgcontainer"> <img alt="syntax diagram column-name-list" src="https://sqlite.org/images/syntax/column-name-list.gif"> </div> <p><b><a href="../syntax/qualified-table-name/">qualified-table-name:</a></b> <button id="x977" class="_btn" data-toggle="x978">show</button></p> <div id="x978" style="display:none;" class="imgcontainer"> <img alt="syntax diagram qualified-table-name" src="https://sqlite.org/images/syntax/qualified-table-name.gif"> </div> <p><b><a href="../syntax/with-clause/">with-clause:</a></b> <button id="x979" class="_btn" data-toggle="x980">show</button></p> <div id="x980" style="display:none;" class="imgcontainer"> <img alt="syntax diagram with-clause" src="https://sqlite.org/images/syntax/with-clause.gif"> <p><b><a href="../syntax/cte-table-name/">cte-table-name:</a></b> <button id="x981" class="_btn" data-toggle="x982">show</button></p> <div id="x982" style="display:none;" class="imgcontainer"> <img alt="syntax diagram cte-table-name" src="https://sqlite.org/images/syntax/cte-table-name.gif"> </div> </div> </div> </div> <p>The CREATE TRIGGER statement is used to add triggers to the database schema. Triggers are database operations that are automatically performed when a specified database event occurs. </p> <p>A trigger may be specified to fire whenever a <a href="../lang_delete/">DELETE</a>, <a href="../lang_insert/">INSERT</a>, or <a href="../lang_update/">UPDATE</a> of a particular database table occurs, or whenever an <a href="../lang_update/">UPDATE</a> occurs on on one or more specified columns of a table.</p> <p>At this time SQLite supports only FOR EACH ROW triggers, not FOR EACH STATEMENT triggers. Hence explicitly specifying FOR EACH ROW is optional. FOR EACH ROW implies that the SQL statements specified in the trigger may be executed (depending on the WHEN clause) for each database row being inserted, updated or deleted by the statement causing the trigger to fire.</p> <p>Both the WHEN clause and the trigger actions may access elements of the row being inserted, deleted or updated using references of the form "NEW.<i>column-name</i>" and "OLD.<i>column-name</i>", where <i>column-name</i> is the name of a column from the table that the trigger is associated with. OLD and NEW references may only be used in triggers on events for which they are relevant, as follows:</p> <table cellpadding="10"> <tr> <td valign="top" width="120"><i>INSERT</i></td> <td valign="top">NEW references are valid</td> </tr> <tr> <td valign="top" width="120"><i>UPDATE</i></td> <td valign="top">NEW and OLD references are valid</td> </tr> <tr> <td valign="top" width="120"><i>DELETE</i></td> <td valign="top">OLD references are valid</td> </tr> </table> <p>If a WHEN clause is supplied, the SQL statements specified are only executed if the WHEN clause is true. If no WHEN clause is supplied, the SQL statements are executed every time the trigger fires.</p> <p>The BEFORE or AFTER keyword determines when the trigger actions will be executed relative to the insertion, modification or removal of the associated row.</p> <p>An <a href="../lang_conflict/">ON CONFLICT</a> clause may be specified as part of an <a href="../lang_update/">UPDATE</a> or <a href="../lang_insert/">INSERT</a> action within the body of the trigger. However if an <a href="../lang_conflict/">ON CONFLICT</a> clause is specified as part of the statement causing the trigger to fire, then conflict handling policy of the outer statement is used instead.</p> <p>Triggers are automatically <a href="../lang_droptrigger/">dropped</a> when the table that they are associated with (the <i>table-name</i> table) is <a href="../lang_droptable/">dropped</a>. However if the trigger actions reference other tables, the trigger is not dropped or modified if those other tables are <a href="../lang_droptable/">dropped</a> or <a href="../lang_altertable/">modified</a>.</p> <p>Triggers are removed using the <a href="../lang_droptrigger/">DROP TRIGGER</a> statement.</p> <h3>Syntax Restrictions On UPDATE, DELETE, and INSERT Statements Within Triggers</h3> <p>The <a href="../lang_update/">UPDATE</a>, <a href="../lang_delete/">DELETE</a>, and <a href="../lang_insert/">INSERT</a> statements within triggers do not support the full syntax for <a href="../lang_update/">UPDATE</a>, <a href="../lang_delete/">DELETE</a>, and <a href="../lang_insert/">INSERT</a> statements. The following restrictions apply:</p> <ul> <li><p> The name of the table to be modified in an <a href="../lang_update/">UPDATE</a>, <a href="../lang_delete/">DELETE</a>, or <a href="../lang_insert/">INSERT</a> statement must be an unqualified table name. In other words, one must use just "<i>tablename</i>" not "<i>database</i><b>.</b><i>tablename</i>" when specifying the table. The table to be modified must exist in the same database as the table or view to which the trigger is attached. </p></li> <li><p> The "INSERT INTO <i>table</i> DEFAULT VALUES" form of the <a href="../lang_insert/">INSERT</a> statement is not supported. </p></li> <li><p> The INDEXED BY and NOT INDEXED clauses are not supported for <a href="../lang_update/">UPDATE</a> and <a href="../lang_delete/">DELETE</a> statements. </p></li> <li><p> The ORDER BY and LIMIT clauses on <a href="../lang_update/">UPDATE</a> and <a href="../lang_delete/">DELETE</a> statements are not supported. ORDER BY and LIMIT are not normally supported for <a href="../lang_update/">UPDATE</a> or <a href="../lang_delete/">DELETE</a> in any context but can be enabled for top-level statements using the <a href="../compile/#enable_update_delete_limit">SQLITE_ENABLE_UPDATE_DELETE_LIMIT</a> compile-time option. However, that compile-time option only applies to top-level <a href="../lang_update/">UPDATE</a> and <a href="../lang_delete/">DELETE</a> statements, not <a href="../lang_update/">UPDATE</a> and <a href="../lang_delete/">DELETE</a> statements within triggers. </p></li> <li><p> <a href="../syntax/common-table-expression/">Common table expression</a> are not supported for statements inside of triggers. </p></li> </ul>  <h3 id="instead_of_trigger">INSTEAD OF triggers</h3> <p>Triggers may be created on <a href="../lang_createview/">views</a>, as well as ordinary tables, by specifying INSTEAD OF in the CREATE TRIGGER statement. If one or more ON INSERT, ON DELETE or ON UPDATE triggers are defined on a view, then it is not an error to execute an INSERT, DELETE or UPDATE statement on the view, respectively. Instead, executing an INSERT, DELETE or UPDATE on the view causes the associated triggers to fire. The real tables underlying the view are not modified (except possibly explicitly, by a trigger program).</p> <p>Note that the <a href="../c3ref/changes/">sqlite3_changes()</a> and <a href="../c3ref/total_changes/">sqlite3_total_changes()</a> interfaces do not count INSTEAD OF trigger firings, but the <a href="../pragma/#pragma_count_changes">count_changes pragma</a> does count INSTEAD OF trigger firing.</p> <h3>Some Example Triggers</h3> <p>Assuming that customer records are stored in the "customers" table, and that order records are stored in the "orders" table, the following UPDATE trigger ensures that all associated orders are redirected when a customer changes his or her address:</p> <pre data-language="sql">
CREATE TRIGGER update_customer_address UPDATE OF address ON customers 
  BEGIN
    UPDATE orders SET address = new.address WHERE customer_name = old.name;
  END;
</pre> <p>With this trigger installed, executing the statement:</p> <pre data-language="sql">
UPDATE customers SET address = '1 Main St.' WHERE name = 'Jack Jones';
</pre> <p>causes the following to be automatically executed:</p> <pre data-language="sql">
UPDATE orders SET address = '1 Main St.' WHERE customer_name = 'Jack Jones';
</pre> <p>For an example of an INSTEAD OF trigger, consider the following schema: </p>
<pre data-language="sql">
CREATE TABLE customer(
  cust_id INTEGER PRIMARY KEY,
  cust_name TEXT,
  cust_addr TEXT
);
CREATE VIEW customer_address AS
   SELECT cust_id, cust_addr FROM customer;
CREATE TRIGGER cust_addr_chng
INSTEAD OF UPDATE OF cust_addr ON customer_address
BEGIN
  UPDATE customer SET cust_addr=NEW.cust_addr
   WHERE cust_id=NEW.cust_id;
END;
</pre> <p>With the schema above, a statement of the form:</p> <pre data-language="sql">
UPDATE customer_address SET cust_addr=$new_address WHERE cust_id=$cust_id;
</pre> <p>Causes the customer.cust_addr field to be updated for a specific customer entry that has customer.cust_id equal to the $cust_id parameter. Note how the values assigned to the view are made available as field in the special "NEW" table within the trigger body.</p>  <h3 id="undef_before">Cautions On The Use Of BEFORE triggers</h3> <p>If a BEFORE UPDATE or BEFORE DELETE trigger modifies or deletes a row that was to have been updated or deleted, then the result of the subsequent update or delete operation is undefined. Furthermore, if a BEFORE trigger modifies or deletes a row, then it is undefined whether or not AFTER triggers that would have otherwise run on those rows will in fact run. </p> <p>The value of NEW.rowid is undefined in a BEFORE INSERT trigger in which the rowid is not explicitly set to an integer.</p> <p>Because of the behaviors described above, programmers are encouraged to prefer AFTER triggers over BEFORE triggers.</p>  <h3 id="raise">The RAISE() function</h3> <p>A special SQL function RAISE() may be used within a trigger-program, with the following syntax</p> <p><b><a href="../syntax/raise-function/">raise-function:</a></b></p>
<div class="imgcontainer"> <img alt="syntax diagram raise-function" src="https://sqlite.org/images/syntax/raise-function.gif"> </div> <p>When one of RAISE(ROLLBACK,...), RAISE(ABORT,...) or RAISE(FAIL,...) is called during trigger-program execution, the specified <a href="../lang_conflict/">ON CONFLICT</a> processing is performed the current query terminates. An error code of <a href="../rescode/#constraint">SQLITE_CONSTRAINT</a> is returned to the application, along with the specified error message.</p> <p>When RAISE(IGNORE) is called, the remainder of the current trigger program, the statement that caused the trigger program to execute and any subsequent trigger programs that would have been executed are abandoned. No database changes are rolled back. If the statement that caused the trigger program to execute is itself part of a trigger program, then that trigger program resumes execution at the beginning of the next step. </p>  <h3 id="temptrig">TEMP Triggers on Non-TEMP Tables</h3> <p>A trigger normally exists in the same database as the table named after the "ON" keyword in the CREATE TRIGGER statement. Except, it is possible to create a TEMP TRIGGER on a table in another database. Such a trigger will only fire when changes are made to the target table by the application that defined the trigger. Other applications that modify the database will not be able to see the TEMP trigger and hence cannot run the trigger.</p> <p>When defining a TEMP trigger on a non-TEMP table, it is important to specify the database holding the non-TEMP table. For example, in the following statement, it is important to say "main.tab1" instead of just "tab1":</p> <pre data-language="sql">
CREATE TEMP TRIGGER ex1 AFTER INSERT ON main.tab1 BEGIN ...
</pre> <p>Failure to specify the schema name on the target table could result in the TEMP trigger being reattached to a table with the same name in another database whenever any schema change occurs.</p>
<div class="_attribution">
  <p class="_attribution-p">
    SQLite is in the Public Domain.<br>
    <a href="https://sqlite.org/lang_createtrigger.html" class="_attribution-link" target="_blank">https://sqlite.org/lang_createtrigger.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
