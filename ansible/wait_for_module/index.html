
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Wait_for - Ansible - W3cubDocs</title>
  
  <meta name="description" content="You can wait for a set amount of time timeout, this is the default if nothing is specified. Waiting for a port to become available is useful for &hellip;">
  <meta name="keywords" content="wait, for, -, waits, condition, before, continuing, ansible">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ansible/wait_for_module/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/ansible.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible/" class="_nav-link" title="" style="margin-left:0;">Ansible</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				
<h1 id="wait-for">wait_for - Waits for a condition before continuing.</h1>  <ul class="simple" id="wait-for-waits-for-a-condition-before-continuing"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#options" id="id2">Options</a></li> <li><a class="reference internal" href="#examples" id="id3">Examples</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#this-is-a-core-module" id="id5">This is a Core Module</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <p>You can wait for a set amount of time <code>timeout</code>, this is the default if nothing is specified. Waiting for a port to become available is useful for when services are not immediately available after their init scripts return which is true of certain Java application servers. It is also useful when starting guests with the <a class="reference internal" href="../virt_module/#virt"><span class="std std-ref">virt</span></a> module and needing to pause until they are ready. This module can also be used to wait for a regex match a string to be present in a file. In 1.6 and later, this module can also be used to wait for a file to be available or absent on the filesystem. In 1.8 and later, this module can also be used to wait for active connections to be closed before continuing, useful if a node is being rotated out of a load balancer pool.</p>   <h2 id="options">Options</h2> <table> <tr> <th class="head">parameter</th> <th class="head">required</th> <th class="head">default</th> <th class="head">choices</th> <th class="head">comments</th> </tr> <tr> <td>connect_timeout<br>
</td> <td>no</td> <td>5</td> <td></td> <td><div>maximum number of seconds to wait for a connection to happen before closing and retrying</div></td>
</tr> <tr> <td>delay<br>
</td> <td>no</td> <td></td> <td></td> <td><div>number of seconds to wait before starting to poll</div></td>
</tr> <tr> <td>exclude_hosts<br><div style="font-size: small;"> (added in 1.8)</div>
</td> <td>no</td> <td></td> <td></td> <td><div>list of hosts or IPs to ignore when looking for active TCP connections for <code>drained</code> state</div></td>
</tr> <tr> <td>host<br>
</td> <td>no</td> <td>127.0.0.1</td> <td></td> <td><div>A resolvable hostname or IP address to wait for</div></td>
</tr> <tr> <td>path<br><div style="font-size: small;"> (added in 1.4)</div>
</td> <td>no</td> <td></td> <td></td> <td><div>path to a file on the filesytem that must exist before continuing</div></td>
</tr> <tr> <td>port<br>
</td> <td>no</td> <td></td> <td></td> <td><div>port number to poll</div></td>
</tr> <tr> <td>search_regex<br><div style="font-size: small;"> (added in 1.4)</div>
</td> <td>no</td> <td></td> <td></td> <td><div>Can be used to match a string in either a file or a socket connection. Defaults to a multiline regex.</div></td>
</tr> <tr> <td>state<br>
</td> <td>no</td> <td>started</td> <td><ul>
<li>present</li>
<li>started</li>
<li>stopped</li>
<li>absent</li>
<li>drained</li>
</ul></td> <td>
<div>either <code>present</code>, <code>started</code>, or <code>stopped</code>, <code>absent</code>, or <code>drained</code>
</div>
<div>When checking a port <code>started</code> will ensure the port is open, <code>stopped</code> will check that it is closed, <code>drained</code> will check for active connections</div>
<div>When checking for a file or a search string <code>present</code> or <code>started</code> will ensure that the file or string is present before continuing, <code>absent</code> will check that file is absent or removed</div>
</td>
</tr> <tr> <td>timeout<br>
</td> <td>no</td> <td>300</td> <td></td> <td><div>maximum number of seconds to wait for</div></td>
</tr> </table>   <h2 id="examples">Examples</h2>  <pre data-language="yaml"># wait 300 seconds for port 8000 to become open on the host, don't start checking for 10 seconds
- wait_for: port=8000 delay=10

# wait 300 seconds for port 8000 of any IP to close active connections, don't start checking for 10 seconds
- wait_for: host=0.0.0.0 port=8000 delay=10 state=drained

# wait 300 seconds for port 8000 of any IP to close active connections, ignoring connections for specified hosts
- wait_for: host=0.0.0.0 port=8000 state=drained exclude_hosts=10.2.1.2,10.2.1.3

# wait until the file /tmp/foo is present before continuing
- wait_for: path=/tmp/foo

# wait until the string "completed" is in the file /tmp/foo before continuing
- wait_for: path=/tmp/foo search_regex=completed

# wait until the lock file is removed
- wait_for: path=/var/lock/file.lock state=absent

# wait until the process is finished and pid was destroyed
- wait_for: path=/proc/3466/status state=absent

# wait 300 seconds for port 22 to become open and contain "OpenSSH", don't assume the inventory_hostname is resolvable
# and don't start checking for 10 seconds
- local_action: wait_for port=22 host="{{ ansible_ssh_host | default(inventory_hostname) }}" search_regex=OpenSSH delay=10
</pre>    <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The ability to use search_regex with a port connection was added in 1.7.</p> </div>   <h2 id="this-is-a-core-module">This is a Core Module</h2> <p>For more information on what this means please read <a class="reference internal" href="../modules_core/"><span class="doc">Core Modules</span></a></p> <p>For help in developing on modules, should you be so inclined, please read <a class="reference internal" href="https://docs.ansible.com/ansible/community.html" target="_blank"><span class="doc">Community Information &amp; Contributing</span></a>, <span class="xref doc">developing_test_pr</span> and <a class="reference internal" href="../developing_modules/"><span class="doc">Developing Modules</span></a>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2016 Michael DeHaan<br>© 2016 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/wait_for_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/wait_for_module.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
