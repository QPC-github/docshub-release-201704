
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Microsoft Hyper-V (Machine) - Docker 1.13 - W3cubDocs</title>
  
  <meta name="description" content=" Creates a Boot2Docker virtual machine locally on your Windows machine using Hyper-V. ">
  <meta name="keywords" content="microsoft, hyper-v, machine, -, docker, docker~1.13">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/docker~1.13/machine/drivers/hyper-v/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/docker~1.13.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/docker~1.13/" class="_nav-link" title="" style="margin-left:0;">Docker 1.13</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _docker">
				
<h1>Microsoft Hyper-V</h1>  <p>Creates a Boot2Docker virtual machine locally on your Windows machine using Hyper-V.</p> <p>Hyper-V must be enabled on your desktop system. Docker for Windows automatically enables it upon install. See this article on the Microsoft developer network for <a href="https://msdn.microsoft.com/en-us/virtualization/hyperv_on_windows/quick_start/walkthrough_install" target="_blank">instructions on how to manually enable Hyper-V</a>.</p> <blockquote> <p><strong>Notes</strong>:</p> <ul> <li> <p>You will need to use an Administrator level account to create and manage Hyper-V machines.</p> </li> <li> <p>You will need an existing virtual switch to use the driver. Hyper-V can share an external network interface (aka bridging), see <a href="http://blogs.technet.com/b/canitpro/archive/2014/03/11/step-by-step-enabling-hyper-v-for-use-on-windows-8-1.aspx" target="_blank">this blog</a>. If you would like to use NAT, create an internal network, and use <a href="http://www.packet6.com/allowing-windows-8-1-hyper-v-vm-to-work-with-wifi/" target="_blank">Internet Connection Sharing</a>.</p> </li> <li> <p>This reference page includes an <a href="/#example">example</a> that shows how to use an elevated (Administrator-level) PowerShell and how to create and use an external network switch.</p> </li> </ul> </blockquote> <h2 id="usage">Usage</h2> <pre class="highlight" data-language="">$ docker-machine create --driver hyperv vm
</pre>  <h2 id="options">Options</h2> <ul> <li>
<code class="highlighter-rouge">--hyperv-boot2docker-url</code>: The URL of the boot2docker ISO.</li> <li>
<code class="highlighter-rouge">--hyperv-virtual-switch</code>: Name of the virtual switch to use.</li> <li>
<code class="highlighter-rouge">--hyperv-disk-size</code>: Size of disk for the host in MB.</li> <li>
<code class="highlighter-rouge">--hyperv-memory</code>: Size of memory for the host in MB.</li> <li>
<code class="highlighter-rouge">--hyperv-cpu-count</code>: Number of CPUs for the host.</li> <li>
<code class="highlighter-rouge">--hyperv-static-macaddress</code>: Hyper-V network adapter’s static MAC address.</li> <li>
<code class="highlighter-rouge">--hyperv-vlan-id</code>: Hyper-V network adapter’s VLAN ID if any.</li> </ul> <h2 id="environment-variables-and-default-values">Environment variables and default values</h2> <table> <thead> <tr> <th>CLI option</th> <th>Environment variable</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code class="highlighter-rouge">--hyperv-boot2docker-url</code></td> <td><code class="highlighter-rouge">HYPERV_BOOT2DOCKER_URL</code></td> <td><em>Latest boot2docker url</em></td> </tr> <tr> <td><code class="highlighter-rouge">--hyperv-virtual-switch</code></td> <td><code class="highlighter-rouge">HYPERV_VIRTUAL_SWITCH</code></td> <td><em>first found</em></td> </tr> <tr> <td><code class="highlighter-rouge">--hyperv-disk-size</code></td> <td><code class="highlighter-rouge">HYPERV_DISK_SIZE</code></td> <td><code class="highlighter-rouge">20000</code></td> </tr> <tr> <td><code class="highlighter-rouge">--hyperv-memory</code></td> <td><code class="highlighter-rouge">HYPERV_MEMORY</code></td> <td><code class="highlighter-rouge">1024</code></td> </tr> <tr> <td><code class="highlighter-rouge">--hyperv-cpu-count</code></td> <td><code class="highlighter-rouge">HYPERV_CPU_COUNT</code></td> <td><code class="highlighter-rouge">1</code></td> </tr> <tr> <td><code class="highlighter-rouge">--hyperv-static-macaddress</code></td> <td><code class="highlighter-rouge">HYPERV_STATIC_MACADDRESS</code></td> <td><em>undefined</em></td> </tr> <tr> <td><code class="highlighter-rouge">--hyperv-vlan-id</code></td> <td><code class="highlighter-rouge">HYPERV_VLAN_ID</code></td> <td><em>undefined</em></td> </tr> </tbody> </table> <h2 id="example">Example</h2> <h4 id="make-sure-hyper-v-is-enabled">1. Make sure Hyper-V is enabled</h4> <p>Hyper-V is automatically enabled on a Docker for Windows install. To enable it manually, see <a href="https://msdn.microsoft.com/en-us/virtualization/hyperv_on_windows/quick_start/walkthrough_install" target="_blank">instructions on how to manually enable Hyper-V</a> on the Microsoft developer network.</p> <h4 id="set-up-a-new-external-network-switch">2. Set up a new external network switch</h4> <p>Make sure you have Ethernet connectivity while you are doing this.</p> <p>Open the <strong>Hyper-V Manager</strong>. (On Windows 10, just search for the Hyper-V Manager in the search field in the lower left search field.)</p> <p>Select the Virtual Switch Manager on the left-side <strong>Actions</strong> panel.</p> <p><img src="https://docs.docker.com/machine/img/hyperv-manager.png" alt="Hyper-V manager"></p> <p>Set up a new external network switch to use instad of DockerNAT network switch (for Moby), which is set up by default when you install Docker for Windows. (Or if you already have another network switch set up, you can use that one.)</p> <p>For this example, we created a virtual switch called <code class="highlighter-rouge">Primary Virtual Switch</code>.</p> <p><img src="https://docs.docker.com/machine/img/hyperv-network-switch.png" alt="Defining a new virtual switch"></p> <h4 id="reboot">3. Reboot</h4> <p>See <a href="https://github.com/docker/machine/issues/986" target="_blank">this issue on virtualbox: Hangs on Waiting for VM to start #986</a>.</p> <p>A reboot of your desktop system clears out any problems with the routing tables. Without a reboot first, <code class="highlighter-rouge">docker-machine create ...</code> might get hung up on <code class="highlighter-rouge">Waiting for VM to start</code>.</p> <h4 id="create-the-nodes-with-docker-machine-and-the-microsoft-hyper-v-driver">4. Create the nodes with Docker Machine and the Microsoft Hyper-V driver</h4> <ul> <li> <p>Start an “elevated” PowerShell (i.e., running as administrator). To do this, search for PowerShell, right-click, and choose Run as administrator.</p> </li> <li> <p>Run the <code class="highlighter-rouge">docker-machine create</code> commands to create machines.</p> <p>For example, if you follow along with the <a href="../../../engine/swarm/swarm-tutorial/">Swarm mode tutorial</a> which asks you to create <a href="../../../engine/swarm/swarm-tutorial/#three-networked-host-machines">three networked host machines</a>, you can create these swarm nodes: <code class="highlighter-rouge">manager1</code>, <code class="highlighter-rouge">worker1</code>, <code class="highlighter-rouge">worker2</code>.</p> </li> <li> <p>Use the Microsoft Hyper-V driver and reference the new virtual switch you created.</p> <pre class="highlight" data-language="">  docker-machine create -d hyperv --hyperv-virtual-switch "&lt;NameOfVirtualSwitch&gt;" &lt;nameOfNode&gt;
</pre>  <p>Here is an example of creating <code class="highlighter-rouge">manager1</code> node:</p> <pre class="highlight" data-language="">```shell
PS C:\WINDOWS\system32&gt;  docker-machine create -d hyperv --hyperv-virtual-switch "Primary Virtual Switch" manager1
Running pre-create checks...
Creating machine...
(manager1) Copying C:\Users\Vicky\.docker\machine\cache\boot2docker.iso to C:\Users\Vicky\.docker\machine\machines\manag
er1\boot2docker.iso...
(manager1) Creating SSH key...
(manager1) Creating VM...
(manager1) Using switch "Primary Virtual Switch"
(manager1) Creating VHD
(manager1) Starting VM...
(manager1) Waiting for host to start...
Waiting for machine to be running, this may take a few minutes...
Detecting operating system of created instance...
Waiting for SSH to be available...
Detecting the provisioner...
Provisioning with boot2docker...
Copying certs to the local machine directory...
Copying certs to the remote machine...
Setting Docker configuration on the remote daemon...
Checking connection to Docker...
Docker is up and running!
To see how to connect your Docker Client to the Docker Engine running on this virtual machine, run: C:\Program Files\Doc
ker\Docker\Resources\bin\docker-machine.exe env manager1
PS C:\WINDOWS\system32&gt;
```
</pre>  </li> <li> <p>Use the same process, driver and network switch to create the other nodes.</p> <p>For our example, the commands will look like this:</p> <pre class="highlight" data-language="shell">docker-machine create -d hyperv --hyperv-virtual-switch "Primary Virtual Switch" worker1
docker-machine create -d hyperv --hyperv-virtual-switch "Primary Virtual Switch" worker2
</pre>  </li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    © 2013–2016 Docker, Inc.<br>Licensed under the Apache License, Version 2.0.<br>Docker and the Docker logo are trademarks or registered trademarks of Docker, Inc. in the United States and/or other countries.<br>Docker, Inc. and other parties may also have trademark rights in other terms used herein.<br>
    <a href="https://docs.docker.com/machine/drivers/hyper-v/" class="_attribution-link" target="_blank">https://docs.docker.com/machine/drivers/hyper-v/</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
