
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Docker Image Build - Docker 1.13 - W3cubDocs</title>
  
  <meta name="description" content=" Build an image from a Dockerfile ">
  <meta name="keywords" content="docker, image, build, -, docker~1.13">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/docker~1.13/engine/reference/commandline/image_build/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/docker~1.13.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/docker~1.13/" class="_nav-link" title="" style="margin-left:0;">Docker 1.13</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _docker">
				
<h1>docker image build</h1>    <h2 id="description">Description</h2> <p>Build an image from a Dockerfile</p> <h2 id="usage">Usage</h2> <pre class="highlight" data-language="shell">docker image build [OPTIONS] PATH | URL | -
</pre>  <h2 id="options">Options</h2> <table> <thead> <tr> <th>Name, shorthand</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="highlighter-rouge">--build-arg</code></td> <td> </td> <td>Set build-time variables</td> </tr> <tr> <td><code class="highlighter-rouge">--cache-from</code></td> <td> </td> <td>Images to consider as cache sources</td> </tr> <tr> <td><code class="highlighter-rouge">--cgroup-parent</code></td> <td> </td> <td>Optional parent cgroup for the container</td> </tr> <tr> <td><code class="highlighter-rouge">--compress</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Compress the build context using gzip</td> </tr> <tr> <td><code class="highlighter-rouge">--cpu-period</code></td> <td><code class="highlighter-rouge">0</code></td> <td>Limit the CPU CFS (Completely Fair Scheduler) period</td> </tr> <tr> <td><code class="highlighter-rouge">--cpu-quota</code></td> <td><code class="highlighter-rouge">0</code></td> <td>Limit the CPU CFS (Completely Fair Scheduler) quota</td> </tr> <tr> <td><code class="highlighter-rouge">--cpu-shares, -c</code></td> <td><code class="highlighter-rouge">0</code></td> <td>CPU shares (relative weight)</td> </tr> <tr> <td><code class="highlighter-rouge">--cpuset-cpus</code></td> <td> </td> <td>CPUs in which to allow execution (0-3, 0,1)</td> </tr> <tr> <td><code class="highlighter-rouge">--cpuset-mems</code></td> <td> </td> <td>MEMs in which to allow execution (0-3, 0,1)</td> </tr> <tr> <td><code class="highlighter-rouge">--disable-content-trust</code></td> <td><code class="highlighter-rouge">true</code></td> <td>Skip image verification</td> </tr> <tr> <td><code class="highlighter-rouge">--file, -f</code></td> <td> </td> <td>Name of the Dockerfile (Default is ‘PATH/Dockerfile’)</td> </tr> <tr> <td><code class="highlighter-rouge">--force-rm</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Always remove intermediate containers</td> </tr> <tr> <td><code class="highlighter-rouge">--isolation</code></td> <td> </td> <td>Container isolation technology</td> </tr> <tr> <td><code class="highlighter-rouge">--label</code></td> <td> </td> <td>Set metadata for an image</td> </tr> <tr> <td><code class="highlighter-rouge">--memory, -m</code></td> <td> </td> <td>Memory limit</td> </tr> <tr> <td><code class="highlighter-rouge">--memory-swap</code></td> <td> </td> <td>Swap limit equal to memory plus swap: ‘-1’ to enable unlimited swap</td> </tr> <tr> <td><code class="highlighter-rouge">--network</code></td> <td><code class="highlighter-rouge">default</code></td> <td>Set the networking mode for the RUN instructions during build</td> </tr> <tr> <td><code class="highlighter-rouge">--no-cache</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Do not use cache when building the image</td> </tr> <tr> <td><code class="highlighter-rouge">--pull</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Always attempt to pull a newer version of the image</td> </tr> <tr> <td><code class="highlighter-rouge">--quiet, -q</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Suppress the build output and print image ID on success</td> </tr> <tr> <td><code class="highlighter-rouge">--rm</code></td> <td><code class="highlighter-rouge">true</code></td> <td>Remove intermediate containers after a successful build</td> </tr> <tr> <td><code class="highlighter-rouge">--security-opt</code></td> <td> </td> <td>Security options</td> </tr> <tr> <td><code class="highlighter-rouge">--shm-size</code></td> <td> </td> <td>Size of /dev/shm, default value is 64MB</td> </tr> <tr> <td><code class="highlighter-rouge">--squash</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Squash newly built layers into a single new layer</td> </tr> <tr> <td><code class="highlighter-rouge">--tag, -t</code></td> <td> </td> <td>Name and optionally a tag in the ‘name:tag’ format</td> </tr> <tr> <td><code class="highlighter-rouge">--ulimit</code></td> <td> </td> <td>Ulimit options</td> </tr> </tbody> </table> <h2 id="parent-command">Parent command</h2> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><a href="../image/">docker image</a></td> <td>Manage images</td> </tr> </tbody> </table> <h2 id="examples">Examples</h2> <h3 id="build-with-path">Build with PATH</h3> <pre class="highlight" data-language="bash">$ docker build .

Uploading context 10240 bytes
Step 1/3 : FROM busybox
Pulling repository busybox
 ---&gt; e9aa60c60128MB/2.284 MB (100%) endpoint: https://cdn-registry-1.docker.io/v1/
Step 2/3 : RUN ls -lh /
 ---&gt; Running in 9c9e81692ae9
total 24
drwxr-xr-x    2 root     root        4.0K Mar 12  2013 bin
drwxr-xr-x    5 root     root        4.0K Oct 19 00:19 dev
drwxr-xr-x    2 root     root        4.0K Oct 19 00:19 etc
drwxr-xr-x    2 root     root        4.0K Nov 15 23:34 lib
lrwxrwxrwx    1 root     root           3 Mar 12  2013 lib64 -&gt; lib
dr-xr-xr-x  116 root     root           0 Nov 15 23:34 proc
lrwxrwxrwx    1 root     root           3 Mar 12  2013 sbin -&gt; bin
dr-xr-xr-x   13 root     root           0 Nov 15 23:34 sys
drwxr-xr-x    2 root     root        4.0K Mar 12  2013 tmp
drwxr-xr-x    2 root     root        4.0K Nov 15 23:34 usr
 ---&gt; b35f4035db3f
Step 3/3 : CMD echo Hello world
 ---&gt; Running in 02071fceb21b
 ---&gt; f52f38b7823e
Successfully built f52f38b7823e
Removing intermediate container 9c9e81692ae9
Removing intermediate container 02071fceb21b
</pre>  <p>This example specifies that the <code class="highlighter-rouge">PATH</code> is <code class="highlighter-rouge">.</code>, and so all the files in the local directory get <code class="highlighter-rouge">tar</code>d and sent to the Docker daemon. The <code class="highlighter-rouge">PATH</code> specifies where to find the files for the “context” of the build on the Docker daemon. Remember that the daemon could be running on a remote machine and that no parsing of the Dockerfile happens at the client side (where you’re running <code class="highlighter-rouge">docker build</code>). That means that <em>all</em> the files at <code class="highlighter-rouge">PATH</code> get sent, not just the ones listed to <a href="../../builder/#add"><em>ADD</em></a> in the Dockerfile.</p> <p>The transfer of context from the local machine to the Docker daemon is what the <code class="highlighter-rouge">docker</code> client means when you see the “Sending build context” message.</p> <p>If you wish to keep the intermediate containers after the build is complete, you must use <code class="highlighter-rouge">--rm=false</code>. This does not affect the build cache.</p> <h3 id="build-with-url">Build with URL</h3> <pre class="highlight" data-language="bash">$ docker build github.com/creack/docker-firefox
</pre>  <p>This will clone the GitHub repository and use the cloned repository as context. The Dockerfile at the root of the repository is used as Dockerfile. You can specify an arbitrary Git repository by using the <code class="highlighter-rouge">git://</code> or <code class="highlighter-rouge">git@</code> scheme.</p> <pre class="highlight" data-language="bash">$ docker build -f ctx/Dockerfile http://server/ctx.tar.gz

Downloading context: http://server/ctx.tar.gz [===================&gt;]    240 B/240 B
Step 1/3 : FROM busybox
 ---&gt; 8c2e06607696
Step 2/3 : ADD ctx/container.cfg /
 ---&gt; e7829950cee3
Removing intermediate container b35224abf821
Step 3/3 : CMD /bin/ls
 ---&gt; Running in fbc63d321d73
 ---&gt; 3286931702ad
Removing intermediate container fbc63d321d73
Successfully built 377c409b35e4
</pre>  <p>This sends the URL <code class="highlighter-rouge">http://server/ctx.tar.gz</code> to the Docker daemon, which downloads and extracts the referenced tarball. The <code class="highlighter-rouge">-f ctx/Dockerfile</code> parameter specifies a path inside <code class="highlighter-rouge">ctx.tar.gz</code> to the <code class="highlighter-rouge">Dockerfile</code> that is used to build the image. Any <code class="highlighter-rouge">ADD</code> commands in that <code class="highlighter-rouge">Dockerfile</code> that refers to local paths must be relative to the root of the contents inside <code class="highlighter-rouge">ctx.tar.gz</code>. In the example above, the tarball contains a directory <code class="highlighter-rouge">ctx/</code>, so the <code class="highlighter-rouge">ADD ctx/container.cfg /</code> operation works as expected.</p> <h3 id="build-with--">Build with -</h3> <pre class="highlight" data-language="bash">$ docker build - &lt; Dockerfile
</pre>  <p>This will read a Dockerfile from <code class="highlighter-rouge">STDIN</code> without context. Due to the lack of a context, no contents of any local directory will be sent to the Docker daemon. Since there is no context, a Dockerfile <code class="highlighter-rouge">ADD</code> only works if it refers to a remote URL.</p> <pre class="highlight" data-language="bash">$ docker build - &lt; context.tar.gz
</pre>  <p>This will build an image for a compressed context read from <code class="highlighter-rouge">STDIN</code>. Supported formats are: bzip2, gzip and xz.</p> <h3 id="usage-of-dockerignore">Usage of .dockerignore</h3> <pre class="highlight" data-language="bash">$ docker build .

Uploading context 18.829 MB
Uploading context
Step 1/2 : FROM busybox
 ---&gt; 769b9341d937
Step 2/2 : CMD echo Hello world
 ---&gt; Using cache
 ---&gt; 99cc1ad10469
Successfully built 99cc1ad10469
$ echo ".git" &gt; .dockerignore
$ docker build .
Uploading context  6.76 MB
Uploading context
Step 1/2 : FROM busybox
 ---&gt; 769b9341d937
Step 2/2 : CMD echo Hello world
 ---&gt; Using cache
 ---&gt; 99cc1ad10469
Successfully built 99cc1ad10469
</pre>  <p>This example shows the use of the <code class="highlighter-rouge">.dockerignore</code> file to exclude the <code class="highlighter-rouge">.git</code> directory from the context. Its effect can be seen in the changed size of the uploaded context. The builder reference contains detailed information on <a href="../../builder/#dockerignore-file">creating a .dockerignore file</a></p> <h3 id="tag-image--t">Tag image (-t)</h3> <pre class="highlight" data-language="bash">$ docker build -t vieux/apache:2.0 .
</pre>  <p>This will build like the previous example, but it will then tag the resulting image. The repository name will be <code class="highlighter-rouge">vieux/apache</code> and the tag will be <code class="highlighter-rouge">2.0</code>. <a href="../tag/">Read more about valid tags</a>.</p> <p>You can apply multiple tags to an image. For example, you can apply the <code class="highlighter-rouge">latest</code> tag to a newly built image and add another tag that references a specific version. For example, to tag an image both as <code class="highlighter-rouge">whenry/fedora-jboss:latest</code> and <code class="highlighter-rouge">whenry/fedora-jboss:v2.1</code>, use the following:</p> <pre class="highlight" data-language="bash">$ docker build -t whenry/fedora-jboss:latest -t whenry/fedora-jboss:v2.1 .
</pre>  <p>### Specify Dockerfile (-f)</p> <pre class="highlight" data-language="bash">$ docker build -f Dockerfile.debug .
</pre>  <p>This will use a file called <code class="highlighter-rouge">Dockerfile.debug</code> for the build instructions instead of <code class="highlighter-rouge">Dockerfile</code>.</p> <pre class="highlight" data-language="bash">$ docker build -f dockerfiles/Dockerfile.debug -t myapp_debug .
$ docker build -f dockerfiles/Dockerfile.prod  -t myapp_prod .
</pre>  <p>The above commands will build the current build context (as specified by the <code class="highlighter-rouge">.</code>) twice, once using a debug version of a <code class="highlighter-rouge">Dockerfile</code> and once using a production version.</p> <pre class="highlight" data-language="bash">$ cd /home/me/myapp/some/dir/really/deep
$ docker build -f /home/me/myapp/dockerfiles/debug /home/me/myapp
$ docker build -f ../../../../dockerfiles/debug /home/me/myapp
</pre>  <p>These two <code class="highlighter-rouge">docker build</code> commands do the exact same thing. They both use the contents of the <code class="highlighter-rouge">debug</code> file instead of looking for a <code class="highlighter-rouge">Dockerfile</code> and will use <code class="highlighter-rouge">/home/me/myapp</code> as the root of the build context. Note that <code class="highlighter-rouge">debug</code> is in the directory structure of the build context, regardless of how you refer to it on the command line.</p> <blockquote> <p><strong>Note:</strong> <code class="highlighter-rouge">docker build</code> will return a <code class="highlighter-rouge">no such file or directory</code> error if the file or directory does not exist in the uploaded context. This may happen if there is no context, or if you specify a file that is elsewhere on the Host system. The context is limited to the current directory (and its children) for security reasons, and to ensure repeatable builds on remote Docker hosts. This is also the reason why <code class="highlighter-rouge">ADD ../file</code> will not work.</p> </blockquote> <h3 id="optional-parent-cgroup---cgroup-parent">Optional parent cgroup (–cgroup-parent)</h3> <p>When <code class="highlighter-rouge">docker build</code> is run with the <code class="highlighter-rouge">--cgroup-parent</code> option the containers used in the build will be run with the <a href="../../run/#specifying-custom-cgroups">corresponding <code class="highlighter-rouge">docker run</code> flag</a>.</p> <h3 id="set-ulimits-in-container---ulimit">Set ulimits in container (–ulimit)</h3> <p>Using the <code class="highlighter-rouge">--ulimit</code> option with <code class="highlighter-rouge">docker build</code> will cause each build step’s container to be started using those <a href="../run/#set-ulimits-in-container-ulimit"><code class="highlighter-rouge">--ulimit</code> flag values</a>.</p> <h3 id="set-build-time-variables---build-arg">Set build-time variables (–build-arg)</h3> <p>You can use <code class="highlighter-rouge">ENV</code> instructions in a Dockerfile to define variable values. These values persist in the built image. However, often persistence is not what you want. Users want to specify variables differently depending on which host they build an image on.</p> <p>A good example is <code class="highlighter-rouge">http_proxy</code> or source versions for pulling intermediate files. The <code class="highlighter-rouge">ARG</code> instruction lets Dockerfile authors define values that users can set at build-time using the <code class="highlighter-rouge">--build-arg</code> flag:</p> <pre class="highlight" data-language="bash">$ docker build --build-arg HTTP_PROXY=http://10.20.30.2:1234 .
</pre>  <p>This flag allows you to pass the build-time variables that are accessed like regular environment variables in the <code class="highlighter-rouge">RUN</code> instruction of the Dockerfile. Also, these values don’t persist in the intermediate or final images like <code class="highlighter-rouge">ENV</code> values do.</p> <p>Using this flag will not alter the output you see when the <code class="highlighter-rouge">ARG</code> lines from the Dockerfile are echoed during the build process.</p> <p>For detailed information on using <code class="highlighter-rouge">ARG</code> and <code class="highlighter-rouge">ENV</code> instructions, see the <a href="../../builder/">Dockerfile reference</a>.</p> <h3 id="optional-security-options---security-opt">Optional security options (–security-opt)</h3> <p>This flag is only supported on a daemon running on Windows, and only supports the <code class="highlighter-rouge">credentialspec</code> option. The <code class="highlighter-rouge">credentialspec</code> must be in the format <code class="highlighter-rouge">file://spec.txt</code> or <code class="highlighter-rouge">registry://keyname</code>.</p> <h3 id="specify-isolation-technology-for-container---isolation">Specify isolation technology for container (–isolation)</h3> <p>This option is useful in situations where you are running Docker containers on Windows. The <code class="highlighter-rouge">--isolation=&lt;value&gt;</code> option sets a container’s isolation technology. On Linux, the only supported is the <code class="highlighter-rouge">default</code> option which uses Linux namespaces. On Microsoft Windows, you can specify these values:</p> <table> <thead> <tr> <th>Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="highlighter-rouge">default</code></td> <td>Use the value specified by the Docker daemon’s <code class="highlighter-rouge">--exec-opt</code> . If the <code class="highlighter-rouge">daemon</code> does not specify an isolation technology, Microsoft Windows uses <code class="highlighter-rouge">process</code> as its default value.</td> </tr> <tr> <td><code class="highlighter-rouge">process</code></td> <td>Namespace isolation only.</td> </tr> <tr> <td><code class="highlighter-rouge">hyperv</code></td> <td>Hyper-V hypervisor partition-based isolation.</td> </tr> </tbody> </table> <p>Specifying the <code class="highlighter-rouge">--isolation</code> flag without a value is the same as setting <code class="highlighter-rouge">--isolation="default"</code>.</p> <h3 id="squash-an-images-layers---squash-experimental-only">Squash an image’s layers (–squash) <strong>Experimental Only</strong>
</h3> <p>Once the image is built, squash the new layers into a new image with a single new layer. Squashing does not destroy any existing image, rather it creates a new image with the content of the squashed layers. This effectively makes it look like all <code class="highlighter-rouge">Dockerfile</code> commands were created with a single layer. The build cache is preserved with this method.</p> <p><strong>Note</strong>: using this option means the new image will not be able to take advantage of layer sharing with other images and may use significantly more space.</p> <p><strong>Note</strong>: using this option you may see significantly more space used due to storing two copies of the image, one for the build cache with all the cache layers in tact, and one for the squashed version.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2013–2016 Docker, Inc.<br>Licensed under the Apache License, Version 2.0.<br>Docker and the Docker logo are trademarks or registered trademarks of Docker, Inc. in the United States and/or other countries.<br>Docker, Inc. and other parties may also have trademark rights in other terms used herein.<br>
    <a href="https://docs.docker.com/engine/reference/commandline/image_build/" class="_attribution-link" target="_blank">https://docs.docker.com/engine/reference/commandline/image_build/</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
