
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Docker Service Update - Docker 1.13 - W3cubDocs</title>
  
  <meta name="description" content=" Update a service ">
  <meta name="keywords" content="docker, service, update, -, docker~1.13">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/docker~1.13/engine/reference/commandline/service_update/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/docker~1.13.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/docker~1.13/" class="_nav-link" title="" style="margin-left:0;">Docker 1.13</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _docker">
				
<h1>docker service update</h1>    <h2 id="description">Description</h2> <p>Update a service</p> <h2 id="usage">Usage</h2> <pre class="highlight" data-language="shell">docker service update [OPTIONS] SERVICE
</pre>  <h2 id="options">Options</h2> <table> <thead> <tr> <th>Name, shorthand</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="highlighter-rouge">--args</code></td> <td> </td> <td>Service command args</td> </tr> <tr> <td><code class="highlighter-rouge">--constraint-add</code></td> <td> </td> <td>Add or update a placement constraint</td> </tr> <tr> <td><code class="highlighter-rouge">--constraint-rm</code></td> <td> </td> <td>Remove a constraint</td> </tr> <tr> <td><code class="highlighter-rouge">--container-label-add</code></td> <td> </td> <td>Add or update a container label</td> </tr> <tr> <td><code class="highlighter-rouge">--container-label-rm</code></td> <td> </td> <td>Remove a container label by its key</td> </tr> <tr> <td><code class="highlighter-rouge">--dns-add</code></td> <td> </td> <td>Add or update a custom DNS server</td> </tr> <tr> <td><code class="highlighter-rouge">--dns-option-add</code></td> <td> </td> <td>Add or update a DNS option</td> </tr> <tr> <td><code class="highlighter-rouge">--dns-option-rm</code></td> <td> </td> <td>Remove a DNS option</td> </tr> <tr> <td><code class="highlighter-rouge">--dns-rm</code></td> <td> </td> <td>Remove a custom DNS server</td> </tr> <tr> <td><code class="highlighter-rouge">--dns-search-add</code></td> <td> </td> <td>Add or update a custom DNS search domain</td> </tr> <tr> <td><code class="highlighter-rouge">--dns-search-rm</code></td> <td> </td> <td>Remove a DNS search domain</td> </tr> <tr> <td><code class="highlighter-rouge">--endpoint-mode</code></td> <td> </td> <td>Endpoint mode (vip or dnsrr)</td> </tr> <tr> <td><code class="highlighter-rouge">--env-add</code></td> <td> </td> <td>Add or update an environment variable</td> </tr> <tr> <td><code class="highlighter-rouge">--env-rm</code></td> <td> </td> <td>Remove an environment variable</td> </tr> <tr> <td><code class="highlighter-rouge">--force</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Force update even if no changes require it</td> </tr> <tr> <td><code class="highlighter-rouge">--group-add</code></td> <td> </td> <td>Add an additional supplementary user group to the container</td> </tr> <tr> <td><code class="highlighter-rouge">--group-rm</code></td> <td> </td> <td>Remove a previously added supplementary user group from the container</td> </tr> <tr> <td><code class="highlighter-rouge">--health-cmd</code></td> <td> </td> <td>Command to run to check health</td> </tr> <tr> <td><code class="highlighter-rouge">--health-interval</code></td> <td><code class="highlighter-rouge">none</code></td> <td>Time between running the check (ns|us|ms|s|m|h)</td> </tr> <tr> <td><code class="highlighter-rouge">--health-retries</code></td> <td><code class="highlighter-rouge">0</code></td> <td>Consecutive failures needed to report unhealthy</td> </tr> <tr> <td><code class="highlighter-rouge">--health-timeout</code></td> <td><code class="highlighter-rouge">none</code></td> <td>Maximum time to allow one check to run (ns|us|ms|s|m|h)</td> </tr> <tr> <td><code class="highlighter-rouge">--host-add</code></td> <td> </td> <td>Add or update a custom host-to-IP mapping (host:ip)</td> </tr> <tr> <td><code class="highlighter-rouge">--host-rm</code></td> <td> </td> <td>Remove a custom host-to-IP mapping (host:ip)</td> </tr> <tr> <td><code class="highlighter-rouge">--hostname</code></td> <td> </td> <td>Container hostname</td> </tr> <tr> <td><code class="highlighter-rouge">--image</code></td> <td> </td> <td>Service image tag</td> </tr> <tr> <td><code class="highlighter-rouge">--label-add</code></td> <td> </td> <td>Add or update a service label</td> </tr> <tr> <td><code class="highlighter-rouge">--label-rm</code></td> <td> </td> <td>Remove a label by its key</td> </tr> <tr> <td><code class="highlighter-rouge">--limit-cpu</code></td> <td><code class="highlighter-rouge">0.000</code></td> <td>Limit CPUs</td> </tr> <tr> <td><code class="highlighter-rouge">--limit-memory</code></td> <td><code class="highlighter-rouge">0 B</code></td> <td>Limit Memory</td> </tr> <tr> <td><code class="highlighter-rouge">--log-driver</code></td> <td> </td> <td>Logging driver for service</td> </tr> <tr> <td><code class="highlighter-rouge">--log-opt</code></td> <td> </td> <td>Logging driver options</td> </tr> <tr> <td><code class="highlighter-rouge">--mount-add</code></td> <td> </td> <td>Add or update a mount on a service</td> </tr> <tr> <td><code class="highlighter-rouge">--mount-rm</code></td> <td> </td> <td>Remove a mount by its target path</td> </tr> <tr> <td><code class="highlighter-rouge">--no-healthcheck</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Disable any container-specified HEALTHCHECK</td> </tr> <tr> <td><code class="highlighter-rouge">--publish-add</code></td> <td> </td> <td>Add or update a published port</td> </tr> <tr> <td><code class="highlighter-rouge">--publish-rm</code></td> <td> </td> <td>Remove a published port by its target port</td> </tr> <tr> <td><code class="highlighter-rouge">--replicas</code></td> <td><code class="highlighter-rouge">none</code></td> <td>Number of tasks</td> </tr> <tr> <td><code class="highlighter-rouge">--reserve-cpu</code></td> <td><code class="highlighter-rouge">0.000</code></td> <td>Reserve CPUs</td> </tr> <tr> <td><code class="highlighter-rouge">--reserve-memory</code></td> <td><code class="highlighter-rouge">0 B</code></td> <td>Reserve Memory</td> </tr> <tr> <td><code class="highlighter-rouge">--restart-condition</code></td> <td> </td> <td>Restart when condition is met (none, on-failure, or any)</td> </tr> <tr> <td><code class="highlighter-rouge">--restart-delay</code></td> <td><code class="highlighter-rouge">none</code></td> <td>Delay between restart attempts (ns|us|ms|s|m|h)</td> </tr> <tr> <td><code class="highlighter-rouge">--restart-max-attempts</code></td> <td><code class="highlighter-rouge">none</code></td> <td>Maximum number of restarts before giving up</td> </tr> <tr> <td><code class="highlighter-rouge">--restart-window</code></td> <td><code class="highlighter-rouge">none</code></td> <td>Window used to evaluate the restart policy (ns|us|ms|s|m|h)</td> </tr> <tr> <td><code class="highlighter-rouge">--rollback</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Rollback to previous specification</td> </tr> <tr> <td><code class="highlighter-rouge">--secret-add</code></td> <td> </td> <td>Add or update a secret on a service</td> </tr> <tr> <td><code class="highlighter-rouge">--secret-rm</code></td> <td> </td> <td>Remove a secret</td> </tr> <tr> <td><code class="highlighter-rouge">--stop-grace-period</code></td> <td><code class="highlighter-rouge">none</code></td> <td>Time to wait before force killing a container (ns|us|ms|s|m|h)</td> </tr> <tr> <td><code class="highlighter-rouge">--tty, -t</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Allocate a pseudo-TTY</td> </tr> <tr> <td><code class="highlighter-rouge">--update-delay</code></td> <td><code class="highlighter-rouge">0</code></td> <td>Delay between updates (ns|us|ms|s|m|h) (default 0s)</td> </tr> <tr> <td><code class="highlighter-rouge">--update-failure-action</code></td> <td><code class="highlighter-rouge">pause</code></td> <td>Action on update failure (pause|continue)</td> </tr> <tr> <td><code class="highlighter-rouge">--update-max-failure-ratio</code></td> <td><code class="highlighter-rouge">0</code></td> <td>Failure rate to tolerate during an update</td> </tr> <tr> <td><code class="highlighter-rouge">--update-monitor</code></td> <td><code class="highlighter-rouge">0</code></td> <td>Duration after each task update to monitor for failure (ns|us|ms|s|m|h) (default 0s)</td> </tr> <tr> <td><code class="highlighter-rouge">--update-parallelism</code></td> <td><code class="highlighter-rouge">1</code></td> <td>Maximum number of tasks updated simultaneously (0 to update all at once)</td> </tr> <tr> <td><code class="highlighter-rouge">--user, -u</code></td> <td> </td> <td>Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])</td> </tr> <tr> <td><code class="highlighter-rouge">--with-registry-auth</code></td> <td><code class="highlighter-rouge">false</code></td> <td>Send registry authentication details to swarm agents</td> </tr> <tr> <td><code class="highlighter-rouge">--workdir, -w</code></td> <td> </td> <td>Working directory inside the container</td> </tr> </tbody> </table> <h2 id="parent-command">Parent command</h2> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><a href="../service/">docker service</a></td> <td>Manage services</td> </tr> </tbody> </table> <h2 id="examples">Examples</h2> <h3 id="update-a-service">Update a service</h3> <pre class="highlight" data-language="bash">$ docker service update --limit-cpu 2 redis
</pre>  <h3 id="perform-a-rolling-restart-with-no-parameter-changes">Perform a rolling restart with no parameter changes</h3> <pre class="highlight" data-language="bash">$ docker service update --force --update-parallelism 1 --update-delay 30s redis
</pre>  <p>In this example, the <code class="highlighter-rouge">--force</code> flag causes the service’s tasks to be shut down and replaced with new ones even though none of the other parameters would normally cause that to happen. The <code class="highlighter-rouge">--update-parallelism 1</code> setting ensures that only one task is replaced at a time (this is the default behavior). The <code class="highlighter-rouge">--update-delay 30s</code> setting introduces a 30 second delay between tasks, so that the rolling restart happens gradually.</p> <h3 id="adding-and-removing-mounts">Adding and removing mounts</h3> <p>Use the <code class="highlighter-rouge">--mount-add</code> or <code class="highlighter-rouge">--mount-rm</code> options add or remove a service’s bind-mounts or volumes.</p> <p>The following example creates a service which mounts the <code class="highlighter-rouge">test-data</code> volume to <code class="highlighter-rouge">/somewhere</code>. The next step updates the service to also mount the <code class="highlighter-rouge">other-volume</code> volume to <code class="highlighter-rouge">/somewhere-else</code>volume, The last step unmounts the <code class="highlighter-rouge">/somewhere</code> mount point, effectively removing the <code class="highlighter-rouge">test-data</code> volume. Each command returns the service name.</p> <ul> <li> <p>The <code class="highlighter-rouge">--mount-add</code> flag takes the same parameters as the <code class="highlighter-rouge">--mount</code> flag on <code class="highlighter-rouge">service create</code>. Refer to the <a href="../service_create/#volumes-and-bind-mounts-mount">volumes and bind-mounts</a> section in the <code class="highlighter-rouge">service create</code> reference for details.</p> </li> <li> <p>The <code class="highlighter-rouge">--mount-rm</code> flag takes the <code class="highlighter-rouge">target</code> path of the mount.</p> </li> </ul> <pre class="highlight" data-language="bash">$ docker service create \
    --name=myservice \
    --mount \
      type=volume,source=test-data,target=/somewhere \
    nginx:alpine \
    myservice

myservice

$ docker service update \
    --mount-add \
      type=volume,source=other-volume,target=/somewhere-else \
    myservice

myservice

$ docker service update --mount-rm /somewhere myservice

myservice
</pre>  <h3 id="adding-and-removing-secrets">Adding and removing secrets</h3> <p>Use the <code class="highlighter-rouge">--secret-add</code> or <code class="highlighter-rouge">--secret-rm</code> options add or remove a service’s secrets.</p> <p>The following example adds a secret named <code class="highlighter-rouge">ssh-2</code> and removes <code class="highlighter-rouge">ssh-1</code>:</p> <pre class="highlight" data-language="bash">$ docker service update \
    --secret-add source=ssh-2,target=ssh-2 \
    --secret-rm ssh-1 \
    myservice
</pre>  <h3 id="update-services-using-templates">Update services using templates</h3> <p>Some flags of <code class="highlighter-rouge">service update</code> support the use of templating. See <a href="../service_create/#templating"><code class="highlighter-rouge">service create</code></a> for the reference.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2013–2016 Docker, Inc.<br>Licensed under the Apache License, Version 2.0.<br>Docker and the Docker logo are trademarks or registered trademarks of Docker, Inc. in the United States and/or other countries.<br>Docker, Inc. and other parties may also have trademark rights in other terms used herein.<br>
    <a href="https://docs.docker.com/engine/reference/commandline/service_update/" class="_attribution-link" target="_blank">https://docs.docker.com/engine/reference/commandline/service_update/</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
