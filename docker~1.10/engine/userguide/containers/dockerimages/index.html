
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Build Your Own Images (Engine) - Docker 1.10 - W3cubDocs</title>
  
  <meta name="description" content="Docker images are the basis of containers. Each time you’ve used docker run you told it which image you wanted. In the previous sections of the &hellip;">
  <meta name="keywords" content="build, your, own, imagesnext, steps, images, engine, -, docker, docker~1.10">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/docker~1.10/engine/userguide/containers/dockerimages/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/docker~1.10.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/docker~1.10/" class="_nav-link" title="" style="margin-left:0;">Docker 1.10</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _docker">
				
<h1 id="build-your-own-images">Build your own images</h1> <p>Docker images are the basis of containers. Each time you’ve used <code>docker run</code> you told it which image you wanted. In the previous sections of the guide you used Docker images that already exist, for example the <code>ubuntu</code> image and the <code>training/webapp</code> image.</p> <p>You also discovered that Docker stores downloaded images on the Docker host. If an image isn’t already present on the host then it’ll be downloaded from a registry: by default the <a href="https://registry.hub.docker.com" target="_blank">Docker Hub Registry</a>.</p> <p>In this section you’re going to explore Docker images a bit more including:</p> <ul> <li>Managing and working with images locally on your Docker host.</li> <li>Creating basic images.</li> <li>Uploading images to <a href="https://registry.hub.docker.com" target="_blank">Docker Hub Registry</a>.</li> </ul> <h2 id="listing-images-on-the-host">Listing images on the host</h2> <p>Let’s start with listing the images you have locally on our host. You can do this using the <code>docker images</code> command like so:</p> <pre>$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              14.04               1d073211c498        3 days ago          187.9 MB
busybox             latest              2c5ac3f849df        5 days ago          1.113 MB
training/webapp     latest              54bb4e8718e8        5 months ago        348.7 MB
</pre> <p>You can see the images you’ve previously used in the user guide. Each has been downloaded from <a href="https://hub.docker.com" target="_blank">Docker Hub</a> when you launched a container using that image. When you list images, you get three crucial pieces of information in the listing.</p> <ul> <li>What repository they came from, for example <code>ubuntu</code>.</li> <li>The tags for each image, for example <code>14.04</code>.</li> <li>The image ID of each image.</li> </ul> <blockquote> <p><strong>Tip:</strong> You can use <a href="https://github.com/justone/dockviz" target="_blank">a third-party dockviz tool</a> or the <a href="https://imagelayers.io/" target="_blank">Image layers site</a> to display<br> visualizations of image data.</p> </blockquote> <p>A repository potentially holds multiple variants of an image. In the case of our <code>ubuntu</code> image you can see multiple variants covering Ubuntu 10.04, 12.04, 12.10, 13.04, 13.10 and 14.04. Each variant is identified by a tag and you can refer to a tagged image like so:</p> <pre>ubuntu:14.04
</pre> <p>So when you run a container you refer to a tagged image like so:</p> <pre>$ docker run -t -i ubuntu:14.04 /bin/bash
</pre> <p>If instead you wanted to run an Ubuntu 12.04 image you’d use:</p> <pre>$ docker run -t -i ubuntu:12.04 /bin/bash
</pre> <p>If you don’t specify a variant, for example you just use <code>ubuntu</code>, then Docker will default to using the <code>ubuntu:latest</code> image.</p> <blockquote> <p><strong>Tip:</strong> You should always specify an image tag, for example <code>ubuntu:14.04</code>. That way, you always know exactly what variant of an image you are using. This is useful for troubleshooting and debugging.</p> </blockquote> <h2 id="getting-a-new-image">Getting a new image</h2> <p>So how do you get new images? Well Docker will automatically download any image you use that isn’t already present on the Docker host. But this can potentially add some time to the launch of a container. If you want to pre-load an image you can download it using the <code>docker pull</code> command. Suppose you’d like to download the <code>centos</code> image.</p> <pre>$ docker pull centos
Pulling repository centos
b7de3133ff98: Pulling dependent layers
5cc9e91966f7: Pulling fs layer
511136ea3c5a: Download complete
ef52fb1fe610: Download complete
. . .

Status: Downloaded newer image for centos
</pre> <p>You can see that each layer of the image has been pulled down and now you can run a container from this image and you won’t have to wait to download the image.</p> <pre>$ docker run -t -i centos /bin/bash
bash-4.1#
</pre> <h2 id="finding-images">Finding images</h2> <p>One of the features of Docker is that a lot of people have created Docker images for a variety of purposes. Many of these have been uploaded to <a href="https://hub.docker.com" target="_blank">Docker Hub</a>. You can search these images on the <a href="https://hub.docker.com" target="_blank">Docker Hub</a> website.</p> <p><img src="https://docs.docker.com/v1.10/engine/userguide/containers/search.png" alt="indexsearch"></p> <p>You can also search for images on the command line using the <code>docker search</code> command. Suppose your team wants an image with Ruby and Sinatra installed on which to do our web application development. You can search for a suitable image by using the <code>docker search</code> command to find all the images that contain the term <code>sinatra</code>.</p> <pre>$ docker search sinatra
NAME                                   DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
training/sinatra                       Sinatra training image                          0                    [OK]
marceldegraaf/sinatra                  Sinatra test app                                0
mattwarren/docker-sinatra-demo                                                         0                    [OK]
luisbebop/docker-sinatra-hello-world                                                   0                    [OK]
bmorearty/handson-sinatra              handson-ruby + Sinatra for Hands on with D...   0
subwiz/sinatra                                                                         0
bmorearty/sinatra                                                                      0
. . .
</pre> <p>You can see the command returns a lot of images that use the term <code>sinatra</code>. You’ve received a list of image names, descriptions, Stars (which measure the social popularity of images - if a user likes an image then they can “star” it), and the Official and Automated build statuses. <a href="https://docs.docker.com/docker-hub/official_repos" target="_blank">Official Repositories</a> are a carefully curated set of Docker repositories supported by Docker, Inc. Automated repositories are <a href="../dockerrepos/#automated-builds">Automated Builds</a> that allow you to validate the source and content of an image.</p> <p>You’ve reviewed the images available to use and you decided to use the <code>training/sinatra</code> image. So far you’ve seen two types of images repositories, images like <code>ubuntu</code>, which are called base or root images. These base images are provided by Docker Inc and are built, validated and supported. These can be identified by their single word names.</p> <p>You’ve also seen user images, for example the <code>training/sinatra</code> image you’ve chosen. A user image belongs to a member of the Docker community and is built and maintained by them. You can identify user images as they are always prefixed with the user name, here <code>training</code>, of the user that created them.</p> <h2 id="pulling-our-image">Pulling our image</h2> <p>You’ve identified a suitable image, <code>training/sinatra</code>, and now you can download it using the <code>docker pull</code> command.</p> <pre>$ docker pull training/sinatra
</pre> <p>The team can now use this image by running their own containers.</p> <pre>$ docker run -t -i training/sinatra /bin/bash
root@a8cb6ce02d85:/#
</pre> <h2 id="creating-our-own-images">Creating our own images</h2> <p>The team has found the <code>training/sinatra</code> image pretty useful but it’s not quite what they need and you need to make some changes to it. There are two ways you can update and create images.</p> <ol> <li>You can update a container created from an image and commit the results to an image.</li> <li>You can use a <code>Dockerfile</code> to specify instructions to create an image.</li> </ol> <h3 id="updating-and-committing-an-image">Updating and committing an image</h3> <p>To update an image you first need to create a container from the image you’d like to update.</p> <pre>$ docker run -t -i training/sinatra /bin/bash
root@0b2616b0e5a8:/#
</pre> <blockquote> <p><strong>Note:</strong> Take note of the container ID that has been created, <code>0b2616b0e5a8</code>, as you’ll need it in a moment.</p> </blockquote> <p>Inside our running container let’s add the <code>json</code> gem.</p> <pre>root@0b2616b0e5a8:/# gem install json
</pre> <p>Once this has completed let’s exit our container using the <code>exit</code> command.</p> <p>Now you have a container with the change you want to make. You can then commit a copy of this container to an image using the <code>docker commit</code> command.</p> <pre>$ docker commit -m "Added json gem" -a "Kate Smith" \
0b2616b0e5a8 ouruser/sinatra:v2
4f177bd27a9ff0f6dc2a830403925b5360bfe0b93d476f7fc3231110e7f71b1c
</pre> <p>Here you’ve used the <code>docker commit</code> command. You’ve specified two flags: <code>-m</code> and <code>-a</code>. The <code>-m</code> flag allows us to specify a commit message, much like you would with a commit on a version control system. The <code>-a</code> flag allows us to specify an author for our update.</p> <p>You’ve also specified the container you want to create this new image from, <code>0b2616b0e5a8</code> (the ID you recorded earlier) and you’ve specified a target for the image:</p> <pre>ouruser/sinatra:v2
</pre> <p>Break this target down. It consists of a new user, <code>ouruser</code>, that you’re writing this image to. You’ve also specified the name of the image, here you’re keeping the original image name <code>sinatra</code>. Finally you’re specifying a tag for the image: <code>v2</code>.</p> <p>You can then look at our new <code>ouruser/sinatra</code> image using the <code>docker images</code> command.</p> <pre>$ docker images
REPOSITORY          TAG     IMAGE ID       CREATED       SIZE
training/sinatra    latest  5bc342fa0b91   10 hours ago  446.7 MB
ouruser/sinatra     v2      3c59e02ddd1a   10 hours ago  446.7 MB
ouruser/sinatra     latest  5db5f8471261   10 hours ago  446.7 MB
</pre> <p>To use our new image to create a container you can then:</p> <pre>$ docker run -t -i ouruser/sinatra:v2 /bin/bash
root@78e82f680994:/#
</pre> <h3 id="building-an-image-from-a-dockerfile">Building an image from a <code>Dockerfile</code>
</h3> <p>Using the <code>docker commit</code> command is a pretty simple way of extending an image but it’s a bit cumbersome and it’s not easy to share a development process for images amongst a team. Instead you can use a new command, <code>docker build</code>, to build new images from scratch.</p> <p>To do this you create a <code>Dockerfile</code> that contains a set of instructions that tell Docker how to build our image.</p> <p>First, create a directory and a <code>Dockerfile</code>.</p> <pre>$ mkdir sinatra
$ cd sinatra
$ touch Dockerfile
</pre> <p>If you are using Docker Machine on Windows, you may access your host directory by <code>cd</code> to <code>/c/Users/your_user_name</code>.</p> <p>Each instruction creates a new layer of the image. Try a simple example now for building your own Sinatra image for your fictitious development team.</p> <pre># This is a comment
FROM ubuntu:14.04
MAINTAINER Kate Smith &lt;ksmith@example.com&gt;
RUN apt-get update &amp;&amp; apt-get install -y ruby ruby-dev
RUN gem install sinatra
</pre> <p>Examine what your <code>Dockerfile</code> does. Each instruction prefixes a statement and is capitalized.</p> <pre>INSTRUCTION statement
</pre> <blockquote> <p><strong>Note:</strong> You use <code>#</code> to indicate a comment</p> </blockquote> <p>The first instruction <code>FROM</code> tells Docker what the source of our image is, in this case you’re basing our new image on an Ubuntu 14.04 image. The instruction uses the <code>MAINTAINER</code> instruction to specify who maintains the new image.</p> <p>Lastly, you’ve specified two <code>RUN</code> instructions. A <code>RUN</code> instruction executes a command inside the image, for example installing a package. Here you’re updating our APT cache, installing Ruby and RubyGems and then installing the Sinatra gem.</p> <p>Now let’s take our <code>Dockerfile</code> and use the <code>docker build</code> command to build an image.</p> <pre>$ docker build -t ouruser/sinatra:v2 .
Sending build context to Docker daemon 2.048 kB
Sending build context to Docker daemon
Step 1 : FROM ubuntu:14.04
 ---&gt; e54ca5efa2e9
Step 2 : MAINTAINER Kate Smith &lt;ksmith@example.com&gt;
 ---&gt; Using cache
 ---&gt; 851baf55332b
Step 3 : RUN apt-get update &amp;&amp; apt-get install -y ruby ruby-dev
 ---&gt; Running in 3a2558904e9b
Selecting previously unselected package libasan0:amd64.
(Reading database ... 11518 files and directories currently installed.)
Preparing to unpack .../libasan0_4.8.2-19ubuntu1_amd64.deb ...
Unpacking libasan0:amd64 (4.8.2-19ubuntu1) ...
Selecting previously unselected package libatomic1:amd64.
Preparing to unpack .../libatomic1_4.8.2-19ubuntu1_amd64.deb ...
Unpacking libatomic1:amd64 (4.8.2-19ubuntu1) ...
Selecting previously unselected package libgmp10:amd64.
Preparing to unpack .../libgmp10_2%3a5.1.3+dfsg-1ubuntu1_amd64.deb ...
Unpacking libgmp10:amd64 (2:5.1.3+dfsg-1ubuntu1) ...
Selecting previously unselected package libisl10:amd64.
Preparing to unpack .../libisl10_0.12.2-1_amd64.deb ...
Unpacking libisl10:amd64 (0.12.2-1) ...
Selecting previously unselected package libcloog-isl4:amd64.
Preparing to unpack .../libcloog-isl4_0.18.2-1_amd64.deb ...
Unpacking libcloog-isl4:amd64 (0.18.2-1) ...
Selecting previously unselected package libgomp1:amd64.
Preparing to unpack .../libgomp1_4.8.2-19ubuntu1_amd64.deb ...
Unpacking libgomp1:amd64 (4.8.2-19ubuntu1) ...
Selecting previously unselected package libitm1:amd64.
Preparing to unpack .../libitm1_4.8.2-19ubuntu1_amd64.deb ...
Unpacking libitm1:amd64 (4.8.2-19ubuntu1) ...
Selecting previously unselected package libmpfr4:amd64.
Preparing to unpack .../libmpfr4_3.1.2-1_amd64.deb ...
Unpacking libmpfr4:amd64 (3.1.2-1) ...
Selecting previously unselected package libquadmath0:amd64.
Preparing to unpack .../libquadmath0_4.8.2-19ubuntu1_amd64.deb ...
Unpacking libquadmath0:amd64 (4.8.2-19ubuntu1) ...
Selecting previously unselected package libtsan0:amd64.
Preparing to unpack .../libtsan0_4.8.2-19ubuntu1_amd64.deb ...
Unpacking libtsan0:amd64 (4.8.2-19ubuntu1) ...
Selecting previously unselected package libyaml-0-2:amd64.
Preparing to unpack .../libyaml-0-2_0.1.4-3ubuntu3_amd64.deb ...
Unpacking libyaml-0-2:amd64 (0.1.4-3ubuntu3) ...
Selecting previously unselected package libmpc3:amd64.
Preparing to unpack .../libmpc3_1.0.1-1ubuntu1_amd64.deb ...
Unpacking libmpc3:amd64 (1.0.1-1ubuntu1) ...
Selecting previously unselected package openssl.
Preparing to unpack .../openssl_1.0.1f-1ubuntu2.4_amd64.deb ...
Unpacking openssl (1.0.1f-1ubuntu2.4) ...
Selecting previously unselected package ca-certificates.
Preparing to unpack .../ca-certificates_20130906ubuntu2_all.deb ...
Unpacking ca-certificates (20130906ubuntu2) ...
Selecting previously unselected package manpages.
Preparing to unpack .../manpages_3.54-1ubuntu1_all.deb ...
Unpacking manpages (3.54-1ubuntu1) ...
Selecting previously unselected package binutils.
Preparing to unpack .../binutils_2.24-5ubuntu3_amd64.deb ...
Unpacking binutils (2.24-5ubuntu3) ...
Selecting previously unselected package cpp-4.8.
Preparing to unpack .../cpp-4.8_4.8.2-19ubuntu1_amd64.deb ...
Unpacking cpp-4.8 (4.8.2-19ubuntu1) ...
Selecting previously unselected package cpp.
Preparing to unpack .../cpp_4%3a4.8.2-1ubuntu6_amd64.deb ...
Unpacking cpp (4:4.8.2-1ubuntu6) ...
Selecting previously unselected package libgcc-4.8-dev:amd64.
Preparing to unpack .../libgcc-4.8-dev_4.8.2-19ubuntu1_amd64.deb ...
Unpacking libgcc-4.8-dev:amd64 (4.8.2-19ubuntu1) ...
Selecting previously unselected package gcc-4.8.
Preparing to unpack .../gcc-4.8_4.8.2-19ubuntu1_amd64.deb ...
Unpacking gcc-4.8 (4.8.2-19ubuntu1) ...
Selecting previously unselected package gcc.
Preparing to unpack .../gcc_4%3a4.8.2-1ubuntu6_amd64.deb ...
Unpacking gcc (4:4.8.2-1ubuntu6) ...
Selecting previously unselected package libc-dev-bin.
Preparing to unpack .../libc-dev-bin_2.19-0ubuntu6_amd64.deb ...
Unpacking libc-dev-bin (2.19-0ubuntu6) ...
Selecting previously unselected package linux-libc-dev:amd64.
Preparing to unpack .../linux-libc-dev_3.13.0-30.55_amd64.deb ...
Unpacking linux-libc-dev:amd64 (3.13.0-30.55) ...
Selecting previously unselected package libc6-dev:amd64.
Preparing to unpack .../libc6-dev_2.19-0ubuntu6_amd64.deb ...
Unpacking libc6-dev:amd64 (2.19-0ubuntu6) ...
Selecting previously unselected package ruby.
Preparing to unpack .../ruby_1%3a1.9.3.4_all.deb ...
Unpacking ruby (1:1.9.3.4) ...
Selecting previously unselected package ruby1.9.1.
Preparing to unpack .../ruby1.9.1_1.9.3.484-2ubuntu1_amd64.deb ...
Unpacking ruby1.9.1 (1.9.3.484-2ubuntu1) ...
Selecting previously unselected package libruby1.9.1.
Preparing to unpack .../libruby1.9.1_1.9.3.484-2ubuntu1_amd64.deb ...
Unpacking libruby1.9.1 (1.9.3.484-2ubuntu1) ...
Selecting previously unselected package manpages-dev.
Preparing to unpack .../manpages-dev_3.54-1ubuntu1_all.deb ...
Unpacking manpages-dev (3.54-1ubuntu1) ...
Selecting previously unselected package ruby1.9.1-dev.
Preparing to unpack .../ruby1.9.1-dev_1.9.3.484-2ubuntu1_amd64.deb ...
Unpacking ruby1.9.1-dev (1.9.3.484-2ubuntu1) ...
Selecting previously unselected package ruby-dev.
Preparing to unpack .../ruby-dev_1%3a1.9.3.4_all.deb ...
Unpacking ruby-dev (1:1.9.3.4) ...
Setting up libasan0:amd64 (4.8.2-19ubuntu1) ...
Setting up libatomic1:amd64 (4.8.2-19ubuntu1) ...
Setting up libgmp10:amd64 (2:5.1.3+dfsg-1ubuntu1) ...
Setting up libisl10:amd64 (0.12.2-1) ...
Setting up libcloog-isl4:amd64 (0.18.2-1) ...
Setting up libgomp1:amd64 (4.8.2-19ubuntu1) ...
Setting up libitm1:amd64 (4.8.2-19ubuntu1) ...
Setting up libmpfr4:amd64 (3.1.2-1) ...
Setting up libquadmath0:amd64 (4.8.2-19ubuntu1) ...
Setting up libtsan0:amd64 (4.8.2-19ubuntu1) ...
Setting up libyaml-0-2:amd64 (0.1.4-3ubuntu3) ...
Setting up libmpc3:amd64 (1.0.1-1ubuntu1) ...
Setting up openssl (1.0.1f-1ubuntu2.4) ...
Setting up ca-certificates (20130906ubuntu2) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
Setting up manpages (3.54-1ubuntu1) ...
Setting up binutils (2.24-5ubuntu3) ...
Setting up cpp-4.8 (4.8.2-19ubuntu1) ...
Setting up cpp (4:4.8.2-1ubuntu6) ...
Setting up libgcc-4.8-dev:amd64 (4.8.2-19ubuntu1) ...
Setting up gcc-4.8 (4.8.2-19ubuntu1) ...
Setting up gcc (4:4.8.2-1ubuntu6) ...
Setting up libc-dev-bin (2.19-0ubuntu6) ...
Setting up linux-libc-dev:amd64 (3.13.0-30.55) ...
Setting up libc6-dev:amd64 (2.19-0ubuntu6) ...
Setting up manpages-dev (3.54-1ubuntu1) ...
Setting up libruby1.9.1 (1.9.3.484-2ubuntu1) ...
Setting up ruby1.9.1-dev (1.9.3.484-2ubuntu1) ...
Setting up ruby-dev (1:1.9.3.4) ...
Setting up ruby (1:1.9.3.4) ...
Setting up ruby1.9.1 (1.9.3.484-2ubuntu1) ...
Processing triggers for libc-bin (2.19-0ubuntu6) ...
Processing triggers for ca-certificates (20130906ubuntu2) ...
Updating certificates in /etc/ssl/certs... 164 added, 0 removed; done.
Running hooks in /etc/ca-certificates/update.d....done.
 ---&gt; c55c31703134
Removing intermediate container 3a2558904e9b
Step 4 : RUN gem install sinatra
 ---&gt; Running in 6b81cb6313e5
unable to convert "\xC3" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.rdoc, skipping
unable to convert "\xC3" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.rdoc, skipping
Successfully installed rack-1.5.2
Successfully installed tilt-1.4.1
Successfully installed rack-protection-1.5.3
Successfully installed sinatra-1.4.5
4 gems installed
Installing ri documentation for rack-1.5.2...
Installing ri documentation for tilt-1.4.1...
Installing ri documentation for rack-protection-1.5.3...
Installing ri documentation for sinatra-1.4.5...
Installing RDoc documentation for rack-1.5.2...
Installing RDoc documentation for tilt-1.4.1...
Installing RDoc documentation for rack-protection-1.5.3...
Installing RDoc documentation for sinatra-1.4.5...
 ---&gt; 97feabe5d2ed
Removing intermediate container 6b81cb6313e5
Successfully built 97feabe5d2ed
</pre> <p>You’ve specified our <code>docker build</code> command and used the <code>-t</code> flag to identify our new image as belonging to the user <code>ouruser</code>, the repository name <code>sinatra</code> and given it the tag <code>v2</code>.</p> <p>You’ve also specified the location of our <code>Dockerfile</code> using the <code>.</code> to indicate a <code>Dockerfile</code> in the current directory.</p> <blockquote> <p><strong>Note:</strong> You can also specify a path to a <code>Dockerfile</code>.</p> </blockquote> <p>Now you can see the build process at work. The first thing Docker does is upload the build context: basically the contents of the directory you’re building in. This is done because the Docker daemon does the actual build of the image and it needs the local context to do it.</p> <p>Next you can see each instruction in the <code>Dockerfile</code> being executed step-by-step. You can see that each step creates a new container, runs the instruction inside that container and then commits that change - just like the <code>docker commit</code> work flow you saw earlier. When all the instructions have executed you’re left with the <code>97feabe5d2ed</code> image (also helpfully tagged as <code>ouruser/sinatra:v2</code>) and all intermediate containers will get removed to clean things up.</p> <blockquote> <p><strong>Note:</strong> An image can’t have more than 127 layers regardless of the storage driver. This limitation is set globally to encourage optimization of the overall size of images.</p> </blockquote> <p>You can then create a container from our new image.</p> <pre>$ docker run -t -i ouruser/sinatra:v2 /bin/bash
root@8196968dac35:/#
</pre> <blockquote> <p><strong>Note:</strong> This is just a brief introduction to creating images. We’ve skipped a whole bunch of other instructions that you can use. We’ll see more of those instructions in later sections of the Guide or you can refer to the <a href="../../../reference/builder/"><code>Dockerfile</code></a> reference for a detailed description and examples of every instruction. To help you write a clear, readable, maintainable <code>Dockerfile</code>, we’ve also written a <a href="../../eng-image/dockerfile_best-practices/"><code>Dockerfile</code> Best Practices guide</a>.</p> </blockquote> <h2 id="setting-tags-on-an-image">Setting tags on an image</h2> <p>You can also add a tag to an existing image after you commit or build it. We can do this using the <code>docker tag</code> command. Now, add a new tag to your <code>ouruser/sinatra</code> image.</p> <pre>$ docker tag 5db5f8471261 ouruser/sinatra:devel
</pre> <p>The <code>docker tag</code> command takes the ID of the image, here <code>5db5f8471261</code>, and our user name, the repository name and the new tag.</p> <p>Now, see your new tag using the <code>docker images</code> command.</p> <pre>$ docker images ouruser/sinatra
REPOSITORY          TAG     IMAGE ID      CREATED        SIZE
ouruser/sinatra     latest  5db5f8471261  11 hours ago   446.7 MB
ouruser/sinatra     devel   5db5f8471261  11 hours ago   446.7 MB
ouruser/sinatra     v2      5db5f8471261  11 hours ago   446.7 MB
</pre> <h2 id="image-digests">Image Digests</h2> <p>Images that use the v2 or later format have a content-addressable identifier called a <code>digest</code>. As long as the input used to generate the image is unchanged, the digest value is predictable. To list image digest values, use the <code>--digests</code> flag:</p> <pre>$ docker images --digests | head
REPOSITORY        TAG      DIGEST                                                                     IMAGE ID      CREATED       SIZE
ouruser/sinatra   latest   sha256:cbbf2f9a99b47fc460d422812b6a5adff7dfee951d8fa2e4a98caa0382cfbdbf    5db5f8471261  11 hours ago  446.7 MB
</pre> <p>When pushing or pulling to a 2.0 registry, the <code>push</code> or <code>pull</code> command output includes the image digest. You can <code>pull</code> using a digest value.</p> <pre>$ docker pull ouruser/sinatra@sha256:cbbf2f9a99b47fc460d422812b6a5adff7dfee951d8fa2e4a98caa0382cfbdbf
</pre> <p>You can also reference by digest in <code>create</code>, <code>run</code>, and <code>rmi</code> commands, as well as the <code>FROM</code> image reference in a Dockerfile.</p> <h2 id="push-an-image-to-docker-hub">Push an image to Docker Hub</h2> <p>Once you’ve built or created a new image you can push it to <a href="https://hub.docker.com" target="_blank">Docker Hub</a> using the <code>docker push</code> command. This allows you to share it with others, either publicly, or push it into <a href="https://registry.hub.docker.com/plans/" target="_blank">a private repository</a>.</p> <pre>$ docker push ouruser/sinatra
The push refers to a repository [ouruser/sinatra] (len: 1)
Sending image list
Pushing repository ouruser/sinatra (3 tags)
. . .
</pre> <h2 id="remove-an-image-from-the-host">Remove an image from the host</h2> <p>You can also remove images on your Docker host in a way <a href="../usingdocker/">similar to containers</a> using the <code>docker rmi</code> command.</p> <p>Delete the <code>training/sinatra</code> image as you don’t need it anymore.</p> <pre>$ docker rmi training/sinatra
Untagged: training/sinatra:latest
Deleted: 5bc342fa0b91cabf65246837015197eecfa24b2213ed6a51a8974ae250fedd8d
Deleted: ed0fffdcdae5eb2c3a55549857a8be7fc8bc4241fb19ad714364cbfd7a56b22f
Deleted: 5c58979d73ae448df5af1d8142436d81116187a7633082650549c52c3a2418f0
</pre> <blockquote> <p><strong>Note:</strong> To remove an image from the host, please make sure that there are no containers actively based on it.</p> </blockquote> <h1 id="next-steps">Next steps</h1> <p>Until now you’ve seen how to build individual applications inside Docker containers. Now learn how to build whole application stacks with Docker by networking together multiple Docker containers.</p> <p>Go to <a href="../networkingcontainers/">Network containers</a>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2013–2016 Docker, Inc.<br>Licensed under the Apache License, Version 2.0.<br>Docker and the Docker logo are trademarks or registered trademarks of Docker, Inc. in the United States and/or other countries.<br>Docker, Inc. and other parties may also have trademark rights in other terms used herein.<br>
    <a href="https://docs.docker.com/v1.10/engine/userguide/containers/dockerimages/" class="_attribution-link" target="_blank">https://docs.docker.com/v1.10/engine/userguide/containers/dockerimages/</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
