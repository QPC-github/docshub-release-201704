
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Amazon Web Services (Machine) - Docker 1.11 - W3cubDocs</title>
  
  <meta name="description" content=" Create machines on Amazon Web Services. ">
  <meta name="keywords" content="amazon, web, services, machine, -, docker, docker~1.11">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/docker~1.11/machine/drivers/aws/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/docker~1.11.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/docker~1.11/" class="_nav-link" title="" style="margin-left:0;">Docker 1.11</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _docker">
				
<h1 id="amazon-web-services">Amazon Web Services</h1> <p>Create machines on <a href="http://aws.amazon.com" target="_blank">Amazon Web Services</a>.</p> <p>To create machines on <a href="http://aws.amazon.com" target="_blank">Amazon Web Services</a>, you must supply two parameters: the AWS Access Key ID and the AWS Secret Access Key.</p> <h2 id="configuring-credentials">Configuring credentials</h2> <p>Before using the amazonec2 driver, ensure that youâ€™ve configured credentials.</p> <h3 id="aws-credential-file">AWS credential file</h3> <p>One way to configure credentials is to use the standard credential file for Amazon AWS <code>~/.aws/credentials</code> file, which might look like:</p> <pre>[default]
aws_access_key_id = AKID1234567890
aws_secret_access_key = MY-SECRET-KEY
</pre> <p>On Mac OS or various flavors of Linux you can install the <a href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-quick-configuration" target="_blank">AWS Command Line Interface</a> (<code>aws cli</code>) in the terminal and use the <code>aws configure</code> command which guides you through the creation of the credentials file.</p> <p>This is the simplest method, you can then create a new machine with:</p> <pre>$ docker-machine create --driver amazonec2 aws01
</pre> <h3 id="command-line-flags">Command line flags</h3> <p>Alternatively, you can use the flags <code>--amazonec2-access-key</code> and <code>--amazonec2-secret-key</code> on the command line:</p> <pre>$ docker-machine create --driver amazonec2 --amazonec2-access-key AKI******* --amazonec2-secret-key 8T93C*******  aws01
</pre> <h3 id="environment-variables">Environment variables</h3> <p>You can use environment variables:</p> <pre>$ export AWS_ACCESS_KEY_ID=AKID1234567890
$ export AWS_SECRET_ACCESS_KEY=MY-SECRET-KEY
$ docker-machine create --driver amazonec2 aws01
</pre> <h2 id="options">Options</h2> <ul> <li>
<code>--amazonec2-access-key</code>: Your access key id for the Amazon Web Services API.</li> <li>
<code>--amazonec2-secret-key</code>: Your secret access key for the Amazon Web Services API.</li> <li>
<code>--amazonec2-session-token</code>: Your session token for the Amazon Web Services API.</li> <li>
<code>--amazonec2-ami</code>: The AMI ID of the instance to use.</li> <li>
<code>--amazonec2-region</code>: The region to use when launching the instance.</li> <li>
<code>--amazonec2-vpc-id</code>: Your VPC ID to launch the instance in.</li> <li>
<code>--amazonec2-zone</code>: The AWS zone to launch the instance in (i.e. one of a,b,c,d,e).</li> <li>
<code>--amazonec2-subnet-id</code>: AWS VPC subnet id.</li> <li>
<code>--amazonec2-security-group</code>: AWS VPC security group name.</li> <li>
<code>--amazonec2-tags</code>: AWS extra tag key-value pairs (comma-separated, e.g. key1,value1,key2,value2).</li> <li>
<code>--amazonec2-instance-type</code>: The instance type to run.</li> <li>
<code>--amazonec2-device-name</code>: The root device name of the instance.</li> <li>
<code>--amazonec2-root-size</code>: The root disk size of the instance (in GB).</li> <li>
<code>--amazonec2-volume-type</code>: The Amazon EBS volume type to be attached to the instance.</li> <li>
<code>--amazonec2-iam-instance-profile</code>: The AWS IAM role name to be used as the instance profile.</li> <li>
<code>--amazonec2-ssh-user</code>: The SSH Login username, which must match the default SSH user set in the ami used.</li> <li>
<code>--amazonec2-request-spot-instance</code>: Use spot instances.</li> <li>
<code>--amazonec2-spot-price</code>: Spot instance bid price (in dollars). Require the <code>--amazonec2-request-spot-instance</code> flag.</li> <li>
<code>--amazonec2-use-private-address</code>: Use the private IP address for docker-machine, but still create a public IP address.</li> <li>
<code>--amazonec2-private-address-only</code>: Use the private IP address only.</li> <li>
<code>--amazonec2-monitoring</code>: Enable CloudWatch Monitoring.</li> <li>
<code>--amazonec2-use-ebs-optimized-instance</code>: Create an EBS Optimized Instance, instance type must support it.</li> <li>
<code>--amazonec2-ssh-keypath</code>: Path to Private Key file to use for instance. Matching public key with .pub extension should exist</li> <li>
<code>--amazonec2-retries</code>: Set retry count for recoverable failures (use -1 to disable)</li> </ul> <p>Environment variables and default values:</p> <table> <thead> <tr> <th>CLI option</th> <th>Environment variable</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>--amazonec2-access-key</code></td> <td><code>AWS_ACCESS_KEY_ID</code></td> <td>-</td> </tr> <tr> <td><code>--amazonec2-secret-key</code></td> <td><code>AWS_SECRET_ACCESS_KEY</code></td> <td>-</td> </tr> <tr> <td><code>--amazonec2-session-token</code></td> <td><code>AWS_SESSION_TOKEN</code></td> <td>-</td> </tr> <tr> <td><code>--amazonec2-ami</code></td> <td><code>AWS_AMI</code></td> <td><code>ami-5f709f34</code></td> </tr> <tr> <td><code>--amazonec2-region</code></td> <td><code>AWS_DEFAULT_REGION</code></td> <td><code>us-east-1</code></td> </tr> <tr> <td><code>--amazonec2-vpc-id</code></td> <td><code>AWS_VPC_ID</code></td> <td>-</td> </tr> <tr> <td><code>--amazonec2-zone</code></td> <td><code>AWS_ZONE</code></td> <td><code>a</code></td> </tr> <tr> <td><code>--amazonec2-subnet-id</code></td> <td><code>AWS_SUBNET_ID</code></td> <td>-</td> </tr> <tr> <td><code>--amazonec2-security-group</code></td> <td><code>AWS_SECURITY_GROUP</code></td> <td><code>docker-machine</code></td> </tr> <tr> <td><code>--amazonec2-tags</code></td> <td><code>AWS_TAGS</code></td> <td>-</td> </tr> <tr> <td><code>--amazonec2-instance-type</code></td> <td><code>AWS_INSTANCE_TYPE</code></td> <td><code>t2.micro</code></td> </tr> <tr> <td><code>--amazonec2-device-name</code></td> <td><code>AWS_DEVICE_NAME</code></td> <td><code>/dev/sda1</code></td> </tr> <tr> <td><code>--amazonec2-root-size</code></td> <td><code>AWS_ROOT_SIZE</code></td> <td><code>16</code></td> </tr> <tr> <td><code>--amazonec2-volume-type</code></td> <td><code>AWS_VOLUME_TYPE</code></td> <td><code>gp2</code></td> </tr> <tr> <td><code>--amazonec2-iam-instance-profile</code></td> <td><code>AWS_INSTANCE_PROFILE</code></td> <td>-</td> </tr> <tr> <td><code>--amazonec2-ssh-user</code></td> <td><code>AWS_SSH_USER</code></td> <td><code>ubuntu</code></td> </tr> <tr> <td><code>--amazonec2-request-spot-instance</code></td> <td>-</td> <td><code>false</code></td> </tr> <tr> <td><code>--amazonec2-spot-price</code></td> <td>-</td> <td><code>0.50</code></td> </tr> <tr> <td><code>--amazonec2-use-private-address</code></td> <td>-</td> <td><code>false</code></td> </tr> <tr> <td><code>--amazonec2-private-address-only</code></td> <td>-</td> <td><code>false</code></td> </tr> <tr> <td><code>--amazonec2-monitoring</code></td> <td>-</td> <td><code>false</code></td> </tr> <tr> <td><code>--amazonec2-use-ebs-optimized-instance</code></td> <td>-</td> <td><code>false</code></td> </tr> <tr> <td><code>--amazonec2-ssh-keypath</code></td> <td><code>AWS_SSH_KEYPATH</code></td> <td>-</td> </tr> <tr> <td><code>--amazonec2-retries</code></td> <td>-</td> <td><code>5</code></td> </tr> </tbody> </table> <h2 id="default-amis">Default AMIs</h2> <p>By default, the Amazon EC2 driver will use a daily image of Ubuntu 15.10 LTS.</p> <table> <thead> <tr> <th>Region</th> <th>AMI ID</th> </tr> </thead> <tbody> <tr> <td>ap-northeast-1</td> <td>ami-b36d4edd</td> </tr> <tr> <td>ap-southeast-1</td> <td>ami-1069af73</td> </tr> <tr> <td>ap-southeast-2</td> <td>ami-1d336a7e</td> </tr> <tr> <td>cn-north-1</td> <td>ami-79eb2214</td> </tr> <tr> <td>eu-west-1</td> <td>ami-8aa67cf9</td> </tr> <tr> <td>eu-central-1</td> <td>ami-ab0210c7</td> </tr> <tr> <td>sa-east-1</td> <td>ami-185de774</td> </tr> <tr> <td>us-east-1</td> <td>ami-26d5af4c</td> </tr> <tr> <td>us-west-1</td> <td>ami-9cbcd2fc</td> </tr> <tr> <td>us-west-2</td> <td>ami-16b1a077</td> </tr> <tr> <td>us-gov-west-1</td> <td>ami-b0bad893</td> </tr> </tbody> </table> <h2 id="security-group">Security Group</h2> <p>Note that a security group will be created and associated to the host. This security group will have the following ports opened inbound:</p> <ul> <li>ssh (22/tcp)</li> <li>docker (2376/tcp)</li> <li>swarm (3376/tcp), only if the node is a swarm master</li> </ul> <p>If you specify a security group yourself using the <code>--amazonec2-security-group</code> flag, the above ports will be checked and opened and the security group modified. If you want more ports to be opened, like application specific ports, use the aws console and modify the configuration manually.</p> <h2 id="vpc-id">VPC ID</h2> <p>We determine your default vpc id at the start of a command. In some cases, either because your account does not have a default vpc, or you donâ€™t want to use the default one, you can specify a vpc with the <code>--amazonec2-vpc-id</code> flag.</p> <p>To find the VPC ID:</p> <ol> <li>Login to the AWS console</li> <li>Go to <strong>Services -&gt; VPC -&gt; Your VPCs</strong>.</li> <li>Locate the VPC ID you want from the <em>VPC</em> column.</li> <li>
<p>Go to <strong>Services -&gt; VPC -&gt; Subnets</strong>. Examine the <em>Availability Zone</em> column to verify that zone <code>a</code> exists and matches your VPC ID.</p> <p>For example, <code>us-east1-a</code> is in the <code>a</code> availability zone. If the <code>a</code> zone is not present, you can create a new subnet in that zone or specify a different zone when you create the machine.</p>
</li> </ol> <p>To create a machine with a non-default vpc-id:</p> <pre>$ docker-machine create --driver amazonec2 --amazonec2-access-key AKI******* --amazonec2-secret-key 8T93C********* --amazonec2-vpc-id vpc-****** aws02
</pre> <p>This example assumes the VPC ID was found in the <code>a</code> availability zone. Use the<code>--amazonec2-zone</code> flag to specify a zone other than the <code>a</code> zone. For example, <code>--amazonec2-zone c</code> signifies <code>us-east1-c</code>.</p> <h2 id="vpc-connectivity">VPC Connectivity</h2> <p>Machine uses SSH to complete the set up of instances in EC2 and requires the ability to access the instance directly.</p> <p>If you use the flag <code>--amazonec2-private-address-only</code>, you will need to ensure that you have some method of accessing the new instance from within the internal network of the VPC (e.g. a corporate VPN to the VPC, a VPN instance inside the VPC or using Docker-machine from an instance within your VPC).</p> <p>Configuration of VPCs is beyond the scope of this guide, however the first step in troubleshooting is ensuring if you are using private subnets that you follow the design guidance in the <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Scenario2.html" target="_blank">AWS VPC User Guide</a> and have some form of NAT available so that the set up process can access the internet to complete set up.</p> <h2 id="custom-ami-and-ssh-username">Custom AMI and SSH username</h2> <p>The default SSH username for the default AMIs is <code>ubuntu</code>.</p> <p>You need to change the SSH username only if the custom AMI you use has a different SSH username.</p> <p>You can change the SSH username with the <code>--amazonec2-ssh-user</code> according to the AMI you selected with the <code>--amazonec2-ami</code>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2013â€“2016 Docker, Inc.<br>Licensed under the Apache License, Version 2.0.<br>Docker and the Docker logo are trademarks or registered trademarks of Docker, Inc. in the United States and/or other countries.<br>Docker, Inc. and other parties may also have trademark rights in other terms used herein.<br>
    <a href="https://docs.docker.com/v1.11/machine/drivers/aws/" class="_attribution-link" target="_blank">https://docs.docker.com/v1.11/machine/drivers/aws/</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
