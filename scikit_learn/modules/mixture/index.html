
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>2.1. Gaussian Mixture Models - Scikit-learn - W3cubDocs</title>
  
  <meta name="description" content="sklearn.mixture is a package which enables one to learn Gaussian Mixture Models (diagonal, spherical, tied and full covariance matrices supported), &hellip;">
  <meta name="keywords" content="gaussian, mixture, models, -, scikit-learn, scikit_learn">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/scikit_learn/modules/mixture/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/scikit_learn.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/scikit_learn/" class="_nav-link" title="" style="margin-left:0;">scikit-learn</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				
<h1 id="mixture">2.1. Gaussian mixture models</h1> <p id="gaussian-mixture-models"><code>sklearn.mixture</code> is a package which enables one to learn Gaussian Mixture Models (diagonal, spherical, tied and full covariance matrices supported), sample them, and estimate them from data. Facilities to help determine the appropriate number of components are also provided.</p>  <div class="figure align-center" id="id4"> <a class="reference external image-reference" href="../../auto_examples/mixture/plot_gmm_pdf/"><img alt="../_images/sphx_glr_plot_gmm_pdf_0011.png" src="http://scikit-learn.org/stable/_images/sphx_glr_plot_gmm_pdf_0011.png" style="width: 400.0px; height: 300.0px;"></a> <p class="caption"><span class="caption-text"><strong>Two-component Gaussian mixture model:</strong> <em>data points, and equi-probability surfaces of the model.</em></span></p> </div>  <p>A Gaussian mixture model is a probabilistic model that assumes all the data points are generated from a mixture of a finite number of Gaussian distributions with unknown parameters. One can think of mixture models as generalizing k-means clustering to incorporate information about the covariance structure of the data as well as the centers of the latent Gaussians.</p> <p>Scikit-learn implements different classes to estimate Gaussian mixture models, that correspond to different estimation strategies, detailed below.</p>  <h2 id="gaussian-mixture">2.1.1. Gaussian Mixture</h2> <p>The <a class="reference internal" href="../generated/sklearn.mixture.gaussianmixture/#sklearn.mixture.GaussianMixture" title="sklearn.mixture.GaussianMixture"><code>GaussianMixture</code></a> object implements the <a class="reference internal" href="#expectation-maximization"><span class="std std-ref">expectation-maximization</span></a> (EM) algorithm for fitting mixture-of-Gaussian models. It can also draw confidence ellipsoids for multivariate models, and compute the Bayesian Information Criterion to assess the number of clusters in the data. A <a class="reference internal" href="../generated/sklearn.mixture.gaussianmixture/#sklearn.mixture.GaussianMixture.fit" title="sklearn.mixture.GaussianMixture.fit"><code>GaussianMixture.fit</code></a> method is provided that learns a Gaussian Mixture Model from train data. Given test data, it can assign to each sample the Gaussian it mostly probably belong to using the <a class="reference internal" href="../generated/sklearn.mixture.gaussianmixture/#sklearn.mixture.GaussianMixture.predict" title="sklearn.mixture.GaussianMixture.predict"><code>GaussianMixture.predict</code></a> method.</p> <p>The <a class="reference internal" href="../generated/sklearn.mixture.gaussianmixture/#sklearn.mixture.GaussianMixture" title="sklearn.mixture.GaussianMixture"><code>GaussianMixture</code></a> comes with different options to constrain the covariance of the difference classes estimated: spherical, diagonal, tied or full covariance.</p> <div class="figure align-center"> <a class="reference external image-reference" href="../../auto_examples/mixture/plot_gmm_covariances/"><img alt="../_images/sphx_glr_plot_gmm_covariances_0011.png" src="http://scikit-learn.org/stable/_images/sphx_glr_plot_gmm_covariances_0011.png" style="width: 450.0px; height: 450.0px;"></a> </div> <div class="topic"> <p class="topic-title first">Examples:</p> <ul class="simple"> <li>See <a class="reference internal" href="../../auto_examples/mixture/plot_gmm_covariances/#sphx-glr-auto-examples-mixture-plot-gmm-covariances-py"><span class="std std-ref">GMM covariances</span></a> for an example of using the Gaussian mixture as clustering on the iris dataset.</li> <li>See <a class="reference internal" href="../../auto_examples/mixture/plot_gmm_pdf/#sphx-glr-auto-examples-mixture-plot-gmm-pdf-py"><span class="std std-ref">Density Estimation for a Gaussian mixture</span></a> for an example on plotting the density estimation.</li> </ul> </div>  <h3 id="pros-and-cons-of-class-gaussianmixture">2.1.1.1. Pros and cons of class <a class="reference internal" href="../generated/sklearn.mixture.gaussianmixture/#sklearn.mixture.GaussianMixture" title="sklearn.mixture.GaussianMixture"><code>GaussianMixture</code></a>
</h3>  <h4 id="pros">2.1.1.1.1. Pros</h4> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr class="field-odd field">
<th class="field-name">Speed:</th>
<td class="field-body">It is the fastest algorithm for learning mixture models</td> </tr> <tr class="field-even field">
<th class="field-name">Agnostic:</th>
<td class="field-body">As this algorithm maximizes only the likelihood, it will not bias the means towards zero, or bias the cluster sizes to have specific structures that might or might not apply.</td> </tr>  </table>   <h4 id="cons">2.1.1.1.2. Cons</h4> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr class="field-odd field">
<th class="field-name">Singularities:</th>
<td class="field-body">When one has insufficiently many points per mixture, estimating the covariance matrices becomes difficult, and the algorithm is known to diverge and find solutions with infinite likelihood unless one regularizes the covariances artificially.</td> </tr> <tr class="field-even field"><th class="field-name" colspan="2">Number of components:</th></tr> <tr class="field-even field">
<td> </td>
<td class="field-body">This algorithm will always use all the components it has access to, needing held-out data or information theoretical criteria to decide how many components to use in the absence of external cues.</td> </tr>  </table>    <h3 id="selecting-the-number-of-components-in-a-classical-gaussian-mixture-model">2.1.1.2. Selecting the number of components in a classical Gaussian Mixture Model</h3> <p>The BIC criterion can be used to select the number of components in a Gaussian Mixture in an efficient way. In theory, it recovers the true number of components only in the asymptotic regime (i.e. if much data is available and assuming that the data was actually generated i.i.d. from a mixture of Gaussian distribution). Note that using a <a class="reference internal" href="#bgmm"><span class="std std-ref">Variational Bayesian Gaussian mixture</span></a> avoids the specification of the number of components for a Gaussian mixture model.</p> <div class="figure align-center"> <a class="reference external image-reference" href="../../auto_examples/mixture/plot_gmm_selection/"><img alt="../_images/sphx_glr_plot_gmm_selection_0011.png" src="http://scikit-learn.org/stable/_images/sphx_glr_plot_gmm_selection_0011.png" style="width: 400.0px; height: 300.0px;"></a> </div> <div class="topic"> <p class="topic-title first">Examples:</p> <ul class="simple"> <li>See <a class="reference internal" href="../../auto_examples/mixture/plot_gmm_selection/#sphx-glr-auto-examples-mixture-plot-gmm-selection-py"><span class="std std-ref">Gaussian Mixture Model Selection</span></a> for an example of model selection performed with classical Gaussian mixture.</li> </ul> </div>   <h3 id="expectation-maximization">2.1.1.3. Estimation algorithm Expectation-maximization</h3> <p id="estimation-algorithm-expectation-maximization">The main difficulty in learning Gaussian mixture models from unlabeled data is that it is one usually doesn’t know which points came from which latent component (if one has access to this information it gets very easy to fit a separate Gaussian distribution to each set of points). <a class="reference external" href="https://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm" target="_blank">Expectation-maximization</a> is a well-founded statistical algorithm to get around this problem by an iterative process. First one assumes random components (randomly centered on data points, learned from k-means, or even just normally distributed around the origin) and computes for each point a probability of being generated by each component of the model. Then, one tweaks the parameters to maximize the likelihood of the data given those assignments. Repeating this process is guaranteed to always converge to a local optimum.</p>    <h2 id="bgmm">2.1.2. Variational Bayesian Gaussian Mixture</h2> <p id="variational-bayesian-gaussian-mixture">The <a class="reference internal" href="../generated/sklearn.mixture.bayesiangaussianmixture/#sklearn.mixture.BayesianGaussianMixture" title="sklearn.mixture.BayesianGaussianMixture"><code>BayesianGaussianMixture</code></a> object implements a variant of the Gaussian mixture model with variational inference algorithms. The API is similar as the one defined by <a class="reference internal" href="../generated/sklearn.mixture.gaussianmixture/#sklearn.mixture.GaussianMixture" title="sklearn.mixture.GaussianMixture"><code>GaussianMixture</code></a>.</p>  <h3 id="variational-inference">2.1.2.1. Estimation algorithm: variational inference</h3> <p id="estimation-algorithm-variational-inference">Variational inference is an extension of expectation-maximization that maximizes a lower bound on model evidence (including priors) instead of data likelihood. The principle behind variational methods is the same as expectation-maximization (that is both are iterative algorithms that alternate between finding the probabilities for each point to be generated by each mixture and fitting the mixture to these assigned points), but variational methods add regularization by integrating information from prior distributions. This avoids the singularities often found in expectation-maximization solutions but introduces some subtle biases to the model. Inference is often notably slower, but not usually as much so as to render usage unpractical.</p> <p>Due to its Bayesian nature, the variational algorithm needs more hyper- parameters than expectation-maximization, the most important of these being the concentration parameter <code>weight_concentration_prior</code>. Specifying a low value for the concentration prior will make the model put most of the weight on few components set the remaining components weights very close to zero. High values of the concentration prior will allow a larger number of components to be active in the mixture.</p> <p>The parameters implementation of the <a class="reference internal" href="../generated/sklearn.mixture.bayesiangaussianmixture/#sklearn.mixture.BayesianGaussianMixture" title="sklearn.mixture.BayesianGaussianMixture"><code>BayesianGaussianMixture</code></a> class proposes two types of prior for the weights distribution: a finite mixture model with Dirichlet distribution and an infinite mixture model with the Dirichlet Process. In practice Dirichlet Process inference algorithm is approximated and uses a truncated distribution with a fixed maximum number of components (called the Stick-breaking representation). The number of components actually used almost always depends on the data.</p> <p>The next figure compares the results obtained for the different type of the weight concentration prior (parameter <code>weight_concentration_prior_type</code>) for different values of <code>weight_concentration_prior</code>. Here, we can see the the value of the <code>weight_concentration_prior</code> parameter has a strong impact on the effective number of active components obtained. We can also notice that large values for the concentration weight prior lead to more uniform weights when the type of prior is ‘dirichlet_distribution’ while this is not necessarily the case for the ‘dirichlet_process’ type (used by default).</p> <p class="centered"> <strong><a class="reference external" href="../../auto_examples/mixture/plot_gmm/"><img alt="plot_bgmm" src="http://scikit-learn.org/stable/_images/sphx_glr_plot_concentration_prior_0021.png" style="width: 676.8px; height: 384.0px;"></a> <a class="reference external" href="../../auto_examples/mixture/plot_concentration_prior/"><img alt="plot_dpgmm" src="http://scikit-learn.org/stable/_images/sphx_glr_plot_concentration_prior_0021.png" style="width: 676.8px; height: 384.0px;"></a></strong></p>
<p>The examples below compare Gaussian mixture models with a fixed number of components, to the variational Gaussian mixture models with a Dirichlet process prior. Here, a classical Gaussian mixture is fitted with 5 components on a dataset composed of 2 clusters. We can see that the variational Gaussian mixture with a Dirichlet process prior is able to limit itself to only 2 components whereas the Gaussian mixture fits the data with a fixed number of components that has to be set a priori by the user. In this case the user has selected <code>n_components=5</code> which does not match the true generative distribution of this toy dataset. Note that with very little observations, the variational Gaussian mixture models with a Dirichlet process prior can take a conservative stand, and fit only one component.</p> <div class="figure align-center"> <a class="reference external image-reference" href="../../auto_examples/mixture/plot_gmm/"><img alt="../_images/sphx_glr_plot_gmm_0011.png" src="http://scikit-learn.org/stable/_images/sphx_glr_plot_gmm_0011.png" style="width: 560.0px; height: 420.0px;"></a> </div> <p>On the following figure we are fitting a dataset not well-depicted by a Gaussian mixture. Adjusting the <code>weight_concentration_prior</code>, parameter of the class:<code>BayesianGaussianMixture</code> controls the number of components used to fit this data. We also present on the last two plots a random sampling generated from the two resulting mixtures.</p> <div class="figure align-center"> <a class="reference external image-reference" href="../../auto_examples/mixture/plot_gmm_sin/"><img alt="../_images/sphx_glr_plot_gmm_sin_0011.png" src="http://scikit-learn.org/stable/_images/sphx_glr_plot_gmm_sin_0011.png" style="width: 650.0px; height: 650.0px;"></a> </div> <div class="topic"> <p class="topic-title first">Examples:</p> <ul class="simple"> <li>See <a class="reference internal" href="../../auto_examples/mixture/plot_gmm/#sphx-glr-auto-examples-mixture-plot-gmm-py"><span class="std std-ref">Gaussian Mixture Model Ellipsoids</span></a> for an example on plotting the confidence ellipsoids for both <a class="reference internal" href="../generated/sklearn.mixture.gaussianmixture/#sklearn.mixture.GaussianMixture" title="sklearn.mixture.GaussianMixture"><code>GaussianMixture</code></a> and <a class="reference internal" href="../generated/sklearn.mixture.bayesiangaussianmixture/#sklearn.mixture.BayesianGaussianMixture" title="sklearn.mixture.BayesianGaussianMixture"><code>BayesianGaussianMixture</code></a>.</li> <li>
<a class="reference internal" href="../../auto_examples/mixture/plot_gmm_sin/#sphx-glr-auto-examples-mixture-plot-gmm-sin-py"><span class="std std-ref">Gaussian Mixture Model Sine Curve</span></a> shows using <a class="reference internal" href="../generated/sklearn.mixture.gaussianmixture/#sklearn.mixture.GaussianMixture" title="sklearn.mixture.GaussianMixture"><code>GaussianMixture</code></a> and <a class="reference internal" href="../generated/sklearn.mixture.bayesiangaussianmixture/#sklearn.mixture.BayesianGaussianMixture" title="sklearn.mixture.BayesianGaussianMixture"><code>BayesianGaussianMixture</code></a> to fit a sine wave.</li> <li>See <a class="reference internal" href="../../auto_examples/mixture/plot_concentration_prior/#sphx-glr-auto-examples-mixture-plot-concentration-prior-py"><span class="std std-ref">Concentration Prior Type Analysis of Variation Bayesian Gaussian Mixture</span></a> for an example plotting the confidence ellipsoids for the <a class="reference internal" href="../generated/sklearn.mixture.bayesiangaussianmixture/#sklearn.mixture.BayesianGaussianMixture" title="sklearn.mixture.BayesianGaussianMixture"><code>BayesianGaussianMixture</code></a> with different <code>weight_concentration_prior_type</code> for different values of the parameter <code>weight_concentration_prior</code>.</li> </ul> </div>   <h3 id="pros-and-cons-of-variational-inference-with-bayesiangaussianmixture">2.1.2.2. Pros and cons of variational inference with <a class="reference internal" href="../generated/sklearn.mixture.bayesiangaussianmixture/#sklearn.mixture.BayesianGaussianMixture" title="sklearn.mixture.BayesianGaussianMixture"><code>BayesianGaussianMixture</code></a>
</h3>  <h4 id="id2">2.1.2.2.1. Pros</h4> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr class="field-odd field"><th class="field-name" colspan="2">Automatic selection:</th></tr> <tr class="field-odd field">
<td> </td>
<td class="field-body">when <code>weight_concentration_prior</code> is small enough and <code>n_components</code> is larger than what is found necessary by the model, the Variational Bayesian mixture model has a natural tendency to set some mixture weights values close to zero. This makes it possible to let the model choose a suitable number of effective components automatically. Only an upper bound of this number needs to be provided. Note however that the “ideal” number of active components is very application specific and is typically ill-defined in a data exploration setting.</td> </tr> <tr class="field-even field"><th class="field-name" colspan="2">Less sensitivity to the number of parameters:</th></tr> <tr class="field-even field">
<td> </td>
<td class="field-body">unlike finite models, which will almost always use all components as much as they can, and hence will produce wildly different solutions for different numbers of components, the variantional inference with a Dirichlet process prior (<code>weight_concentration_prior_type='dirichlet_process'</code>) won’t change much with changes to the parameters, leading to more stability and less tuning.</td> </tr> <tr class="field-odd field">
<th class="field-name">Regularization:</th>
<td class="field-body">due to the incorporation of prior information, variational solutions have less pathological special cases than expectation-maximization solutions.</td> </tr>  </table>   <h4 id="id3">2.1.2.2.2. Cons</h4> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr class="field-odd field">
<th class="field-name">Speed:</th>
<td class="field-body">the extra parametrization necessary for variational inference make inference slower, although not by much.</td> </tr> <tr class="field-even field"><th class="field-name" colspan="2">Hyperparameters:</th></tr> <tr class="field-even field">
<td> </td>
<td class="field-body">this algorithm needs an extra hyperparameter that might need experimental tuning via cross-validation.</td> </tr> <tr class="field-odd field">
<th class="field-name">Bias:</th>
<td class="field-body">there are many implicit biases in the inference algorithms (and also in the Dirichlet process if used), and whenever there is a mismatch between these biases and the data it might be possible to fit better models using a finite mixture.</td> </tr>  </table>    <h3 id="dirichlet-process">2.1.2.3. The Dirichlet Process</h3> <p id="the-dirichlet-process">Here we describe variational inference algorithms on Dirichlet process mixture. The Dirichlet process is a prior probability distribution on <em>clusterings with an infinite, unbounded, number of partitions</em>. Variational techniques let us incorporate this prior structure on Gaussian mixture models at almost no penalty in inference time, comparing with a finite Gaussian mixture model.</p> <p>An important question is how can the Dirichlet process use an infinite, unbounded number of clusters and still be consistent. While a full explanation doesn’t fit this manual, one can think of its <code>stick breaking process &lt;https://en.wikipedia.org/wiki/Dirichlet_process#The_stick-breaking_process&gt;</code> analogy to help understanding it. The stick breaking process is a generative story for the Dirichlet process. We start with a unit-length stick and in each step we break off a portion of the remaining stick. Each time, we associate the length of the piece of the stick to the proportion of points that falls into a group of the mixture. At the end, to represent the infinite mixture, we associate the last remaining piece of the stick to the proportion of points that don’t fall into all the other groups. The length of each piece is random variable with probability proportional to the concentration parameter. Smaller value of the concentration will divide the unit-length into larger pieces of the stick (defining more concentrated distribution). Larger concentration values will create smaller pieces of the stick (increasing the number of components with non zero weights).</p> <p>Variational inference techniques for the Dirichlet process still work with a finite approximation to this infinite mixture model, but instead of having to specify a priori how many components one wants to use, one just specifies the concentration parameter and an upper bound on the number of mixture components (this upper bound, assuming it is higher than the “true” number of components, affects only algorithmic complexity, not the actual number of components used).</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2007–2016 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="http://scikit-learn.org/stable/modules/mixture.html" class="_attribution-link" target="_blank">http://scikit-learn.org/stable/modules/mixture.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
