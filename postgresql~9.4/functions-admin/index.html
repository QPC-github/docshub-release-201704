
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Administration Functions - PostgreSQL 9.4 - W3cubDocs</title>
  
  <meta name="description" content=" The functions described in this section are used to control and monitor a PostgreSQL installation. ">
  <meta name="keywords" content="system, administration, functions, -, postgresql, postgresql~9.4">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/postgresql~9.4/functions-admin/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/postgresql~9.4.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/postgresql~9.4/" class="_nav-link" title="" style="margin-left:0;">PostgreSQL 9.4</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _postgres">
				
<h1 class="SECT1" id="FUNCTIONS-ADMIN">9.26. System Administration Functions</h1> <p>The functions described in this section are used to control and monitor a <span class="PRODUCTNAME">PostgreSQL</span> installation.</p> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-ADMIN-SET">9.26.1. Configuration Settings Functions</h2> <p><a href="../functions-admin/#FUNCTIONS-ADMIN-SET-TABLE">Table 9-63</a> shows the functions available to query and alter run-time configuration parameters.</p> <div class="TABLE" id="FUNCTIONS-ADMIN-SET-TABLE">  <p class="c2">Table 9-63. Configuration Settings Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="current_setting">current_setting(<code class="PARAMETER">setting_name</code>)</code></td> <td><code class="TYPE">text</code></td> <td>get current value of setting</td> </tr> <tr> <td><code class="LITERAL" id="set_config">set_config(<code class="PARAMETER">setting_name</code>, <code class="PARAMETER">new_value</code>, <code class="PARAMETER">is_local</code>)</code></td> <td><code class="TYPE">text</code></td> <td>set parameter and return new value</td> </tr> </tbody> </table> </div> <p>The function <code class="FUNCTION">current_setting</code> yields the current value of the setting <code class="PARAMETER">setting_name</code>. It corresponds to the <acronym class="ACRONYM">SQL</acronym> command <code class="COMMAND">SHOW</code>. An example:</p> <pre class="PROGRAMLISTING" data-language="sql">
SELECT current_setting('datestyle');

 current_setting
-----------------
 ISO, MDY
(1 row)
</pre> <p><code class="FUNCTION">set_config</code> sets the parameter <code class="PARAMETER">setting_name</code> to <code class="PARAMETER">new_value</code>. If <code class="PARAMETER">is_local</code> is <code class="LITERAL">true</code>, the new value will only apply to the current transaction. If you want the new value to apply for the current session, use <code class="LITERAL">false</code> instead. The function corresponds to the SQL command <code class="COMMAND">SET</code>. An example:</p> <pre class="PROGRAMLISTING" data-language="sql">
SELECT set_config('log_statement_stats', 'off', false);

 set_config
------------
 off
(1 row)
</pre> </div> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-ADMIN-SIGNAL">9.26.2. Server Signaling Functions</h2> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-ADMIN-SIGNAL-TABLE">Table 9-64</a> send control signals to other server processes. Use of these functions is usually restricted to superusers, with noted exceptions.</p> <div class="TABLE" id="FUNCTIONS-ADMIN-SIGNAL-TABLE">  <p class="c2">Table 9-64. Server Signaling Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_cancel_backend">pg_cancel_backend(<code class="PARAMETER">pid</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Cancel a backend's current query. You can execute this against another backend that has exactly the same role as the user calling the function. In all other cases, you must be a superuser.</td> </tr> <tr> <td><code class="LITERAL" id="pg_reload_conf">pg_reload_conf()</code></td> <td><code class="TYPE">boolean</code></td> <td>Cause server processes to reload their configuration files</td> </tr> <tr> <td><code class="LITERAL" id="pg_rotate_logfile">pg_rotate_logfile()</code></td> <td><code class="TYPE">boolean</code></td> <td>Rotate server's log file</td> </tr> <tr> <td><code class="LITERAL" id="pg_terminate_backend">pg_terminate_backend(<code class="PARAMETER">pid</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Terminate a backend. You can execute this against another backend that has exactly the same role as the user calling the function. In all other cases, you must be a superuser.</td> </tr> </tbody> </table> </div> <p>Each of these functions returns <code class="LITERAL">true</code> if successful and <code class="LITERAL">false</code> otherwise.</p> <p><code class="FUNCTION">pg_cancel_backend</code> and <code class="FUNCTION">pg_terminate_backend</code> send signals (<span class="SYSTEMITEM">SIGINT</span> or <span class="SYSTEMITEM">SIGTERM</span> respectively) to backend processes identified by process ID. The process ID of an active backend can be found from the <code class="STRUCTFIELD">pid</code> column of the <code class="STRUCTNAME">pg_stat_activity</code> view, or by listing the <code class="COMMAND">postgres</code> processes on the server (using <span class="APPLICATION">ps</span> on Unix or the <span class="APPLICATION">Task Manager</span> on <span class="PRODUCTNAME">Windows</span>). The role of an active backend can be found from the <code class="STRUCTFIELD">usename</code> column of the <code class="STRUCTNAME">pg_stat_activity</code> view.</p> <p><code class="FUNCTION">pg_reload_conf</code> sends a <span class="SYSTEMITEM">SIGHUP</span> signal to the server, causing configuration files to be reloaded by all server processes.</p> <p><code class="FUNCTION">pg_rotate_logfile</code> signals the log-file manager to switch to a new output file immediately. This works only when the built-in log collector is running, since otherwise there is no log-file manager subprocess.</p> </div> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-ADMIN-BACKUP">9.26.3. Backup Control Functions</h2> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-ADMIN-BACKUP-TABLE">Table 9-65</a> assist in making on-line backups. These functions cannot be executed during recovery (except <code class="FUNCTION">pg_is_in_backup</code>, <code class="FUNCTION">pg_backup_start_time</code> and <code class="FUNCTION">pg_xlog_location_diff</code>).</p> <div class="TABLE" id="FUNCTIONS-ADMIN-BACKUP-TABLE">  <p class="c2">Table 9-65. Backup Control Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_create_restore_point">pg_create_restore_point(<code class="PARAMETER">name</code> <code class="TYPE">text</code>)</code></td> <td><code class="TYPE">pg_lsn</code></td> <td>Create a named point for performing restore (restricted to superusers)</td> </tr> <tr> <td><code class="LITERAL" id="pg_current_xlog_insert_location">pg_current_xlog_insert_location()</code></td> <td><code class="TYPE">pg_lsn</code></td> <td>Get current transaction log insert location</td> </tr> <tr> <td><code class="LITERAL" id="pg_current_xlog_location">pg_current_xlog_location()</code></td> <td><code class="TYPE">pg_lsn</code></td> <td>Get current transaction log write location</td> </tr> <tr> <td><code class="LITERAL" id="pg_start_backup">pg_start_backup(<code class="PARAMETER">label</code> <code class="TYPE">text</code>
            [<span class="OPTIONAL">, <code class="PARAMETER">fast</code> <code class="TYPE">boolean</code></span> ])</code></td> <td><code class="TYPE">pg_lsn</code></td> <td>Prepare for performing on-line backup (restricted to superusers or replication roles)</td> </tr> <tr> <td><code class="LITERAL" id="pg_stop_backup">pg_stop_backup()</code></td> <td><code class="TYPE">pg_lsn</code></td> <td>Finish performing on-line backup (restricted to superusers or replication roles)</td> </tr> <tr> <td><code class="LITERAL" id="pg_is_in_backup">pg_is_in_backup()</code></td> <td><code class="TYPE">bool</code></td> <td>True if an on-line exclusive backup is still in progress.</td> </tr> <tr> <td><code class="LITERAL" id="pg_backup_start_time">pg_backup_start_time()</code></td> <td><code class="TYPE">timestamp with time zone</code></td> <td>Get start time of an on-line exclusive backup in progress.</td> </tr> <tr> <td><code class="LITERAL" id="pg_switch_xlog">pg_switch_xlog()</code></td> <td><code class="TYPE">pg_lsn</code></td> <td>Force switch to a new transaction log file (restricted to superusers)</td> </tr> <tr> <td><code class="LITERAL" id="pg_xlogfile_name">pg_xlogfile_name(<code class="PARAMETER">location</code> <code class="TYPE">pg_lsn</code>)</code></td> <td><code class="TYPE">text</code></td> <td>Convert transaction log location string to file name</td> </tr> <tr> <td><code class="LITERAL" id="pg_xlogfile_name_offset">pg_xlogfile_name_offset(<code class="PARAMETER">location</code> <code class="TYPE">pg_lsn</code>)</code></td> <td>
<code class="TYPE">text</code>, <code class="TYPE">integer</code>
</td> <td>Convert transaction log location string to file name and decimal byte offset within file</td> </tr> <tr> <td><code class="LITERAL" id="pg_xlog_location_diff">pg_xlog_location_diff(<code class="PARAMETER">location</code> <code class="TYPE">pg_lsn</code>,
            <code class="PARAMETER">location</code> <code class="TYPE">pg_lsn</code>)</code></td> <td><code class="TYPE">numeric</code></td> <td>Calculate the difference between two transaction log locations</td> </tr> </tbody> </table> </div> <p><code class="FUNCTION">pg_start_backup</code> accepts an arbitrary user-defined label for the backup. (Typically this would be the name under which the backup dump file will be stored.) The function writes a backup label file (<code class="FILENAME">backup_label</code>) into the database cluster's data directory, performs a checkpoint, and then returns the backup's starting transaction log location as text. The user can ignore this result value, but it is provided in case it is useful.</p> <pre class="PROGRAMLISTING" data-language="sql">
postgres=# select pg_start_backup('label_goes_here');
 pg_start_backup
-----------------
 0/D4445B8
(1 row)
</pre> <p>There is an optional second parameter of type <code class="TYPE">boolean</code>. If <code class="LITERAL">true</code>, it specifies executing <code class="FUNCTION">pg_start_backup</code> as quickly as possible. This forces an immediate checkpoint which will cause a spike in I/O operations, slowing any concurrently executing queries.</p> <p><code class="FUNCTION">pg_stop_backup</code> removes the label file created by <code class="FUNCTION">pg_start_backup</code>, and creates a backup history file in the transaction log archive area. The history file includes the label given to <code class="FUNCTION">pg_start_backup</code>, the starting and ending transaction log locations for the backup, and the starting and ending times of the backup. The return value is the backup's ending transaction log location (which again can be ignored). After recording the ending location, the current transaction log insertion point is automatically advanced to the next transaction log file, so that the ending transaction log file can be archived immediately to complete the backup.</p> <p><code class="FUNCTION">pg_switch_xlog</code> moves to the next transaction log file, allowing the current file to be archived (assuming you are using continuous archiving). The return value is the ending transaction log location + 1 within the just-completed transaction log file. If there has been no transaction log activity since the last transaction log switch, <code class="FUNCTION">pg_switch_xlog</code> does nothing and returns the start location of the transaction log file currently in use.</p> <p><code class="FUNCTION">pg_create_restore_point</code> creates a named transaction log record that can be used as recovery target, and returns the corresponding transaction log location. The given name can then be used with <a href="../recovery-target-settings/#RECOVERY-TARGET-NAME">recovery_target_name</a> to specify the point up to which recovery will proceed. Avoid creating multiple restore points with the same name, since recovery will stop at the first one whose name matches the recovery target.</p> <p><code class="FUNCTION">pg_current_xlog_location</code> displays the current transaction log write location in the same format used by the above functions. Similarly, <code class="FUNCTION">pg_current_xlog_insert_location</code> displays the current transaction log insertion point. The insertion point is the <span class="QUOTE">"logical"</span> end of the transaction log at any instant, while the write location is the end of what has actually been written out from the server's internal buffers. The write location is the end of what can be examined from outside the server, and is usually what you want if you are interested in archiving partially-complete transaction log files. The insertion point is made available primarily for server debugging purposes. These are both read-only operations and do not require superuser permissions.</p> <p>You can use <code class="FUNCTION">pg_xlogfile_name_offset</code> to extract the corresponding transaction log file name and byte offset from the results of any of the above functions. For example:</p> <pre class="PROGRAMLISTING" data-language="sql">
postgres=# SELECT * FROM pg_xlogfile_name_offset(pg_stop_backup());
        file_name         | file_offset 
--------------------------+-------------
 00000001000000000000000D |     4039624
(1 row)
</pre> <p>Similarly, <code class="FUNCTION">pg_xlogfile_name</code> extracts just the transaction log file name. When the given transaction log location is exactly at a transaction log file boundary, both these functions return the name of the preceding transaction log file. This is usually the desired behavior for managing transaction log archiving behavior, since the preceding file is the last one that currently needs to be archived.</p> <p><code class="FUNCTION">pg_xlog_location_diff</code> calculates the difference in bytes between two transaction log locations. It can be used with <code class="STRUCTNAME">pg_stat_replication</code> or some functions shown in <a href="../functions-admin/#FUNCTIONS-ADMIN-BACKUP-TABLE">Table 9-65</a> to get the replication lag.</p> <p>For details about proper usage of these functions, see <a href="../continuous-archiving/">Section 24.3</a>.</p> </div> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-RECOVERY-CONTROL">9.26.4. Recovery Control Functions</h2> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-RECOVERY-INFO-TABLE">Table 9-66</a> provide information about the current status of the standby. These functions may be executed both during recovery and in normal running.</p> <div class="TABLE" id="FUNCTIONS-RECOVERY-INFO-TABLE">  <p class="c2">Table 9-66. Recovery Information Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_is_in_recovery">pg_is_in_recovery()</code></td> <td><code class="TYPE">bool</code></td> <td>True if recovery is still in progress.</td> </tr> <tr> <td><code class="LITERAL" id="pg_last_xlog_receive_location">pg_last_xlog_receive_location()</code></td> <td><code class="TYPE">pg_lsn</code></td> <td>Get last transaction log location received and synced to disk by streaming replication. While streaming replication is in progress this will increase monotonically. If recovery has completed this will remain static at the value of the last WAL record received and synced to disk during recovery. If streaming replication is disabled, or if it has not yet started, the function returns NULL.</td> </tr> <tr> <td><code class="LITERAL" id="pg_last_xlog_replay_location">pg_last_xlog_replay_location()</code></td> <td><code class="TYPE">pg_lsn</code></td> <td>Get last transaction log location replayed during recovery. If recovery is still in progress this will increase monotonically. If recovery has completed then this value will remain static at the value of the last WAL record applied during that recovery. When the server has been started normally without recovery the function returns NULL.</td> </tr> <tr> <td><code class="LITERAL" id="pg_last_xact_replay_timestamp">pg_last_xact_replay_timestamp()</code></td> <td><code class="TYPE">timestamp with time zone</code></td> <td>Get time stamp of last transaction replayed during recovery. This is the time at which the commit or abort WAL record for that transaction was generated on the primary. If no transactions have been replayed during recovery, this function returns NULL. Otherwise, if recovery is still in progress this will increase monotonically. If recovery has completed then this value will remain static at the value of the last transaction applied during that recovery. When the server has been started normally without recovery the function returns NULL.</td> </tr> </tbody> </table> </div> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-RECOVERY-CONTROL-TABLE">Table 9-67</a> control the progress of recovery. These functions may be executed only during recovery.</p> <div class="TABLE" id="FUNCTIONS-RECOVERY-CONTROL-TABLE">  <p class="c2">Table 9-67. Recovery Control Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_is_xlog_replay_paused">pg_is_xlog_replay_paused()</code></td> <td><code class="TYPE">bool</code></td> <td>True if recovery is paused.</td> </tr> <tr> <td><code class="LITERAL" id="pg_xlog_replay_pause">pg_xlog_replay_pause()</code></td> <td><code class="TYPE">void</code></td> <td>Pauses recovery immediately (restricted to superusers).</td> </tr> <tr> <td><code class="LITERAL" id="pg_xlog_replay_resume">pg_xlog_replay_resume()</code></td> <td><code class="TYPE">void</code></td> <td>Restarts recovery if it was paused (restricted to superusers).</td> </tr> </tbody> </table> </div> <p>While recovery is paused no further database changes are applied. If in hot standby, all new queries will see the same consistent snapshot of the database, and no further query conflicts will be generated until recovery is resumed.</p> <p>If streaming replication is disabled, the paused state may continue indefinitely without problem. While streaming replication is in progress WAL records will continue to be received, which will eventually fill available disk space, depending upon the duration of the pause, the rate of WAL generation and available disk space.</p> </div> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-SNAPSHOT-SYNCHRONIZATION">9.26.5. Snapshot Synchronization Functions</h2> <p><span class="PRODUCTNAME">PostgreSQL</span> allows database sessions to synchronize their snapshots. A <i class="FIRSTTERM">snapshot</i> determines which data is visible to the transaction that is using the snapshot. Synchronized snapshots are necessary when two or more sessions need to see identical content in the database. If two sessions just start their transactions independently, there is always a possibility that some third transaction commits between the executions of the two <code class="COMMAND">START TRANSACTION</code> commands, so that one session sees the effects of that transaction and the other does not.</p> <p>To solve this problem, <span class="PRODUCTNAME">PostgreSQL</span> allows a transaction to <i class="FIRSTTERM">export</i> the snapshot it is using. As long as the exporting transaction remains open, other transactions can <i class="FIRSTTERM">import</i> its snapshot, and thereby be guaranteed that they see exactly the same view of the database that the first transaction sees. But note that any database changes made by any one of these transactions remain invisible to the other transactions, as is usual for changes made by uncommitted transactions. So the transactions are synchronized with respect to pre-existing data, but act normally for changes they make themselves.</p> <p>Snapshots are exported with the <code class="FUNCTION">pg_export_snapshot</code> function, shown in <a href="../functions-admin/#FUNCTIONS-SNAPSHOT-SYNCHRONIZATION-TABLE"> Table 9-68</a>, and imported with the <a href="../sql-set-transaction/">SET TRANSACTION</a> command.</p> <div class="TABLE" id="FUNCTIONS-SNAPSHOT-SYNCHRONIZATION-TABLE">  <p class="c2">Table 9-68. Snapshot Synchronization Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_export_snapshot">pg_export_snapshot()</code></td> <td><code class="TYPE">text</code></td> <td>Save the current snapshot and return its identifier</td> </tr> </tbody> </table> </div> <p>The function <code class="FUNCTION">pg_export_snapshot</code> saves the current snapshot and returns a <code class="TYPE">text</code> string identifying the snapshot. This string must be passed (outside the database) to clients that want to import the snapshot. The snapshot is available for import only until the end of the transaction that exported it. A transaction can export more than one snapshot, if needed. Note that doing so is only useful in <code class="LITERAL">READ COMMITTED</code> transactions, since in <code class="LITERAL">REPEATABLE READ</code> and higher isolation levels, transactions use the same snapshot throughout their lifetime. Once a transaction has exported any snapshots, it cannot be prepared with <a href="../sql-prepare-transaction/">PREPARE TRANSACTION</a>.</p> <p>See <a href="../sql-set-transaction/">SET TRANSACTION</a> for details of how to use an exported snapshot.</p> </div> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-REPLICATION">9.26.6. Replication Functions</h2> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-REPLICATION-TABLE">Table 9-69</a> are for controlling and interacting with replication features. See <a href="../warm-standby/#STREAMING-REPLICATION">Section 25.2.5</a> and <a href="../warm-standby/#STREAMING-REPLICATION-SLOTS">Section 25.2.6</a> for information about the underlying features. Use of these functions is restricted to superusers.</p> <p>Many of these functions have equivalent commands in the replication protocol; see <a href="https://www.postgresql.org/docs/9.4/static/protocol-replication.html" target="_blank">Section 49.3</a>.</p> <p>The functions described in <a href="../functions-admin/#FUNCTIONS-SNAPSHOT-SYNCHRONIZATION">Section 9.26.5</a>, <a href="../functions-admin/#FUNCTIONS-RECOVERY-CONTROL">Section 9.26.4</a>, and <a href="../functions-admin/#FUNCTIONS-ADMIN-BACKUP">Section 9.26.3</a> are also relevant for replication.</p> <div class="TABLE" id="FUNCTIONS-REPLICATION-TABLE">  <p class="c2">Table 9-69. Replication <acronym class="ACRONYM">SQL</acronym> Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Function</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_create_physical_replication_slot">pg_create_physical_replication_slot(<code class="PARAMETER">slot_name</code>
            <code class="TYPE">name</code>)</code></td> <td>(<code class="PARAMETER">slot_name</code> <code class="TYPE">name</code>, <code class="PARAMETER">xlog_position</code> <code class="TYPE">pg_lsn</code>)</td> <td>Creates a new physical replication slot named <code class="PARAMETER">slot_name</code>. Streaming changes from a physical slot is only possible with the streaming-replication protocol - see <a href="https://www.postgresql.org/docs/9.4/static/protocol-replication.html" target="_blank">Section 49.3</a>. Corresponds to the replication protocol command <code class="LITERAL">CREATE_REPLICATION_SLOT ... PHYSICAL</code>.</td> </tr> <tr> <td><code class="LITERAL" id="pg_drop_replication_slot">pg_drop_replication_slot(<code class="PARAMETER">slot_name</code> <code class="TYPE">name</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Drops the physical or logical replication slot named <code class="PARAMETER">slot_name</code>. Same as replication protocol command <code class="LITERAL">DROP_REPLICATION_SLOT</code>.</td> </tr> <tr> <td><code class="LITERAL" id="pg_create_logical_replication_slot">pg_create_logical_replication_slot(<code class="PARAMETER">slot_name</code>
            <code class="TYPE">name</code>, <code class="PARAMETER">plugin</code> <code class="TYPE">name</code>)</code></td> <td>(<code class="PARAMETER">slot_name</code> <code class="TYPE">name</code>, <code class="PARAMETER">xlog_position</code> <code class="TYPE">pg_lsn</code>)</td> <td>Creates a new logical (decoding) replication slot named <code class="PARAMETER">slot_name</code> using the output plugin <code class="PARAMETER">plugin</code>. A call to this function has the same effect as the replication protocol command <code class="LITERAL">CREATE_REPLICATION_SLOT ... LOGICAL</code>.</td> </tr> <tr> <td><code class="LITERAL" id="pg_logical_slot_get_changes">pg_logical_slot_get_changes(<code class="PARAMETER">slot_name</code> <code class="TYPE">name</code>,
            <code class="PARAMETER">upto_lsn</code> <code class="TYPE">pg_lsn</code>, <code class="PARAMETER">upto_nchanges</code> <code class="TYPE">int</code>, VARIADIC <code class="PARAMETER">options</code> <code class="TYPE">text[]</code>)</code></td> <td>(<code class="PARAMETER">location</code> <code class="TYPE">pg_lsn</code>, <code class="PARAMETER">xid</code> <code class="TYPE">xid</code>, <code class="PARAMETER">data</code> <code class="TYPE">text</code>)</td> <td>Returns changes in the slot <code class="PARAMETER">slot_name</code>, starting from the point at which since changes have been consumed last. If <code class="PARAMETER">upto_lsn</code> and <code class="PARAMETER">upto_nchanges</code> are NULL, logical decoding will continue until end of WAL. If <code class="PARAMETER">upto_lsn</code> is non-NULL, decoding will include only those transactions which commit prior to the specified LSN. If <code class="PARAMETER">upto_nchanges</code> is non-NULL, decoding will stop when the number of rows produced by decoding exceeds the specified value. Note, however, that the actual number of rows returned may be larger, since this limit is only checked after adding the rows produced when decoding each new transaction commit.</td> </tr> <tr> <td><code class="LITERAL" id="pg_logical_slot_peek_changes">pg_logical_slot_peek_changes(<code class="PARAMETER">slot_name</code> <code class="TYPE">name</code>,
            <code class="PARAMETER">upto_lsn</code> <code class="TYPE">pg_lsn</code>, <code class="PARAMETER">upto_nchanges</code> <code class="TYPE">int</code>, VARIADIC <code class="PARAMETER">options</code> <code class="TYPE">text[]</code>)</code></td> <td>(<code class="PARAMETER">location</code> <code class="TYPE">text</code>, <code class="PARAMETER">xid</code> <code class="TYPE">xid</code>, <code class="PARAMETER">data</code> <code class="TYPE">text</code>)</td> <td>Behaves just like the <code class="FUNCTION">pg_logical_slot_get_changes()</code> function, except that changes are not consumed; that is, they will be returned again on future calls.</td> </tr> <tr> <td><code class="LITERAL" id="pg_logical_slot_get_binary_changes">pg_logical_slot_get_binary_changes(<code class="PARAMETER">slot_name</code>
            <code class="TYPE">name</code>, <code class="PARAMETER">upto_lsn</code> <code class="TYPE">pg_lsn</code>,
            <code class="PARAMETER">upto_nchanges</code> <code class="TYPE">int</code>, VARIADIC <code class="PARAMETER">options</code> <code class="TYPE">text[]</code>)</code></td> <td>(<code class="PARAMETER">location</code> <code class="TYPE">pg_lsn</code>, <code class="PARAMETER">xid</code> <code class="TYPE">xid</code>, <code class="PARAMETER">data</code> <code class="TYPE">bytea</code>)</td> <td>Behaves just like the <code class="FUNCTION">pg_logical_slot_get_changes()</code> function, except that changes are returned as <code class="TYPE">bytea</code>.</td> </tr> <tr> <td><code class="LITERAL" id="pg_logical_slot_peek_binary_changes">pg_logical_slot_peek_binary_changes(<code class="PARAMETER">slot_name</code>
            <code class="TYPE">name</code>, <code class="PARAMETER">upto_lsn</code> <code class="TYPE">pg_lsn</code>,
            <code class="PARAMETER">upto_nchanges</code> <code class="TYPE">int</code>, VARIADIC <code class="PARAMETER">options</code> <code class="TYPE">text[]</code>)</code></td> <td>(<code class="PARAMETER">location</code> <code class="TYPE">pg_lsn</code>, <code class="PARAMETER">xid</code> <code class="TYPE">xid</code>, <code class="PARAMETER">data</code> <code class="TYPE">bytea</code>)</td> <td>Behaves just like the <code class="FUNCTION">pg_logical_slot_get_changes()</code> function, except that changes are returned as <code class="TYPE">bytea</code> and that changes are not consumed; that is, they will be returned again on future calls.</td> </tr> </tbody> </table> </div> </div> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-ADMIN-DBOBJECT">9.26.7. Database Object Management Functions</h2> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-ADMIN-DBSIZE">Table 9-70</a> calculate the disk space usage of database objects.</p> <div class="TABLE" id="FUNCTIONS-ADMIN-DBSIZE">  <p class="c2">Table 9-70. Database Object Size Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_column_size">pg_column_size(<code class="TYPE">any</code>)</code></td> <td><code class="TYPE">int</code></td> <td>Number of bytes used to store a particular value (possibly compressed)</td> </tr> <tr> <td><code class="LITERAL" id="pg_database_size">pg_database_size(<code class="TYPE">oid</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Disk space used by the database with the specified OID</td> </tr> <tr> <td><code class="LITERAL">pg_database_size(<code class="TYPE">name</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Disk space used by the database with the specified name</td> </tr> <tr> <td><code class="LITERAL" id="pg_indexes_size">pg_indexes_size(<code class="TYPE">regclass</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Total disk space used by indexes attached to the specified table</td> </tr> <tr> <td><code class="LITERAL" id="pg_relation_size">pg_relation_size(<code class="PARAMETER">relation</code> <code class="TYPE">regclass</code>, <code class="PARAMETER">fork</code>
            <code class="TYPE">text</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Disk space used by the specified fork (<code class="LITERAL">'main'</code>, <code class="LITERAL">'fsm'</code>, <code class="LITERAL">'vm'</code>, or <code class="LITERAL">'init'</code>) of the specified table or index</td> </tr> <tr> <td><code class="LITERAL">pg_relation_size(<code class="PARAMETER">relation</code> <code class="TYPE">regclass</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Shorthand for <code class="LITERAL">pg_relation_size(..., 'main')</code>
</td> </tr> <tr> <td><code class="LITERAL" id="pg_size_pretty">pg_size_pretty(<code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">text</code></td> <td>Converts a size in bytes expressed as a 64-bit integer into a human-readable format with size units</td> </tr> <tr> <td><code class="LITERAL">pg_size_pretty(<code class="TYPE">numeric</code>)</code></td> <td><code class="TYPE">text</code></td> <td>Converts a size in bytes expressed as a numeric value into a human-readable format with size units</td> </tr> <tr> <td><code class="LITERAL" id="pg_table_size">pg_table_size(<code class="TYPE">regclass</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Disk space used by the specified table, excluding indexes (but including TOAST, free space map, and visibility map)</td> </tr> <tr> <td><code class="LITERAL" id="pg_tablespace_size">pg_tablespace_size(<code class="TYPE">oid</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Disk space used by the tablespace with the specified OID</td> </tr> <tr> <td><code class="LITERAL">pg_tablespace_size(<code class="TYPE">name</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Disk space used by the tablespace with the specified name</td> </tr> <tr> <td><code class="LITERAL" id="pg_total_relation_size">pg_total_relation_size(<code class="TYPE">regclass</code>)</code></td> <td><code class="TYPE">bigint</code></td> <td>Total disk space used by the specified table, including all indexes and <acronym class="ACRONYM">TOAST</acronym> data</td> </tr> </tbody> </table> </div> <p><code class="FUNCTION">pg_column_size</code> shows the space used to store any individual data value.</p> <p><code class="FUNCTION">pg_total_relation_size</code> accepts the OID or name of a table or toast table, and returns the total on-disk space used for that table, including all associated indexes. This function is equivalent to <code class="FUNCTION">pg_table_size</code> <code class="LITERAL">+</code> <code class="FUNCTION">pg_indexes_size</code>.</p> <p><code class="FUNCTION">pg_table_size</code> accepts the OID or name of a table and returns the disk space needed for that table, exclusive of indexes. (TOAST space, free space map, and visibility map are included.)</p> <p><code class="FUNCTION">pg_indexes_size</code> accepts the OID or name of a table and returns the total disk space used by all the indexes attached to that table.</p> <p><code class="FUNCTION">pg_database_size</code> and <code class="FUNCTION">pg_tablespace_size</code> accept the OID or name of a database or tablespace, and return the total disk space used therein. To use <code class="FUNCTION">pg_database_size</code>, you must have <code class="LITERAL">CONNECT</code> permission on the specified database (which is granted by default). To use <code class="FUNCTION">pg_tablespace_size</code>, you must have <code class="LITERAL">CREATE</code> permission on the specified tablespace, unless it is the default tablespace for the current database.</p> <p><code class="FUNCTION">pg_relation_size</code> accepts the OID or name of a table, index or toast table, and returns the on-disk size in bytes of one fork of that relation. (Note that for most purposes it is more convenient to use the higher-level functions <code class="FUNCTION">pg_total_relation_size</code> or <code class="FUNCTION">pg_table_size</code>, which sum the sizes of all forks.) With one argument, it returns the size of the main data fork of the relation. The second argument can be provided to specify which fork to examine:</p> <ul compact> <li> <p><code class="LITERAL">'main'</code> returns the size of the main data fork of the relation.</p> </li> <li> <p><code class="LITERAL">'fsm'</code> returns the size of the Free Space Map (see <a href="../storage-fsm/">Section 59.3</a>) associated with the relation.</p> </li> <li> <p><code class="LITERAL">'vm'</code> returns the size of the Visibility Map (see <a href="../storage-vm/">Section 59.4</a>) associated with the relation.</p> </li> <li> <p><code class="LITERAL">'init'</code> returns the size of the initialization fork, if any, associated with the relation.</p> </li> </ul> <p><code class="FUNCTION">pg_size_pretty</code> can be used to format the result of one of the other functions in a human-readable way, using kB, MB, GB or TB as appropriate.</p> <p>The functions above that operate on tables or indexes accept a <code class="TYPE">regclass</code> argument, which is simply the OID of the table or index in the <code class="STRUCTNAME">pg_class</code> system catalog. You do not have to look up the OID by hand, however, since the <code class="TYPE">regclass</code> data type's input converter will do the work for you. Just write the table name enclosed in single quotes so that it looks like a literal constant. For compatibility with the handling of ordinary <acronym class="ACRONYM">SQL</acronym> names, the string will be converted to lower case unless it contains double quotes around the table name.</p> <p>If an OID that does not represent an existing object is passed as argument to one of the above functions, NULL is returned.</p> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-ADMIN-DBLOCATION">Table 9-71</a> assist in identifying the specific disk files associated with database objects.</p> <div class="TABLE" id="FUNCTIONS-ADMIN-DBLOCATION">  <p class="c2">Table 9-71. Database Object Location Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_relation_filenode">pg_relation_filenode(<code class="PARAMETER">relation</code> <code class="TYPE">regclass</code>)</code></td> <td><code class="TYPE">oid</code></td> <td>Filenode number of the specified relation</td> </tr> <tr> <td><code class="LITERAL" id="pg_relation_filepath">pg_relation_filepath(<code class="PARAMETER">relation</code> <code class="TYPE">regclass</code>)</code></td> <td><code class="TYPE">text</code></td> <td>File path name of the specified relation</td> </tr> <tr> <td><code class="LITERAL" id="pg_filenode_relation">pg_filenode_relation(<code class="PARAMETER">tablespace</code> <code class="TYPE">oid</code>,
            <code class="PARAMETER">filenode</code> <code class="TYPE">oid</code>)</code></td> <td><code class="TYPE">regclass</code></td> <td>Find the relation associated with a given tablespace and filenode</td> </tr> </tbody> </table> </div> <p><code class="FUNCTION">pg_relation_filenode</code> accepts the OID or name of a table, index, sequence, or toast table, and returns the <span class="QUOTE">"filenode"</span> number currently assigned to it. The filenode is the base component of the file name(s) used for the relation (see <a href="../storage-file-layout/">Section 59.1</a> for more information). For most tables the result is the same as <code class="STRUCTNAME">pg_class</code>.<code class="STRUCTFIELD">relfilenode</code>, but for certain system catalogs <code class="STRUCTFIELD">relfilenode</code> is zero and this function must be used to get the correct value. The function returns NULL if passed a relation that does not have storage, such as a view.</p> <p><code class="FUNCTION">pg_relation_filepath</code> is similar to <code class="FUNCTION">pg_relation_filenode</code>, but it returns the entire file path name (relative to the database cluster's data directory <code class="VARNAME">PGDATA</code>) of the relation.</p> <p><code class="FUNCTION">pg_filenode_relation</code> is the reverse of <code class="FUNCTION">pg_relation_filenode</code>. Given a <span class="QUOTE">"tablespace"</span> OID and a <span class="QUOTE">"filenode"</span>, it returns the associated relation's OID. For a table in the database's default tablespace, the tablespace can be specified as 0.</p> </div> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-ADMIN-GENFILE">9.26.8. Generic File Access Functions</h2> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-ADMIN-GENFILE-TABLE">Table 9-72</a> provide native access to files on the machine hosting the server. Only files within the database cluster directory and the <code class="VARNAME">log_directory</code> can be accessed. Use a relative path for files in the cluster directory, and a path matching the <code class="VARNAME">log_directory</code> configuration setting for log files. Use of these functions is restricted to superusers.</p> <div class="TABLE" id="FUNCTIONS-ADMIN-GENFILE-TABLE">  <p class="c2">Table 9-72. Generic File Access Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_ls_dir">pg_ls_dir(<code class="PARAMETER">dirname</code>
            <code class="TYPE">text</code>)</code></td> <td><code class="TYPE">setof text</code></td> <td>List the contents of a directory</td> </tr> <tr> <td><code class="LITERAL" id="pg_read_file">pg_read_file(<code class="PARAMETER">filename</code> <code class="TYPE">text</code> [,
            <code class="PARAMETER">offset</code> <code class="TYPE">bigint</code>, <code class="PARAMETER">length</code>
            <code class="TYPE">bigint</code>])</code></td> <td><code class="TYPE">text</code></td> <td>Return the contents of a text file</td> </tr> <tr> <td><code class="LITERAL" id="pg_read_binary_file">pg_read_binary_file(<code class="PARAMETER">filename</code> <code class="TYPE">text</code> [,
            <code class="PARAMETER">offset</code> <code class="TYPE">bigint</code>, <code class="PARAMETER">length</code>
            <code class="TYPE">bigint</code>])</code></td> <td><code class="TYPE">bytea</code></td> <td>Return the contents of a file</td> </tr> <tr> <td><code class="LITERAL" id="pg_stat_file">pg_stat_file(<code class="PARAMETER">filename</code> <code class="TYPE">text</code>)</code></td> <td><code class="TYPE">record</code></td> <td>Return information about a file</td> </tr> </tbody> </table> </div> <p><code class="FUNCTION">pg_ls_dir</code> returns all the names in the specified directory, except the special entries <span class="QUOTE">"<code class="LITERAL">.</code>"</span> and <span class="QUOTE">"<code class="LITERAL">..</code>"</span>.</p> <p><code class="FUNCTION">pg_read_file</code> returns part of a text file, starting at the given <code class="PARAMETER">offset</code>, returning at most <code class="PARAMETER">length</code> bytes (less if the end of file is reached first). If <code class="PARAMETER">offset</code> is negative, it is relative to the end of the file. If <code class="PARAMETER">offset</code> and <code class="PARAMETER">length</code> are omitted, the entire file is returned. The bytes read from the file are interpreted as a string in the server encoding; an error is thrown if they are not valid in that encoding.</p> <p><code class="FUNCTION">pg_read_binary_file</code> is similar to <code class="FUNCTION">pg_read_file</code>, except that the result is a <code class="TYPE">bytea</code> value; accordingly, no encoding checks are performed. In combination with the <code class="FUNCTION">convert_from</code> function, this function can be used to read a file in a specified encoding:</p> <pre class="PROGRAMLISTING" data-language="sql">
SELECT convert_from(pg_read_binary_file('file_in_utf8.txt'), 'UTF8');
</pre> <p><code class="FUNCTION">pg_stat_file</code> returns a record containing the file size, last accessed time stamp, last modified time stamp, last file status change time stamp (Unix platforms only), file creation time stamp (Windows only), and a <code class="TYPE">boolean</code> indicating if it is a directory. Typical usages include:</p> <pre class="PROGRAMLISTING" data-language="sql">
SELECT * FROM pg_stat_file('filename');
SELECT (pg_stat_file('filename')).modification;
</pre> </div> <div class="SECT2"> <h2 class="SECT2" id="FUNCTIONS-ADVISORY-LOCKS">9.26.9. Advisory Lock Functions</h2> <p>The functions shown in <a href="../functions-admin/#FUNCTIONS-ADVISORY-LOCKS-TABLE">Table 9-73</a> manage advisory locks. For details about proper use of these functions, see <a href="../explicit-locking/#ADVISORY-LOCKS">Section 13.3.5</a>.</p> <div class="TABLE" id="FUNCTIONS-ADVISORY-LOCKS-TABLE">  <p class="c2">Table 9-73. Advisory Lock Functions</p> <table class="CALSTABLE"> <col> <col> <col> <thead> <tr> <th>Name</th> <th>Return Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="LITERAL" id="pg_advisory_lock">pg_advisory_lock(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Obtain exclusive session level advisory lock</td> </tr> <tr> <td><code class="LITERAL">pg_advisory_lock(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Obtain exclusive session level advisory lock</td> </tr> <tr> <td><code class="LITERAL" id="pg_advisory_lock_shared">pg_advisory_lock_shared(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Obtain shared session level advisory lock</td> </tr> <tr> <td><code class="LITERAL">pg_advisory_lock_shared(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Obtain shared session level advisory lock</td> </tr> <tr> <td><code class="LITERAL" id="pg_advisory_unlock">pg_advisory_unlock(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Release an exclusive session level advisory lock</td> </tr> <tr> <td><code class="LITERAL">pg_advisory_unlock(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Release an exclusive session level advisory lock</td> </tr> <tr> <td><code class="LITERAL" id="pg_advisory_unlock_all">pg_advisory_unlock_all()</code></td> <td><code class="TYPE">void</code></td> <td>Release all session level advisory locks held by the current session</td> </tr> <tr> <td><code class="LITERAL" id="pg_advisory_unlock_shared">pg_advisory_unlock_shared(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Release a shared session level advisory lock</td> </tr> <tr> <td><code class="LITERAL">pg_advisory_unlock_shared(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Release a shared session level advisory lock</td> </tr> <tr> <td><code class="LITERAL" id="pg_advisory_xact_lock">pg_advisory_xact_lock(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Obtain exclusive transaction level advisory lock</td> </tr> <tr> <td><code class="LITERAL">pg_advisory_xact_lock(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Obtain exclusive transaction level advisory lock</td> </tr> <tr> <td><code class="LITERAL" id="pg_advisory_xact_lock_shared">pg_advisory_xact_lock_shared(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Obtain shared transaction level advisory lock</td> </tr> <tr> <td><code class="LITERAL">pg_advisory_xact_lock_shared(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">void</code></td> <td>Obtain shared transaction level advisory lock</td> </tr> <tr> <td><code class="LITERAL" id="pg_try_advisory_lock">pg_try_advisory_lock(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Obtain exclusive session level advisory lock if available</td> </tr> <tr> <td><code class="LITERAL">pg_try_advisory_lock(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Obtain exclusive session level advisory lock if available</td> </tr> <tr> <td><code class="LITERAL" id="pg_try_advisory_lock_shared">pg_try_advisory_lock_shared(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Obtain shared session level advisory lock if available</td> </tr> <tr> <td><code class="LITERAL">pg_try_advisory_lock_shared(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Obtain shared session level advisory lock if available</td> </tr> <tr> <td><code class="LITERAL" id="pg_try_advisory_xact_lock">pg_try_advisory_xact_lock(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Obtain exclusive transaction level advisory lock if available</td> </tr> <tr> <td><code class="LITERAL">pg_try_advisory_xact_lock(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Obtain exclusive transaction level advisory lock if available</td> </tr> <tr> <td><code class="LITERAL" id="pg_try_advisory_xact_lock_shared">pg_try_advisory_xact_lock_shared(<code class="PARAMETER">key</code> <code class="TYPE">bigint</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Obtain shared transaction level advisory lock if available</td> </tr> <tr> <td><code class="LITERAL">pg_try_advisory_xact_lock_shared(<code class="PARAMETER">key1</code> <code class="TYPE">int</code>,
            <code class="PARAMETER">key2</code> <code class="TYPE">int</code>)</code></td> <td><code class="TYPE">boolean</code></td> <td>Obtain shared transaction level advisory lock if available</td> </tr> </tbody> </table> </div> <p><code class="FUNCTION">pg_advisory_lock</code> locks an application-defined resource, which can be identified either by a single 64-bit key value or two 32-bit key values (note that these two key spaces do not overlap). If another session already holds a lock on the same resource identifier, this function will wait until the resource becomes available. The lock is exclusive. Multiple lock requests stack, so that if the same resource is locked three times it must then be unlocked three times to be released for other sessions' use.</p> <p><code class="FUNCTION">pg_advisory_lock_shared</code> works the same as <code class="FUNCTION">pg_advisory_lock</code>, except the lock can be shared with other sessions requesting shared locks. Only would-be exclusive lockers are locked out.</p> <p><code class="FUNCTION">pg_try_advisory_lock</code> is similar to <code class="FUNCTION">pg_advisory_lock</code>, except the function will not wait for the lock to become available. It will either obtain the lock immediately and return <code class="LITERAL">true</code>, or return <code class="LITERAL">false</code> if the lock cannot be acquired immediately.</p> <p><code class="FUNCTION">pg_try_advisory_lock_shared</code> works the same as <code class="FUNCTION">pg_try_advisory_lock</code>, except it attempts to acquire a shared rather than an exclusive lock.</p> <p><code class="FUNCTION">pg_advisory_unlock</code> will release a previously-acquired exclusive session level advisory lock. It returns <code class="LITERAL">true</code> if the lock is successfully released. If the lock was not held, it will return <code class="LITERAL">false</code>, and in addition, an SQL warning will be reported by the server.</p> <p><code class="FUNCTION">pg_advisory_unlock_shared</code> works the same as <code class="FUNCTION">pg_advisory_unlock</code>, except it releases a shared session level advisory lock.</p> <p><code class="FUNCTION">pg_advisory_unlock_all</code> will release all session level advisory locks held by the current session. (This function is implicitly invoked at session end, even if the client disconnects ungracefully.)</p> <p><code class="FUNCTION">pg_advisory_xact_lock</code> works the same as <code class="FUNCTION">pg_advisory_lock</code>, except the lock is automatically released at the end of the current transaction and cannot be released explicitly.</p> <p><code class="FUNCTION">pg_advisory_xact_lock_shared</code> works the same as <code class="FUNCTION">pg_advisory_lock_shared</code>, except the lock is automatically released at the end of the current transaction and cannot be released explicitly.</p> <p><code class="FUNCTION">pg_try_advisory_xact_lock</code> works the same as <code class="FUNCTION">pg_try_advisory_lock</code>, except the lock, if acquired, is automatically released at the end of the current transaction and cannot be released explicitly.</p> <p><code class="FUNCTION">pg_try_advisory_xact_lock_shared</code> works the same as <code class="FUNCTION">pg_try_advisory_lock_shared</code>, except the lock, if acquired, is automatically released at the end of the current transaction and cannot be released explicitly.</p> </div>  <div class="NAVFOOTER">  <table summary="Footer navigation table"> <tr> <td width="33%" align="left"><a href="../functions-info/" accesskey="P">Prev</a></td> <td width="34%" align="center"></td> <td width="33%" align="right"><a href="https://www.postgresql.org/docs/9.4/static/functions-trigger.html" accesskey="N" target="_blank">Next</a></td> </tr> <tr> <td width="33%" align="left">System Information Functions</td> <td width="34%" align="center"><a href="https://www.postgresql.org/docs/9.4/static/functions.html" accesskey="U" target="_blank">Up</a></td> <td width="33%" align="right">Trigger Functions</td> </tr> </table> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 1996–2017 The PostgreSQL Global Development Group<br>Licensed under the PostgreSQL License.<br>
    <a href="https://www.postgresql.org/docs/9.4/static/functions-admin.html" class="_attribution-link" target="_blank">https://www.postgresql.org/docs/9.4/static/functions-admin.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
