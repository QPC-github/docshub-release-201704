
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>ActionDispatch&#58;&#58;Session&#58;&#58;CookieStore - Ruby on Rails 4.1 - W3cubDocs</title>
  
  <meta name="description" content=" This cookie-based session store is the Rails default. It is dramatically faster than the alternatives. ">
  <meta name="keywords" content="class, actiondispatch, session, cookiestore, -, ruby, on, rails, rails~4.1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/rails~4.1/actiondispatch/session/cookiestore/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/rails~4.1.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/rails~4.1/" class="_nav-link" title="" style="margin-left:0;">Ruby on Rails 4.1</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _rdoc">
				
<h1 id="class-ActionDispatch::Session::CookieStore" class="class"> class ActionDispatch::Session::CookieStore </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent">Rack::Session::Abstract::ID</dd>
<dt>Included modules:</dt>
<dd class="meta-includes">
<span class="include">ActionDispatch::Session::Compatibility</span>, <span class="include">ActionDispatch::Session::StaleSessionCheck</span>
</dd>
</dl> <section class="description"> <p>This cookie-based session store is the Rails default. It is dramatically faster than the alternatives.</p> <p>Sessions typically contain at most a user_id and flash message; both fit within the 4K cookie size limit. A CookieOverflow exception is raised if you attempt to store more than 4K of data.</p> <p>The cookie jar used for storage is automatically configured to be the best possible option given your application's configuration.</p> <p>If you only have secret_token set, your cookies will be signed, but not encrypted. This means a user cannot alter their <code>user_id</code> without knowing your app's secret key, but can easily read their <code>user_id</code>. This was the default for Rails 3 apps.</p> <p>If you have secret_key_base set, your cookies will be encrypted. This goes a step further than signed cookies in that encrypted cookies cannot be altered or read by users. This is the default starting in Rails 4.</p> <p>If you have both secret_token and secret_key base set, your cookies will be encrypted, and signed cookies generated by Rails 3 will be transparently read and encrypted to provide a smooth upgrade path.</p> <p>Configure your session store in config/initializers/session_store.rb:</p> <pre class="ruby" data-language="ruby">Rails.application.config.session_store :cookie_store, key: '_your_app_session'
</pre> <p>Configure your secret key in config/secrets.yml:</p> <pre>development:
  secret_key_base: 'secret key'</pre> <p>To generate a secret key for an existing application, run `rake secret`.</p> <p>If you are upgrading an existing Rails 3 app, you should leave your existing secret_token in place and simply add the new secret_key_base. Note that you should wait to set secret_key_base until you have 100% of your userbase on Rails 4 and are reasonably sure you will not need to rollback to Rails 3. This is because cookies signed based on the new secret_key_base in Rails 4 are not backwards compatible with Rails 3. You are free to leave your existing secret_token in place, not set the new secret_key_base, and ignore the deprecation warnings until you are reasonably sure that your upgrade is otherwise complete. Additionally, you should take care to make sure you are not relying on the ability to decode signed cookies generated by your app in external applications or Javascript before upgrading.</p> <p>Note that changing the secret key will invalidate all existing sessions!</p> </section> <section id="5Buntitled-5D" class="documentation-section"> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(app, options={})</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-calls-super"> Calls superclass method <span>ActionDispatch::Session::Compatibility.new</span> </div> <div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_dispatch/middleware/session/cookie_store.rb, line 60
def initialize(app, options={})
  super(app, options.merge!(:cookie_only =&gt; true))
end</pre> </div> </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-destroy_session"> <span class="method-name">destroy_session</span><span class="method-args">(env, session_id, options)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="destroy_session-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_dispatch/middleware/session/cookie_store.rb, line 64
def destroy_session(env, session_id, options)
  new_sid = generate_sid unless options[:drop]
  # Reset hash and Assign the new session id
  env["action_dispatch.request.unsigned_session_cookie"] = new_sid ? { "session_id" =&gt; new_sid } : {}
  new_sid
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-load_session"> <span class="method-name">load_session</span><span class="method-args">(env)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="load_session-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_dispatch/middleware/session/cookie_store.rb, line 71
def load_session(env)
  stale_session_check! do
    data = unpacked_cookie_data(env)
    data = persistent_session_id!(data)
    [data["session_id"], data]
  end
end</pre> </div> </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    © 2004–2016 David Heinemeier Hansson<br>Licensed under the MIT License.<br>
    
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
